[2024-05-14 11:51:10,987: INFO/MainProcess] Task create_task[4c2b46f0-e627-4f07-84a6-77511753ecd0] received
[2024-05-14 11:51:10,990: WARNING/ForkPoolWorker-1] create_task1
[2024-05-14 11:51:10,995: INFO/MainProcess] Task download_file_url[e7b8e38a-c5c7-4c69-97c6-61f4cde84450] received
[2024-05-14 11:51:10,996: INFO/ForkPoolWorker-1] Task create_task[4c2b46f0-e627-4f07-84a6-77511753ecd0] succeeded in 0.00552229000004445s: <AsyncResult: e7b8e38a-c5c7-4c69-97c6-61f4cde84450>
[2024-05-14 11:51:10,998: WARNING/ForkPoolWorker-3] Downloading file <@task: download_file_url of worker at 0x7f3508f40e50>
[2024-05-14 11:51:11,304: WARNING/ForkPoolWorker-3]     done: local_filename switchCase.png
[2024-05-14 11:51:11,310: INFO/ForkPoolWorker-3] Task download_file_url[e7b8e38a-c5c7-4c69-97c6-61f4cde84450] succeeded in 0.311464034999517s: 'switchCase.png'
[2024-05-14 11:51:12,661: INFO/MainProcess] Task create_task[8506f9b6-5c86-4e3c-8072-2749a69b655b] received
[2024-05-14 11:51:12,664: WARNING/ForkPoolWorker-1] create_task2
[2024-05-14 11:51:12,668: INFO/MainProcess] Task download_YouTube_url[07c56774-0b3b-49ab-8856-e6cd683afdfd] received
[2024-05-14 11:51:12,668: INFO/ForkPoolWorker-1] Task create_task[8506f9b6-5c86-4e3c-8072-2749a69b655b] succeeded in 0.0039336059999186546s: <AsyncResult: 07c56774-0b3b-49ab-8856-e6cd683afdfd>
[2024-05-14 11:51:12,670: WARNING/ForkPoolWorker-1] download YouTube url <@task: download_file_url of worker at 0x7f3508f40e50>
[2024-05-14 11:51:14,024: WARNING/ForkPoolWorker-1] --- Logging error ---
[2024-05-14 11:51:14,027: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-14 11:51:14,028: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2024-05-14 11:51:14,029: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-14 11:51:14,029: WARNING/ForkPoolWorker-1]   File "/usr/src/app/worker.py", line 37, in download_YouTube_url
    yt = YouTube(url)
         ^^^^^^^^^^^^
[2024-05-14 11:51:14,030: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/pytube/__main__.py", line 91, in __init__
    self.prefetch()
[2024-05-14 11:51:14,030: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/pytube/__main__.py", line 181, in prefetch
    self.vid_info_raw = request.get(self.vid_info_url)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-14 11:51:14,031: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/pytube/request.py", line 36, in get
    return _execute_request(url).read().decode("utf-8")
           ^^^^^^^^^^^^^^^^^^^^^
[2024-05-14 11:51:14,032: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/pytube/request.py", line 24, in _execute_request
    return urlopen(request)  # nosec
           ^^^^^^^^^^^^^^^^
[2024-05-14 11:51:14,032: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/urllib/request.py", line 216, in urlopen
    return opener.open(url, data, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-14 11:51:14,033: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/urllib/request.py", line 525, in open
    response = meth(req, response)
               ^^^^^^^^^^^^^^^^^^^
[2024-05-14 11:51:14,033: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/urllib/request.py", line 634, in http_response
    response = self.parent.error(
               ^^^^^^^^^^^^^^^^^^
[2024-05-14 11:51:14,034: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/urllib/request.py", line 557, in error
    result = self._call_chain(*args)
             ^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-14 11:51:14,035: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/urllib/request.py", line 496, in _call_chain
    result = func(*args)
             ^^^^^^^^^^^
[2024-05-14 11:51:14,035: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/urllib/request.py", line 749, in http_error_302
    return self.parent.open(new, timeout=req.timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-14 11:51:14,036: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/urllib/request.py", line 525, in open
    response = meth(req, response)
               ^^^^^^^^^^^^^^^^^^^
[2024-05-14 11:51:14,036: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/urllib/request.py", line 634, in http_response
    response = self.parent.error(
               ^^^^^^^^^^^^^^^^^^
[2024-05-14 11:51:14,037: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/urllib/request.py", line 563, in error
    return self._call_chain(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-14 11:51:14,037: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/urllib/request.py", line 496, in _call_chain
    result = func(*args)
             ^^^^^^^^^^^
[2024-05-14 11:51:14,038: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/urllib/request.py", line 643, in http_error_default
    raise HTTPError(req.full_url, code, msg, hdrs, fp)
[2024-05-14 11:51:14,038: WARNING/ForkPoolWorker-1] urllib.error.HTTPError: HTTP Error 410: Gone
[2024-05-14 11:51:14,039: WARNING/ForkPoolWorker-1] 
During handling of the above exception, another exception occurred:
[2024-05-14 11:51:14,039: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-14 11:51:14,040: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2024-05-14 11:51:14,041: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2024-05-14 11:51:14,041: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2024-05-14 11:51:14,042: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-14 11:51:14,042: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-14 11:51:14,043: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2024-05-14 11:51:14,044: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-14 11:51:14,044: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-14 11:51:14,045: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2024-05-14 11:51:14,045: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-14 11:51:14,046: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2024-05-14 11:51:14,046: WARNING/ForkPoolWorker-1] AttributeError: '_Code' object has no attribute 'co_positions'
[2024-05-14 11:51:14,047: WARNING/ForkPoolWorker-1] Call stack:
[2024-05-14 11:51:14,048: WARNING/ForkPoolWorker-1]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2024-05-14 11:51:14,048: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2024-05-14 11:51:14,049: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2024-05-14 11:51:14,050: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2024-05-14 11:51:14,050: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2024-05-14 11:51:14,051: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2024-05-14 11:51:14,051: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2024-05-14 11:51:14,052: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2024-05-14 11:51:14,052: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2024-05-14 11:51:14,053: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2024-05-14 11:51:14,053: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2024-05-14 11:51:14,054: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2024-05-14 11:51:14,054: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2024-05-14 11:51:14,055: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2024-05-14 11:51:14,056: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2024-05-14 11:51:14,056: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2024-05-14 11:51:14,057: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2024-05-14 11:51:14,057: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2024-05-14 11:51:14,058: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2024-05-14 11:51:14,059: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2024-05-14 11:51:14,059: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2024-05-14 11:51:14,060: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2024-05-14 11:51:14,060: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2024-05-14 11:51:14,061: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2024-05-14 11:51:14,061: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2024-05-14 11:51:14,062: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2024-05-14 11:51:14,063: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2024-05-14 11:51:14,063: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2024-05-14 11:51:14,064: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2024-05-14 11:51:14,064: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2024-05-14 11:51:14,065: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2024-05-14 11:51:14,065: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2024-05-14 11:51:14,066: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2024-05-14 11:51:14,067: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2024-05-14 11:51:14,068: WARNING/ForkPoolWorker-1] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@6080601e8add', 'id': '07c56774-0b3b-49ab-8856-e6cd683afdfd', 'name': 'download_YouTube_url', 'exc': 'OSError()', 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 37, in download_YouTube_url\n    yt = YouTube(url)\n         ^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/pytube/__main__.py", line 91, in __init__\n    self.prefetch()\n  File "/usr/local/lib/python3.11/site-packages/pytube/__main__.py", line 181, in prefetch\n    self.vid_info_raw = request.get(self.vid_info_url)\n                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/pytube/request.py", line 36, in get\n    return _execute_request(url).read().decode("utf-8")\n           ^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/pytube/request.py", line 24, in _execute_request\n    return urlopen(request)  # nosec\n           ^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/urllib/request.py", line 216, in urlopen\n    return opener.open(url, data, timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/urllib/request.py", line 525, in open\n    response = meth(req, response)\n               ^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/urllib/request.py", line 634, in http_response\n    response = self.parent.error(\n               ^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/urllib/request.py", line 557, in error\n    result = self._call_chain(*args)\n             ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/urllib/request.py", line 496, in _call_chain\n    result = func(*args)\n             ^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/urllib/request.py", line 749, in http_error_302\n    return self.parent.open(new, timeout=req.timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/urllib/request.py", line 525, in open\n    response = meth(req, response)\n               ^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/urllib/request.py", line 634, in http_response\n    response = self.parent.error(\n               ^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/urllib/request.py", line 563, in error\n    return self._call_chain(*args)\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/urllib/request.py", line 496, in _call_chain\n    result = func(*args)\n             ^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/urllib/request.py", line 643, in http_error_default\n    raise HTTPError(req.full_url, code, msg, hdrs, fp)\nurllib.error.HTTPError: HTTP Error 410: Gone\n', 'args': "['https://www.youtube.com/watch?v=Eav52-foa5A']", 'kwargs': '{}', 'description': 'raised unexpected', 'internal': False}
[2024-05-14 11:51:15,967: INFO/MainProcess] Task create_task[98d7f810-e168-4d92-857d-5921713680ec] received
[2024-05-14 11:51:15,970: WARNING/ForkPoolWorker-1] create_task3
[2024-05-14 11:51:18,972: INFO/ForkPoolWorker-1] Task create_task[98d7f810-e168-4d92-857d-5921713680ec] succeeded in 3.002060672999505s: True
[2024-05-16 10:21:45,084: INFO/MainProcess] Connected to redis://redis:6379/0
[2024-05-16 10:21:45,091: INFO/MainProcess] mingle: searching for neighbors
[2024-05-16 10:21:46,102: INFO/MainProcess] mingle: all alone
[2024-05-16 10:21:46,116: INFO/MainProcess] celery@b3dfad248726 ready.
[2024-05-16 10:21:49,398: INFO/MainProcess] Events of group {task} enabled by remote.
[2024-05-16 14:43:39,019: INFO/MainProcess] Task download_stream_url[c9988d34-ff93-4ddc-bc9f-a4884887b32c] received
[2024-05-16 14:43:39,023: WARNING/ForkPoolWorker-1] Recording video... https://live-wuxi.cgtn.com/live/wx_cgtn_1000k_internalnormal.m3u8
[2024-05-16 14:43:39,070: WARNING/ForkPoolWorker-1] --- Logging error ---
[2024-05-16 14:43:39,074: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 14:43:39,075: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2024-05-16 14:43:39,075: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 14:43:39,076: WARNING/ForkPoolWorker-1]   File "/usr/src/app/worker.py", line 77, in download_stream_url
    while total_duration < recording_duration:
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 14:43:39,076: WARNING/ForkPoolWorker-1] TypeError: '<' not supported between instances of 'float' and 'str'
[2024-05-16 14:43:39,076: WARNING/ForkPoolWorker-1] 
During handling of the above exception, another exception occurred:
[2024-05-16 14:43:39,077: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 14:43:39,078: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2024-05-16 14:43:39,078: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2024-05-16 14:43:39,078: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 14:43:39,078: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 14:43:39,079: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 14:43:39,079: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2024-05-16 14:43:39,080: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 14:43:39,080: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 14:43:39,080: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2024-05-16 14:43:39,080: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 14:43:39,081: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2024-05-16 14:43:39,081: WARNING/ForkPoolWorker-1] AttributeError: '_Code' object has no attribute 'co_positions'
[2024-05-16 14:43:39,081: WARNING/ForkPoolWorker-1] Call stack:
[2024-05-16 14:43:39,084: WARNING/ForkPoolWorker-1]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2024-05-16 14:43:39,086: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2024-05-16 14:43:39,087: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2024-05-16 14:43:39,087: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2024-05-16 14:43:39,088: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2024-05-16 14:43:39,089: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2024-05-16 14:43:39,089: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2024-05-16 14:43:39,090: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2024-05-16 14:43:39,090: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2024-05-16 14:43:39,090: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2024-05-16 14:43:39,091: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2024-05-16 14:43:39,091: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2024-05-16 14:43:39,091: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2024-05-16 14:43:39,092: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2024-05-16 14:43:39,092: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2024-05-16 14:43:39,092: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2024-05-16 14:43:39,092: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2024-05-16 14:43:39,093: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2024-05-16 14:43:39,093: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2024-05-16 14:43:39,093: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2024-05-16 14:43:39,093: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2024-05-16 14:43:39,094: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2024-05-16 14:43:39,094: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2024-05-16 14:43:39,094: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2024-05-16 14:43:39,094: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2024-05-16 14:43:39,095: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2024-05-16 14:43:39,095: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2024-05-16 14:43:39,095: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2024-05-16 14:43:39,095: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2024-05-16 14:43:39,096: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2024-05-16 14:43:39,096: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2024-05-16 14:43:39,096: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2024-05-16 14:43:39,097: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2024-05-16 14:43:39,097: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2024-05-16 14:43:39,097: WARNING/ForkPoolWorker-1] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@b3dfad248726', 'id': 'c9988d34-ff93-4ddc-bc9f-a4884887b32c', 'name': 'download_stream_url', 'exc': 'TypeError("\'<\' not supported between instances of \'float\' and \'str\'")', 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 77, in download_stream_url\n    while total_duration < recording_duration:\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nTypeError: \'<\' not supported between instances of \'float\' and \'str\'\n', 'args': '[]', 'kwargs': "{'playlist_url': '', 'recording_duration': '', 'max_fragment_duration': ''}", 'description': 'raised unexpected', 'internal': False}
[2024-05-16 14:52:44,708: INFO/MainProcess] Task download_stream_url[161b926f-25ed-40ce-93a1-80635180013e] received
[2024-05-16 14:52:44,716: WARNING/ForkPoolWorker-1] Recording video... https://live-wuxi.cgtn.com/live/wx_cgtn_1000k_internalnormal.m3u8
[2024-05-16 14:52:44,717: WARNING/ForkPoolWorker-1] load m3u8..
[2024-05-16 14:52:46,717: WARNING/ForkPoolWorker-1]  Recording fragment 1 segment 1...
[2024-05-16 14:52:46,721: WARNING/ForkPoolWorker-1] --- Logging error ---
[2024-05-16 14:52:46,723: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 14:52:46,724: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2024-05-16 14:52:46,724: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 14:52:46,725: WARNING/ForkPoolWorker-1]   File "/usr/src/app/worker.py", line 117, in download_stream_url
    with open(fragment_filename, "ab") as f:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 14:52:46,726: WARNING/ForkPoolWorker-1] FileNotFoundError: [Errno 2] No such file or directory: 'project/downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715871123799-1.ts'
[2024-05-16 14:52:46,726: WARNING/ForkPoolWorker-1] 
During handling of the above exception, another exception occurred:
[2024-05-16 14:52:46,727: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 14:52:46,728: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2024-05-16 14:52:46,728: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2024-05-16 14:52:46,729: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 14:52:46,729: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 14:52:46,730: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 14:52:46,731: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2024-05-16 14:52:46,731: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 14:52:46,732: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 14:52:46,733: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2024-05-16 14:52:46,733: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 14:52:46,734: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2024-05-16 14:52:46,735: WARNING/ForkPoolWorker-1] AttributeError: '_Code' object has no attribute 'co_positions'
[2024-05-16 14:52:46,735: WARNING/ForkPoolWorker-1] Call stack:
[2024-05-16 14:52:46,736: WARNING/ForkPoolWorker-1]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2024-05-16 14:52:46,737: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2024-05-16 14:52:46,738: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2024-05-16 14:52:46,738: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2024-05-16 14:52:46,739: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2024-05-16 14:52:46,739: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2024-05-16 14:52:46,740: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2024-05-16 14:52:46,741: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2024-05-16 14:52:46,741: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2024-05-16 14:52:46,742: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2024-05-16 14:52:46,742: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2024-05-16 14:52:46,743: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2024-05-16 14:52:46,743: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2024-05-16 14:52:46,744: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2024-05-16 14:52:46,745: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2024-05-16 14:52:46,745: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2024-05-16 14:52:46,746: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2024-05-16 14:52:46,746: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2024-05-16 14:52:46,747: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2024-05-16 14:52:46,747: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2024-05-16 14:52:46,748: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2024-05-16 14:52:46,748: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2024-05-16 14:52:46,749: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2024-05-16 14:52:46,749: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2024-05-16 14:52:46,750: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2024-05-16 14:52:46,750: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2024-05-16 14:52:46,751: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2024-05-16 14:52:46,751: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2024-05-16 14:52:46,751: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2024-05-16 14:52:46,752: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2024-05-16 14:52:46,752: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2024-05-16 14:52:46,753: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2024-05-16 14:52:46,753: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2024-05-16 14:52:46,754: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2024-05-16 14:52:46,754: WARNING/ForkPoolWorker-1] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@b3dfad248726', 'id': '161b926f-25ed-40ce-93a1-80635180013e', 'name': 'download_stream_url', 'exc': "FileNotFoundError(2, 'No such file or directory')", 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 117, in download_stream_url\n    with open(fragment_filename, "ab") as f:\n         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nFileNotFoundError: [Errno 2] No such file or directory: \'project/downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715871123799-1.ts\'\n', 'args': '[]', 'kwargs': '{}', 'description': 'raised unexpected', 'internal': False}
[2024-05-16 15:00:36,283: INFO/MainProcess] Connected to redis://redis:6379/0
[2024-05-16 15:00:36,287: INFO/MainProcess] mingle: searching for neighbors
[2024-05-16 15:00:37,296: INFO/MainProcess] mingle: all alone
[2024-05-16 15:00:37,310: INFO/MainProcess] celery@0a4a44dea96b ready.
[2024-05-16 15:00:41,458: INFO/MainProcess] Events of group {task} enabled by remote.
[2024-05-16 15:00:44,521: INFO/MainProcess] Task download_stream_url[e0c0e8c4-ded7-4a4a-a66d-2d030dc23bb4] received
[2024-05-16 15:00:44,524: WARNING/ForkPoolWorker-1] Recording video... https://live-wuxi.cgtn.com/live/wx_cgtn_1000k_internalnormal.m3u8
[2024-05-16 15:00:44,530: WARNING/ForkPoolWorker-1] load m3u8..
[2024-05-16 15:00:47,049: WARNING/ForkPoolWorker-1]  Recording fragment 1 segment 1...
[2024-05-16 15:00:47,059: WARNING/ForkPoolWorker-1] --- Logging error ---
[2024-05-16 15:00:47,063: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 15:00:47,064: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:00:47,064: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:00:47,065: WARNING/ForkPoolWorker-1]   File "/usr/src/app/worker.py", line 117, in download_stream_url
    with open(fragment_filename, "ab") as f:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:00:47,066: WARNING/ForkPoolWorker-1] FileNotFoundError: [Errno 2] No such file or directory: 'project/downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715871603767-1.ts'
[2024-05-16 15:00:47,067: WARNING/ForkPoolWorker-1] 
During handling of the above exception, another exception occurred:
[2024-05-16 15:00:47,067: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 15:00:47,069: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:00:47,069: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2024-05-16 15:00:47,070: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:00:47,071: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:00:47,071: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:00:47,072: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2024-05-16 15:00:47,073: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:00:47,073: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:00:47,074: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2024-05-16 15:00:47,075: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:00:47,075: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2024-05-16 15:00:47,076: WARNING/ForkPoolWorker-1] AttributeError: '_Code' object has no attribute 'co_positions'
[2024-05-16 15:00:47,077: WARNING/ForkPoolWorker-1] Call stack:
[2024-05-16 15:00:47,080: WARNING/ForkPoolWorker-1]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2024-05-16 15:00:47,081: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2024-05-16 15:00:47,081: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2024-05-16 15:00:47,082: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2024-05-16 15:00:47,082: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2024-05-16 15:00:47,083: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2024-05-16 15:00:47,084: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2024-05-16 15:00:47,084: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2024-05-16 15:00:47,085: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2024-05-16 15:00:47,085: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2024-05-16 15:00:47,086: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2024-05-16 15:00:47,086: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2024-05-16 15:00:47,087: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2024-05-16 15:00:47,087: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2024-05-16 15:00:47,088: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2024-05-16 15:00:47,088: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2024-05-16 15:00:47,089: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2024-05-16 15:00:47,089: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2024-05-16 15:00:47,090: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2024-05-16 15:00:47,091: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2024-05-16 15:00:47,091: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2024-05-16 15:00:47,092: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2024-05-16 15:00:47,093: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2024-05-16 15:00:47,093: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2024-05-16 15:00:47,094: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2024-05-16 15:00:47,094: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2024-05-16 15:00:47,095: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2024-05-16 15:00:47,095: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2024-05-16 15:00:47,096: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2024-05-16 15:00:47,097: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2024-05-16 15:00:47,097: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2024-05-16 15:00:47,098: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2024-05-16 15:00:47,099: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2024-05-16 15:00:47,099: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2024-05-16 15:00:47,100: WARNING/ForkPoolWorker-1] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@0a4a44dea96b', 'id': 'e0c0e8c4-ded7-4a4a-a66d-2d030dc23bb4', 'name': 'download_stream_url', 'exc': "FileNotFoundError(2, 'No such file or directory')", 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 117, in download_stream_url\n    with open(fragment_filename, "ab") as f:\n         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nFileNotFoundError: [Errno 2] No such file or directory: \'project/downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715871603767-1.ts\'\n', 'args': '[]', 'kwargs': '{}', 'description': 'raised unexpected', 'internal': False}
[2024-05-16 15:02:28,860: INFO/MainProcess] Connected to redis://redis:6379/0
[2024-05-16 15:02:28,900: INFO/MainProcess] mingle: searching for neighbors
[2024-05-16 15:02:29,921: INFO/MainProcess] mingle: all alone
[2024-05-16 15:02:29,961: INFO/MainProcess] celery@7b2c8e153408 ready.
[2024-05-16 15:02:34,744: INFO/MainProcess] Events of group {task} enabled by remote.
[2024-05-16 15:02:36,658: INFO/MainProcess] Task download_stream_url[de7e2149-bf80-488f-bc19-65832914c19c] received
[2024-05-16 15:02:36,661: WARNING/ForkPoolWorker-1] Recording video... https://live-wuxi.cgtn.com/live/wx_cgtn_1000k_internalnormal.m3u8
[2024-05-16 15:02:36,666: WARNING/ForkPoolWorker-1] load m3u8..
[2024-05-16 15:02:39,628: WARNING/ForkPoolWorker-1]  Recording fragment 1 segment 1...
[2024-05-16 15:02:39,677: WARNING/ForkPoolWorker-1] --- Logging error ---
[2024-05-16 15:02:39,685: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 15:02:39,689: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:02:39,697: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:02:39,699: WARNING/ForkPoolWorker-1]   File "/usr/src/app/worker.py", line 117, in download_stream_url
    with open(fragment_filename, "ab") as f:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:02:39,700: WARNING/ForkPoolWorker-1] FileNotFoundError: [Errno 2] No such file or directory: 'project/downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715871717864-1.ts'
[2024-05-16 15:02:39,701: WARNING/ForkPoolWorker-1] 
During handling of the above exception, another exception occurred:
[2024-05-16 15:02:39,701: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 15:02:39,706: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:02:39,709: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2024-05-16 15:02:39,719: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:02:39,725: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:02:39,734: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:02:39,735: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2024-05-16 15:02:39,744: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:02:39,747: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:02:39,750: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2024-05-16 15:02:39,755: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:02:39,757: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2024-05-16 15:02:39,758: WARNING/ForkPoolWorker-1] AttributeError: '_Code' object has no attribute 'co_positions'
[2024-05-16 15:02:39,760: WARNING/ForkPoolWorker-1] Call stack:
[2024-05-16 15:02:39,763: WARNING/ForkPoolWorker-1]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2024-05-16 15:02:39,767: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2024-05-16 15:02:39,770: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2024-05-16 15:02:39,774: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2024-05-16 15:02:39,776: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2024-05-16 15:02:39,781: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2024-05-16 15:02:39,785: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2024-05-16 15:02:39,793: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2024-05-16 15:02:39,793: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2024-05-16 15:02:39,797: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2024-05-16 15:02:39,797: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2024-05-16 15:02:39,797: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2024-05-16 15:02:39,798: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2024-05-16 15:02:39,798: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2024-05-16 15:02:39,799: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2024-05-16 15:02:39,799: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2024-05-16 15:02:39,799: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2024-05-16 15:02:39,800: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2024-05-16 15:02:39,800: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2024-05-16 15:02:39,800: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2024-05-16 15:02:39,801: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2024-05-16 15:02:39,801: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2024-05-16 15:02:39,802: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2024-05-16 15:02:39,802: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2024-05-16 15:02:39,803: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2024-05-16 15:02:39,804: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2024-05-16 15:02:39,810: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2024-05-16 15:02:39,813: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2024-05-16 15:02:39,819: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2024-05-16 15:02:39,822: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2024-05-16 15:02:39,823: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2024-05-16 15:02:39,824: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2024-05-16 15:02:39,825: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2024-05-16 15:02:39,827: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2024-05-16 15:02:39,843: WARNING/ForkPoolWorker-1] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@7b2c8e153408', 'id': 'de7e2149-bf80-488f-bc19-65832914c19c', 'name': 'download_stream_url', 'exc': "FileNotFoundError(2, 'No such file or directory')", 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 117, in download_stream_url\n    with open(fragment_filename, "ab") as f:\n         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nFileNotFoundError: [Errno 2] No such file or directory: \'project/downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715871717864-1.ts\'\n', 'args': '[]', 'kwargs': '{}', 'description': 'raised unexpected', 'internal': False}
[2024-05-16 15:09:06,690: WARNING/MainProcess] consumer: Connection to broker lost. Trying to re-establish the connection...
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/celery/worker/consumer/consumer.py", line 332, in start
    blueprint.start(self)
  File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
  File "/usr/local/lib/python3.11/site-packages/celery/worker/consumer/consumer.py", line 628, in start
    c.loop(*c.loop_args())
  File "/usr/local/lib/python3.11/site-packages/celery/worker/loops.py", line 97, in asynloop
    next(loop)
  File "/usr/local/lib/python3.11/site-packages/kombu/asynchronous/hub.py", line 373, in create_loop
    cb(*cbargs)
  File "/usr/local/lib/python3.11/site-packages/kombu/transport/redis.py", line 1344, in on_readable
    self.cycle.on_readable(fileno)
  File "/usr/local/lib/python3.11/site-packages/kombu/transport/redis.py", line 569, in on_readable
    chan.handlers[type]()
  File "/usr/local/lib/python3.11/site-packages/kombu/transport/redis.py", line 913, in _receive
    ret.append(self._receive_one(c))
               ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/kombu/transport/redis.py", line 923, in _receive_one
    response = c.parse_response()
               ^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/redis/client.py", line 1531, in parse_response
    response = self._execute(conn, try_read)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/redis/client.py", line 1507, in _execute
    return conn.retry.call_with_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/redis/retry.py", line 49, in call_with_retry
    fail(error)
  File "/usr/local/lib/python3.11/site-packages/redis/client.py", line 1509, in <lambda>
    lambda error: self._disconnect_raise_connect(conn, error),
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/redis/client.py", line 1496, in _disconnect_raise_connect
    raise error
  File "/usr/local/lib/python3.11/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
           ^^^^
  File "/usr/local/lib/python3.11/site-packages/redis/client.py", line 1508, in <lambda>
    lambda: command(*args, **kwargs),
            ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/redis/client.py", line 1529, in try_read
    return conn.read_response()
           ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/redis/connection.py", line 865, in read_response
    response = self._parser.read_response(disable_decoding=disable_decoding)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/redis/connection.py", line 346, in read_response
    result = self._read_response(disable_decoding=disable_decoding)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/redis/connection.py", line 356, in _read_response
    raw = self._buffer.readline()
          ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/redis/connection.py", line 259, in readline
    self._read_from_socket()
  File "/usr/local/lib/python3.11/site-packages/redis/connection.py", line 212, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
[2024-05-16 15:34:44,005: INFO/MainProcess] Connected to redis://redis:6379/0
[2024-05-16 15:34:44,022: INFO/MainProcess] mingle: searching for neighbors
[2024-05-16 15:34:45,074: INFO/MainProcess] mingle: all alone
[2024-05-16 15:34:45,093: INFO/MainProcess] celery@b425650180b2 ready.
[2024-05-16 15:34:49,592: INFO/MainProcess] Events of group {task} enabled by remote.
[2024-05-16 15:34:59,740: INFO/MainProcess] Task download_stream_url[98c44172-7ce4-49c5-863d-8511e9044211] received
[2024-05-16 15:34:59,751: WARNING/ForkPoolWorker-1] Recording video... https://live-wuxi.cgtn.com/live/wx_cgtn_1000k_internalnormal.m3u8
[2024-05-16 15:34:59,752: WARNING/ForkPoolWorker-1] load m3u8..
[2024-05-16 15:35:01,530: WARNING/ForkPoolWorker-1]  Recording fragment 1 segment 1...
[2024-05-16 15:35:01,540: WARNING/ForkPoolWorker-1] --- Logging error ---
[2024-05-16 15:35:01,549: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 15:35:01,550: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:35:01,551: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:35:01,552: WARNING/ForkPoolWorker-1]   File "/usr/src/app/worker.py", line 117, in download_stream_url
    with open(fragment_filename, "ab") as f:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:35:01,553: WARNING/ForkPoolWorker-1] FileNotFoundError: [Errno 2] No such file or directory: 'project/downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715873655816-1.ts'
[2024-05-16 15:35:01,553: WARNING/ForkPoolWorker-1] 
During handling of the above exception, another exception occurred:
[2024-05-16 15:35:01,554: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 15:35:01,555: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:35:01,556: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2024-05-16 15:35:01,556: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:35:01,557: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:35:01,557: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:35:01,558: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2024-05-16 15:35:01,558: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:35:01,559: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:35:01,559: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2024-05-16 15:35:01,560: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:35:01,560: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2024-05-16 15:35:01,561: WARNING/ForkPoolWorker-1] AttributeError: '_Code' object has no attribute 'co_positions'
[2024-05-16 15:35:01,562: WARNING/ForkPoolWorker-1] Call stack:
[2024-05-16 15:35:01,565: WARNING/ForkPoolWorker-1]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2024-05-16 15:35:01,566: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2024-05-16 15:35:01,566: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2024-05-16 15:35:01,567: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2024-05-16 15:35:01,567: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2024-05-16 15:35:01,568: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2024-05-16 15:35:01,569: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2024-05-16 15:35:01,569: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2024-05-16 15:35:01,570: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2024-05-16 15:35:01,571: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2024-05-16 15:35:01,571: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2024-05-16 15:35:01,572: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2024-05-16 15:35:01,573: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2024-05-16 15:35:01,576: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2024-05-16 15:35:01,577: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2024-05-16 15:35:01,577: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2024-05-16 15:35:01,578: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2024-05-16 15:35:01,579: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2024-05-16 15:35:01,580: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2024-05-16 15:35:01,580: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2024-05-16 15:35:01,581: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2024-05-16 15:35:01,582: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2024-05-16 15:35:01,582: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2024-05-16 15:35:01,583: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2024-05-16 15:35:01,584: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2024-05-16 15:35:01,584: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2024-05-16 15:35:01,585: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2024-05-16 15:35:01,585: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2024-05-16 15:35:01,586: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2024-05-16 15:35:01,587: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2024-05-16 15:35:01,587: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2024-05-16 15:35:01,588: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2024-05-16 15:35:01,588: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2024-05-16 15:35:01,589: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2024-05-16 15:35:01,589: WARNING/ForkPoolWorker-1] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@b425650180b2', 'id': '98c44172-7ce4-49c5-863d-8511e9044211', 'name': 'download_stream_url', 'exc': "FileNotFoundError(2, 'No such file or directory')", 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 117, in download_stream_url\n    with open(fragment_filename, "ab") as f:\n         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nFileNotFoundError: [Errno 2] No such file or directory: \'project/downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715873655816-1.ts\'\n', 'args': '[]', 'kwargs': '{}', 'description': 'raised unexpected', 'internal': False}
[2024-05-16 15:36:12,306: INFO/MainProcess] Task download_stream_url[c72629f9-ba88-471a-9122-98cc605c38ba] received
[2024-05-16 15:36:12,319: WARNING/ForkPoolWorker-1] Recording video... https://live-wuxi.cgtn.com/live/wx_cgtn_1000k_internalnormal.m3u8
[2024-05-16 15:36:12,324: WARNING/ForkPoolWorker-1] load m3u8..
[2024-05-16 15:36:15,272: WARNING/ForkPoolWorker-1]  Recording fragment 1 segment 1...
[2024-05-16 15:36:15,288: WARNING/ForkPoolWorker-1] --- Logging error ---
[2024-05-16 15:36:15,304: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 15:36:15,305: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:36:15,306: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:36:15,308: WARNING/ForkPoolWorker-1]   File "/usr/src/app/worker.py", line 117, in download_stream_url
    with open(fragment_filename, "ab") as f:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:36:15,309: WARNING/ForkPoolWorker-1] FileNotFoundError: [Errno 2] No such file or directory: 'project/downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715873733807-1.ts'
[2024-05-16 15:36:15,310: WARNING/ForkPoolWorker-1] 
During handling of the above exception, another exception occurred:
[2024-05-16 15:36:15,311: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 15:36:15,313: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:36:15,314: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2024-05-16 15:36:15,315: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:36:15,322: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:36:15,327: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:36:15,329: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2024-05-16 15:36:15,349: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:36:15,364: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:36:15,380: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2024-05-16 15:36:15,395: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:36:15,396: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2024-05-16 15:36:15,396: WARNING/ForkPoolWorker-1] AttributeError: '_Code' object has no attribute 'co_positions'
[2024-05-16 15:36:15,401: WARNING/ForkPoolWorker-1] Call stack:
[2024-05-16 15:36:15,413: WARNING/ForkPoolWorker-1]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2024-05-16 15:36:15,417: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2024-05-16 15:36:15,418: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2024-05-16 15:36:15,419: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2024-05-16 15:36:15,420: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2024-05-16 15:36:15,420: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2024-05-16 15:36:15,421: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2024-05-16 15:36:15,421: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2024-05-16 15:36:15,422: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2024-05-16 15:36:15,422: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2024-05-16 15:36:15,423: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2024-05-16 15:36:15,423: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2024-05-16 15:36:15,424: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2024-05-16 15:36:15,425: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2024-05-16 15:36:15,426: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2024-05-16 15:36:15,431: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2024-05-16 15:36:15,436: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2024-05-16 15:36:15,444: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2024-05-16 15:36:15,462: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2024-05-16 15:36:15,468: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2024-05-16 15:36:15,471: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2024-05-16 15:36:15,479: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2024-05-16 15:36:15,483: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2024-05-16 15:36:15,494: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2024-05-16 15:36:15,495: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2024-05-16 15:36:15,495: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2024-05-16 15:36:15,495: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2024-05-16 15:36:15,496: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2024-05-16 15:36:15,498: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2024-05-16 15:36:15,499: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2024-05-16 15:36:15,500: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2024-05-16 15:36:15,501: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2024-05-16 15:36:15,503: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2024-05-16 15:36:15,505: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2024-05-16 15:36:15,506: WARNING/ForkPoolWorker-1] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@b425650180b2', 'id': 'c72629f9-ba88-471a-9122-98cc605c38ba', 'name': 'download_stream_url', 'exc': "FileNotFoundError(2, 'No such file or directory')", 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 117, in download_stream_url\n    with open(fragment_filename, "ab") as f:\n         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nFileNotFoundError: [Errno 2] No such file or directory: \'project/downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715873733807-1.ts\'\n', 'args': '[]', 'kwargs': '{}', 'description': 'raised unexpected', 'internal': False}
[2024-05-16 15:36:41,477: INFO/MainProcess] Task download_stream_url[46c4f904-e6b2-41c6-83fd-5ad2da2c7949] received
[2024-05-16 15:36:41,488: WARNING/ForkPoolWorker-1] Recording video... https://live-wuxi.cgtn.com/live/wx_cgtn_1000k_internalnormal.m3u8
[2024-05-16 15:36:41,488: WARNING/ForkPoolWorker-1] load m3u8..
[2024-05-16 15:36:43,189: WARNING/ForkPoolWorker-1]  Recording fragment 1 segment 1...
[2024-05-16 15:36:43,196: WARNING/ForkPoolWorker-1] --- Logging error ---
[2024-05-16 15:36:43,198: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 15:36:43,199: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:36:43,199: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:36:43,200: WARNING/ForkPoolWorker-1]   File "/usr/src/app/worker.py", line 117, in download_stream_url
    with open(fragment_filename, "ab") as f:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:36:43,200: WARNING/ForkPoolWorker-1] FileNotFoundError: [Errno 2] No such file or directory: 'project/downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715873763814-1.ts'
[2024-05-16 15:36:43,201: WARNING/ForkPoolWorker-1] 
During handling of the above exception, another exception occurred:
[2024-05-16 15:36:43,202: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 15:36:43,202: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:36:43,203: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2024-05-16 15:36:43,203: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:36:43,204: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:36:43,204: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:36:43,204: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2024-05-16 15:36:43,205: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:36:43,205: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:36:43,206: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2024-05-16 15:36:43,206: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:36:43,206: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2024-05-16 15:36:43,207: WARNING/ForkPoolWorker-1] AttributeError: '_Code' object has no attribute 'co_positions'
[2024-05-16 15:36:43,210: WARNING/ForkPoolWorker-1] Call stack:
[2024-05-16 15:36:43,210: WARNING/ForkPoolWorker-1]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2024-05-16 15:36:43,211: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2024-05-16 15:36:43,211: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2024-05-16 15:36:43,212: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2024-05-16 15:36:43,212: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2024-05-16 15:36:43,212: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2024-05-16 15:36:43,213: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2024-05-16 15:36:43,213: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2024-05-16 15:36:43,214: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2024-05-16 15:36:43,215: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2024-05-16 15:36:43,215: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2024-05-16 15:36:43,216: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2024-05-16 15:36:43,216: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2024-05-16 15:36:43,216: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2024-05-16 15:36:43,217: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2024-05-16 15:36:43,217: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2024-05-16 15:36:43,217: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2024-05-16 15:36:43,218: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2024-05-16 15:36:43,218: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2024-05-16 15:36:43,219: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2024-05-16 15:36:43,219: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2024-05-16 15:36:43,219: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2024-05-16 15:36:43,220: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2024-05-16 15:36:43,220: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2024-05-16 15:36:43,220: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2024-05-16 15:36:43,221: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2024-05-16 15:36:43,221: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2024-05-16 15:36:43,222: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2024-05-16 15:36:43,222: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2024-05-16 15:36:43,223: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2024-05-16 15:36:43,223: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2024-05-16 15:36:43,223: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2024-05-16 15:36:43,224: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2024-05-16 15:36:43,224: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2024-05-16 15:36:43,224: WARNING/ForkPoolWorker-1] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@b425650180b2', 'id': '46c4f904-e6b2-41c6-83fd-5ad2da2c7949', 'name': 'download_stream_url', 'exc': "FileNotFoundError(2, 'No such file or directory')", 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 117, in download_stream_url\n    with open(fragment_filename, "ab") as f:\n         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nFileNotFoundError: [Errno 2] No such file or directory: \'project/downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715873763814-1.ts\'\n', 'args': '[]', 'kwargs': '{}', 'description': 'raised unexpected', 'internal': False}
[2024-05-16 15:37:17,167: INFO/MainProcess] Task download_stream_url[8e6297ed-97c8-44c0-b65f-61bedc184fe9] received
[2024-05-16 15:37:17,173: WARNING/ForkPoolWorker-1] Recording video... https://live-wuxi.cgtn.com/live/wx_cgtn_1000k_internalnormal.m3u8
[2024-05-16 15:37:17,175: WARNING/ForkPoolWorker-1] load m3u8..
[2024-05-16 15:37:20,225: WARNING/ForkPoolWorker-1]  Recording fragment 1 segment 1...
[2024-05-16 15:37:20,229: WARNING/ForkPoolWorker-1] --- Logging error ---
[2024-05-16 15:37:20,232: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 15:37:20,232: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:37:20,233: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:37:20,234: WARNING/ForkPoolWorker-1]   File "/usr/src/app/worker.py", line 117, in download_stream_url
    with open(fragment_filename, "ab") as f:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:37:20,234: WARNING/ForkPoolWorker-1] FileNotFoundError: [Errno 2] No such file or directory: 'project/downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715873799789-1.ts'
[2024-05-16 15:37:20,234: WARNING/ForkPoolWorker-1] 
During handling of the above exception, another exception occurred:
[2024-05-16 15:37:20,235: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 15:37:20,236: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:37:20,236: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2024-05-16 15:37:20,236: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:37:20,237: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:37:20,237: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:37:20,237: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2024-05-16 15:37:20,238: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:37:20,238: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:37:20,239: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2024-05-16 15:37:20,239: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:37:20,239: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2024-05-16 15:37:20,240: WARNING/ForkPoolWorker-1] AttributeError: '_Code' object has no attribute 'co_positions'
[2024-05-16 15:37:20,240: WARNING/ForkPoolWorker-1] Call stack:
[2024-05-16 15:37:20,241: WARNING/ForkPoolWorker-1]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2024-05-16 15:37:20,241: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2024-05-16 15:37:20,241: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2024-05-16 15:37:20,242: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2024-05-16 15:37:20,242: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2024-05-16 15:37:20,242: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2024-05-16 15:37:20,243: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2024-05-16 15:37:20,243: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2024-05-16 15:37:20,243: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2024-05-16 15:37:20,243: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2024-05-16 15:37:20,244: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2024-05-16 15:37:20,244: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2024-05-16 15:37:20,244: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2024-05-16 15:37:20,244: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2024-05-16 15:37:20,245: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2024-05-16 15:37:20,245: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2024-05-16 15:37:20,247: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2024-05-16 15:37:20,247: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2024-05-16 15:37:20,248: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2024-05-16 15:37:20,248: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2024-05-16 15:37:20,248: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2024-05-16 15:37:20,249: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2024-05-16 15:37:20,249: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2024-05-16 15:37:20,249: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2024-05-16 15:37:20,250: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2024-05-16 15:37:20,253: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2024-05-16 15:37:20,253: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2024-05-16 15:37:20,254: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2024-05-16 15:37:20,254: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2024-05-16 15:37:20,254: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2024-05-16 15:37:20,254: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2024-05-16 15:37:20,255: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2024-05-16 15:37:20,255: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2024-05-16 15:37:20,255: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2024-05-16 15:37:20,256: WARNING/ForkPoolWorker-1] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@b425650180b2', 'id': '8e6297ed-97c8-44c0-b65f-61bedc184fe9', 'name': 'download_stream_url', 'exc': "FileNotFoundError(2, 'No such file or directory')", 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 117, in download_stream_url\n    with open(fragment_filename, "ab") as f:\n         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nFileNotFoundError: [Errno 2] No such file or directory: \'project/downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715873799789-1.ts\'\n', 'args': '[]', 'kwargs': '{}', 'description': 'raised unexpected', 'internal': False}
[2024-05-16 15:37:49,406: INFO/MainProcess] Task download_stream_url[50d36190-03cc-4955-af72-207abdc5636f] received
[2024-05-16 15:37:49,418: WARNING/ForkPoolWorker-1] Recording video... https://live-wuxi.cgtn.com/live/wx_cgtn_1000k_internalnormal.m3u8
[2024-05-16 15:37:49,443: WARNING/ForkPoolWorker-1] load m3u8..
[2024-05-16 15:37:51,788: WARNING/ForkPoolWorker-1]  Recording fragment 1 segment 1...
[2024-05-16 15:37:51,798: WARNING/ForkPoolWorker-1] --- Logging error ---
[2024-05-16 15:37:51,799: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 15:37:51,800: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:37:51,800: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:37:51,801: WARNING/ForkPoolWorker-1]   File "/usr/src/app/worker.py", line 117, in download_stream_url
    with open(fragment_filename, "ab") as f:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:37:51,801: WARNING/ForkPoolWorker-1] FileNotFoundError: [Errno 2] No such file or directory: 'project/downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715873829914-1.ts'
[2024-05-16 15:37:51,802: WARNING/ForkPoolWorker-1] 
During handling of the above exception, another exception occurred:
[2024-05-16 15:37:51,802: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 15:37:51,803: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:37:51,803: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2024-05-16 15:37:51,803: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:37:51,804: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:37:51,804: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:37:51,805: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2024-05-16 15:37:51,805: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:37:51,806: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:37:51,807: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2024-05-16 15:37:51,807: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:37:51,807: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2024-05-16 15:37:51,808: WARNING/ForkPoolWorker-1] AttributeError: '_Code' object has no attribute 'co_positions'
[2024-05-16 15:37:51,808: WARNING/ForkPoolWorker-1] Call stack:
[2024-05-16 15:37:51,809: WARNING/ForkPoolWorker-1]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2024-05-16 15:37:51,810: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2024-05-16 15:37:51,810: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2024-05-16 15:37:51,810: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2024-05-16 15:37:51,811: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2024-05-16 15:37:51,811: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2024-05-16 15:37:51,812: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2024-05-16 15:37:51,812: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2024-05-16 15:37:51,812: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2024-05-16 15:37:51,813: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2024-05-16 15:37:51,813: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2024-05-16 15:37:51,814: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2024-05-16 15:37:51,814: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2024-05-16 15:37:51,815: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2024-05-16 15:37:51,815: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2024-05-16 15:37:51,815: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2024-05-16 15:37:51,816: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2024-05-16 15:37:51,816: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2024-05-16 15:37:51,816: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2024-05-16 15:37:51,817: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2024-05-16 15:37:51,817: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2024-05-16 15:37:51,818: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2024-05-16 15:37:51,818: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2024-05-16 15:37:51,818: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2024-05-16 15:37:51,819: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2024-05-16 15:37:51,819: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2024-05-16 15:37:51,820: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2024-05-16 15:37:51,820: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2024-05-16 15:37:51,820: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2024-05-16 15:37:51,821: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2024-05-16 15:37:51,822: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2024-05-16 15:37:51,822: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2024-05-16 15:37:51,823: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2024-05-16 15:37:51,823: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2024-05-16 15:37:51,824: WARNING/ForkPoolWorker-1] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@b425650180b2', 'id': '50d36190-03cc-4955-af72-207abdc5636f', 'name': 'download_stream_url', 'exc': "FileNotFoundError(2, 'No such file or directory')", 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 117, in download_stream_url\n    with open(fragment_filename, "ab") as f:\n         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nFileNotFoundError: [Errno 2] No such file or directory: \'project/downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715873829914-1.ts\'\n', 'args': '[]', 'kwargs': '{}', 'description': 'raised unexpected', 'internal': False}
[2024-05-16 15:38:21,263: INFO/MainProcess] Task download_stream_url[546e9cdc-127d-4aa2-8891-cd6230cdbdac] received
[2024-05-16 15:38:21,271: WARNING/ForkPoolWorker-1] Recording video... https://live-wuxi.cgtn.com/live/wx_cgtn_1000k_internalnormal.m3u8
[2024-05-16 15:38:21,274: WARNING/ForkPoolWorker-1] load m3u8..
[2024-05-16 15:38:22,542: WARNING/ForkPoolWorker-1]  Recording fragment 1 segment 1...
[2024-05-16 15:38:22,546: WARNING/ForkPoolWorker-1] --- Logging error ---
[2024-05-16 15:38:22,547: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 15:38:22,548: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:38:22,548: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:38:22,548: WARNING/ForkPoolWorker-1]   File "/usr/src/app/worker.py", line 117, in download_stream_url
    with open(fragment_filename, "ab") as f:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:38:22,549: WARNING/ForkPoolWorker-1] FileNotFoundError: [Errno 2] No such file or directory: 'project/downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715873853920-1.ts'
[2024-05-16 15:38:22,552: WARNING/ForkPoolWorker-1] 
During handling of the above exception, another exception occurred:
[2024-05-16 15:38:22,552: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 15:38:22,553: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:38:22,554: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2024-05-16 15:38:22,554: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:38:22,555: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:38:22,555: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:38:22,555: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2024-05-16 15:38:22,556: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:38:22,556: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:38:22,556: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2024-05-16 15:38:22,557: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:38:22,557: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2024-05-16 15:38:22,557: WARNING/ForkPoolWorker-1] AttributeError: '_Code' object has no attribute 'co_positions'
[2024-05-16 15:38:22,558: WARNING/ForkPoolWorker-1] Call stack:
[2024-05-16 15:38:22,558: WARNING/ForkPoolWorker-1]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2024-05-16 15:38:22,559: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2024-05-16 15:38:22,559: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2024-05-16 15:38:22,560: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2024-05-16 15:38:22,560: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2024-05-16 15:38:22,560: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2024-05-16 15:38:22,560: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2024-05-16 15:38:22,561: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2024-05-16 15:38:22,561: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2024-05-16 15:38:22,561: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2024-05-16 15:38:22,562: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2024-05-16 15:38:22,562: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2024-05-16 15:38:22,562: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2024-05-16 15:38:22,563: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2024-05-16 15:38:22,563: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2024-05-16 15:38:22,563: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2024-05-16 15:38:22,564: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2024-05-16 15:38:22,564: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2024-05-16 15:38:22,564: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2024-05-16 15:38:22,564: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2024-05-16 15:38:22,565: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2024-05-16 15:38:22,565: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2024-05-16 15:38:22,565: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2024-05-16 15:38:22,567: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2024-05-16 15:38:22,568: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2024-05-16 15:38:22,568: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2024-05-16 15:38:22,569: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2024-05-16 15:38:22,569: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2024-05-16 15:38:22,570: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2024-05-16 15:38:22,570: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2024-05-16 15:38:22,571: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2024-05-16 15:38:22,571: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2024-05-16 15:38:22,571: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2024-05-16 15:38:22,572: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2024-05-16 15:38:22,572: WARNING/ForkPoolWorker-1] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@b425650180b2', 'id': '546e9cdc-127d-4aa2-8891-cd6230cdbdac', 'name': 'download_stream_url', 'exc': "FileNotFoundError(2, 'No such file or directory')", 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 117, in download_stream_url\n    with open(fragment_filename, "ab") as f:\n         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nFileNotFoundError: [Errno 2] No such file or directory: \'project/downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715873853920-1.ts\'\n', 'args': '[]', 'kwargs': '{}', 'description': 'raised unexpected', 'internal': False}
[2024-05-16 15:43:58,529: INFO/MainProcess] Connected to redis://redis:6379/0
[2024-05-16 15:43:58,554: INFO/MainProcess] mingle: searching for neighbors
[2024-05-16 15:43:59,584: INFO/MainProcess] mingle: all alone
[2024-05-16 15:43:59,612: INFO/MainProcess] celery@7404f8faa6b2 ready.
[2024-05-16 15:44:04,103: INFO/MainProcess] Events of group {task} enabled by remote.
[2024-05-16 15:44:44,995: INFO/MainProcess] Task download_stream_url[09942dab-d506-49a1-848d-83fe77b170fa] received
[2024-05-16 15:44:45,004: WARNING/ForkPoolWorker-1] Recording video... https://live-wuxi.cgtn.com/live/wx_cgtn_1000k_internalnormal.m3u8
[2024-05-16 15:44:45,005: WARNING/ForkPoolWorker-1] load m3u8..
[2024-05-16 15:44:47,638: WARNING/ForkPoolWorker-1]  Recording fragment 1 segment 1...
[2024-05-16 15:44:47,659: WARNING/ForkPoolWorker-1] --- Logging error ---
[2024-05-16 15:44:47,662: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 15:44:47,662: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:44:47,663: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:44:47,664: WARNING/ForkPoolWorker-1]   File "/usr/src/app/worker.py", line 117, in download_stream_url
    with open(fragment_filename, "ab") as f:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:44:47,665: WARNING/ForkPoolWorker-1] FileNotFoundError: [Errno 2] No such file or directory: 'project/downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715874249794-1.ts'
[2024-05-16 15:44:47,665: WARNING/ForkPoolWorker-1] 
During handling of the above exception, another exception occurred:
[2024-05-16 15:44:47,666: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 15:44:47,667: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:44:47,667: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2024-05-16 15:44:47,668: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:44:47,669: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:44:47,669: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:44:47,670: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2024-05-16 15:44:47,670: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:44:47,671: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:44:47,671: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2024-05-16 15:44:47,672: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:44:47,673: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2024-05-16 15:44:47,673: WARNING/ForkPoolWorker-1] AttributeError: '_Code' object has no attribute 'co_positions'
[2024-05-16 15:44:47,674: WARNING/ForkPoolWorker-1] Call stack:
[2024-05-16 15:44:47,678: WARNING/ForkPoolWorker-1]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2024-05-16 15:44:47,678: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2024-05-16 15:44:47,679: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2024-05-16 15:44:47,680: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2024-05-16 15:44:47,680: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2024-05-16 15:44:47,681: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2024-05-16 15:44:47,681: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2024-05-16 15:44:47,682: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2024-05-16 15:44:47,683: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2024-05-16 15:44:47,683: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2024-05-16 15:44:47,684: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2024-05-16 15:44:47,685: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2024-05-16 15:44:47,686: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2024-05-16 15:44:47,686: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2024-05-16 15:44:47,687: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2024-05-16 15:44:47,688: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2024-05-16 15:44:47,689: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2024-05-16 15:44:47,690: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2024-05-16 15:44:47,690: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2024-05-16 15:44:47,691: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2024-05-16 15:44:47,691: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2024-05-16 15:44:47,692: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2024-05-16 15:44:47,693: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2024-05-16 15:44:47,693: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2024-05-16 15:44:47,694: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2024-05-16 15:44:47,694: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2024-05-16 15:44:47,695: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2024-05-16 15:44:47,695: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2024-05-16 15:44:47,696: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2024-05-16 15:44:47,696: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2024-05-16 15:44:47,697: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2024-05-16 15:44:47,697: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2024-05-16 15:44:47,698: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2024-05-16 15:44:47,698: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2024-05-16 15:44:47,699: WARNING/ForkPoolWorker-1] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@7404f8faa6b2', 'id': '09942dab-d506-49a1-848d-83fe77b170fa', 'name': 'download_stream_url', 'exc': "FileNotFoundError(2, 'No such file or directory')", 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 117, in download_stream_url\n    with open(fragment_filename, "ab") as f:\n         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nFileNotFoundError: [Errno 2] No such file or directory: \'project/downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715874249794-1.ts\'\n', 'args': '[]', 'kwargs': '{}', 'description': 'raised unexpected', 'internal': False}
[2024-05-16 15:49:10,255: INFO/MainProcess] Connected to redis://redis:6379/0
[2024-05-16 15:49:10,258: INFO/MainProcess] mingle: searching for neighbors
[2024-05-16 15:49:11,268: INFO/MainProcess] mingle: all alone
[2024-05-16 15:49:11,284: INFO/MainProcess] celery@247be4a9565c ready.
[2024-05-16 15:49:15,430: INFO/MainProcess] Events of group {task} enabled by remote.
[2024-05-16 15:49:44,074: INFO/MainProcess] Task download_stream_url[5eb0de22-a388-4db6-addd-724ae20dcaa2] received
[2024-05-16 15:49:44,092: WARNING/ForkPoolWorker-1] Recording video... https://live-wuxi.cgtn.com/live/wx_cgtn_1000k_internalnormal.m3u8
[2024-05-16 15:49:44,110: WARNING/ForkPoolWorker-1] load m3u8..
[2024-05-16 15:49:46,735: WARNING/ForkPoolWorker-1]  Recording fragment 1 segment 1...
[2024-05-16 15:49:48,520: WARNING/ForkPoolWorker-1]  Recording fragment 1 segment 2...
[2024-05-16 15:49:50,342: WARNING/ForkPoolWorker-1]  Recording fragment 1 segment 3...
[2024-05-16 15:49:52,114: WARNING/ForkPoolWorker-1]  Recording fragment 1 segment 4...
[2024-05-16 15:49:54,060: WARNING/ForkPoolWorker-1]  Recording fragment 2 segment 5...
[2024-05-16 15:49:55,844: WARNING/ForkPoolWorker-1]  Recording fragment 2 segment 6...
[2024-05-16 15:49:56,721: WARNING/ForkPoolWorker-1] sleep 18.0s
[2024-05-16 15:50:14,722: WARNING/ForkPoolWorker-1] load m3u8..
[2024-05-16 15:50:16,424: WARNING/ForkPoolWorker-1]  Recording fragment 2 segment 7...
[2024-05-16 15:50:18,265: WARNING/ForkPoolWorker-1]  Recording fragment 2 segment 8...
[2024-05-16 15:50:20,465: WARNING/ForkPoolWorker-1]  Recording fragment 3 segment 9...
[2024-05-16 15:50:22,616: WARNING/ForkPoolWorker-1]  Recording fragment 3 segment 10...
[2024-05-16 15:50:24,418: WARNING/ForkPoolWorker-1]  Recording fragment 3 segment 11...
[2024-05-16 15:50:25,337: WARNING/ForkPoolWorker-1] sleep 18.0s
[2024-05-16 15:50:43,338: WARNING/ForkPoolWorker-1]     done: fragment_filename_list ['downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715874543834-1.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715874567811-2.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715874591797-3.ts']
[2024-05-16 15:50:43,351: INFO/MainProcess] Task create_task_list[1b686cff-8a3d-4f50-8ae9-17cab97b8cc7] received
[2024-05-16 15:50:43,353: INFO/ForkPoolWorker-1] Task download_stream_url[5eb0de22-a388-4db6-addd-724ae20dcaa2] succeeded in 59.26359283400234s: ['downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715874543834-1.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715874567811-2.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715874591797-3.ts']
[2024-05-16 15:50:43,363: INFO/MainProcess] Task create_task[d78db3a5-ac79-485c-ab77-a75e724f879c] received
[2024-05-16 15:50:43,366: INFO/MainProcess] Task create_task[8dea0ae6-0dbc-40ce-bd48-0a8cc94dd947] received
[2024-05-16 15:50:43,367: WARNING/ForkPoolWorker-2] create_taskdownloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715874567811-2.ts
[2024-05-16 15:50:43,367: WARNING/ForkPoolWorker-1] create_taskdownloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715874543834-1.ts
[2024-05-16 15:50:43,370: INFO/ForkPoolWorker-1] Task create_task[d78db3a5-ac79-485c-ab77-a75e724f879c] succeeded in 0.0030102139971859287s: True
[2024-05-16 15:50:43,373: INFO/MainProcess] Task create_task[44b46131-4700-49e0-8632-562a5f00ce2e] received
[2024-05-16 15:50:43,373: INFO/ForkPoolWorker-2] Task create_task[8dea0ae6-0dbc-40ce-bd48-0a8cc94dd947] succeeded in 0.005809319998661522s: True
[2024-05-16 15:50:43,375: WARNING/ForkPoolWorker-1] create_taskdownloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715874591797-3.ts
[2024-05-16 15:50:43,376: WARNING/ForkPoolWorker-3] --- Logging error ---
[2024-05-16 15:50:43,377: INFO/ForkPoolWorker-1] Task create_task[44b46131-4700-49e0-8632-562a5f00ce2e] succeeded in 0.0017145650017482694s: True
[2024-05-16 15:50:43,379: WARNING/ForkPoolWorker-3] Traceback (most recent call last):
[2024-05-16 15:50:43,380: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:50:43,380: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:50:43,381: WARNING/ForkPoolWorker-3]   File "/usr/src/app/worker.py", line 188, in create_task_list
[2024-05-16 15:50:43,381: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 677, in get
    return (self.join_native if self.supports_native_join else self.join)(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:50:43,382: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 794, in join_native
    assert_will_not_block()
[2024-05-16 15:50:43,383: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 38, in assert_will_not_block
    raise RuntimeError(E_WOULDBLOCK)
[2024-05-16 15:50:43,383: WARNING/ForkPoolWorker-3] RuntimeError: Never call result.get() within a task!
See http://docs.celeryq.org/en/latest/userguide/tasks.html#task-synchronous-subtasks
[2024-05-16 15:50:43,384: WARNING/ForkPoolWorker-3] 
During handling of the above exception, another exception occurred:
[2024-05-16 15:50:43,384: WARNING/ForkPoolWorker-3] Traceback (most recent call last):
[2024-05-16 15:50:43,385: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:50:43,386: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2024-05-16 15:50:43,386: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:50:43,387: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:50:43,387: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:50:43,388: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2024-05-16 15:50:43,389: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:50:43,389: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:50:43,390: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2024-05-16 15:50:43,390: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:50:43,391: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2024-05-16 15:50:43,392: WARNING/ForkPoolWorker-3] AttributeError: '_Code' object has no attribute 'co_positions'
[2024-05-16 15:50:43,392: WARNING/ForkPoolWorker-3] Call stack:
[2024-05-16 15:50:43,395: WARNING/ForkPoolWorker-3]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2024-05-16 15:50:43,395: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2024-05-16 15:50:43,396: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2024-05-16 15:50:43,397: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2024-05-16 15:50:43,397: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2024-05-16 15:50:43,398: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2024-05-16 15:50:43,398: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2024-05-16 15:50:43,399: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2024-05-16 15:50:43,399: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2024-05-16 15:50:43,400: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2024-05-16 15:50:43,400: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2024-05-16 15:50:43,401: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2024-05-16 15:50:43,402: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2024-05-16 15:50:43,402: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2024-05-16 15:50:43,403: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2024-05-16 15:50:43,403: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2024-05-16 15:50:43,404: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2024-05-16 15:50:43,404: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2024-05-16 15:50:43,405: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2024-05-16 15:50:43,406: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2024-05-16 15:50:43,406: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2024-05-16 15:50:43,407: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2024-05-16 15:50:43,407: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2024-05-16 15:50:43,408: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2024-05-16 15:50:43,408: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2024-05-16 15:50:43,409: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2024-05-16 15:50:43,409: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2024-05-16 15:50:43,410: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2024-05-16 15:50:43,411: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2024-05-16 15:50:43,411: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2024-05-16 15:50:43,412: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2024-05-16 15:50:43,412: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2024-05-16 15:50:43,413: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2024-05-16 15:50:43,413: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2024-05-16 15:50:43,414: WARNING/ForkPoolWorker-3] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@247be4a9565c', 'id': '1b686cff-8a3d-4f50-8ae9-17cab97b8cc7', 'name': 'create_task_list', 'exc': "RuntimeError('Never call result.get() within a task!\\nSee http://docs.celeryq.org/en/latest/userguide/tasks.html#task-synchronous-subtasks\\n')", 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 188, in create_task_list\n  File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 677, in get\n    return (self.join_native if self.supports_native_join else self.join)(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 794, in join_native\n    assert_will_not_block()\n  File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 38, in assert_will_not_block\n    raise RuntimeError(E_WOULDBLOCK)\nRuntimeError: Never call result.get() within a task!\nSee http://docs.celeryq.org/en/latest/userguide/tasks.html#task-synchronous-subtasks\n\n', 'args': "[['downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715874543834-1.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715874567811-2.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715874591797-3.ts']]", 'kwargs': '{}', 'description': 'raised unexpected', 'internal': False}
[2024-05-16 16:14:06,344: INFO/MainProcess] Task download_stream_url[3a619eb1-ae31-49d3-bc57-1a89cba67748] received
[2024-05-16 16:14:06,354: WARNING/ForkPoolWorker-1] Recording video... https://live-wuxi.cgtn.com/live/wx_cgtn_1000k_internalnormal.m3u8
[2024-05-16 16:14:06,363: WARNING/ForkPoolWorker-1] load m3u8..
[2024-05-16 16:14:09,164: WARNING/ForkPoolWorker-1]  Recording fragment 1 segment 1...
[2024-05-16 16:14:10,940: WARNING/ForkPoolWorker-1]  Recording fragment 2 segment 2...
[2024-05-16 16:14:12,710: WARNING/ForkPoolWorker-1]  Recording fragment 3 segment 3...
[2024-05-16 16:14:14,472: WARNING/ForkPoolWorker-1]  Recording fragment 4 segment 4...
[2024-05-16 16:14:16,284: WARNING/ForkPoolWorker-1]  Recording fragment 5 segment 5...
[2024-05-16 16:14:18,091: WARNING/ForkPoolWorker-1]  Recording fragment 6 segment 6...
[2024-05-16 16:14:18,952: WARNING/ForkPoolWorker-1] sleep 18.0s
[2024-05-16 16:14:36,953: WARNING/ForkPoolWorker-1]     done: fragment_filename_list ['downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876007823-1.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876013898-2.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876019890-3.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876025894-4.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876031869-5.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876037915-6.ts']
[2024-05-16 16:14:36,963: INFO/ForkPoolWorker-1] Task download_stream_url[3a619eb1-ae31-49d3-bc57-1a89cba67748] succeeded in 30.610918354002933s: ['downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876007823-1.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876013898-2.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876019890-3.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876025894-4.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876031869-5.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876037915-6.ts']
[2024-05-16 16:14:36,963: INFO/MainProcess] Task create_task_list[0380b2d7-2c29-4fcf-9010-fad9d78a7fbf] received
[2024-05-16 16:14:36,975: INFO/MainProcess] Task create_task[666fe922-5814-4cf8-831d-96c5360c0bc1] received
[2024-05-16 16:14:36,980: INFO/MainProcess] Task create_task[76abe1f8-f272-4eca-a549-ca09a0ab1f2c] received
[2024-05-16 16:14:36,983: WARNING/ForkPoolWorker-2] create_taskdownloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876013898-2.ts
[2024-05-16 16:14:36,983: WARNING/ForkPoolWorker-3] create_taskdownloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876007823-1.ts
[2024-05-16 16:14:36,988: INFO/ForkPoolWorker-2] Task create_task[76abe1f8-f272-4eca-a549-ca09a0ab1f2c] succeeded in 0.005228169000474736s: True
[2024-05-16 16:14:36,989: INFO/ForkPoolWorker-3] Task create_task[666fe922-5814-4cf8-831d-96c5360c0bc1] succeeded in 0.0070523639988095965s: True
[2024-05-16 16:14:36,992: INFO/MainProcess] Task create_task[c31ab6ff-6b2b-40ca-9962-7a9ae97253e8] received
[2024-05-16 16:14:36,997: INFO/MainProcess] Task create_task[7db38033-f6d7-4780-ad11-05405bf4ec9b] received
[2024-05-16 16:14:37,000: WARNING/ForkPoolWorker-2] create_taskdownloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876025894-4.ts
[2024-05-16 16:14:37,000: WARNING/ForkPoolWorker-3] create_taskdownloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876019890-3.ts
[2024-05-16 16:14:37,001: WARNING/ForkPoolWorker-1] --- Logging error ---
[2024-05-16 16:14:37,001: INFO/MainProcess] Task create_task[3daa75b0-422b-4b68-bc1e-a8425167b44b] received
[2024-05-16 16:14:37,001: INFO/ForkPoolWorker-3] Task create_task[c31ab6ff-6b2b-40ca-9962-7a9ae97253e8] succeeded in 0.002046805999270873s: True
[2024-05-16 16:14:37,001: INFO/ForkPoolWorker-2] Task create_task[7db38033-f6d7-4780-ad11-05405bf4ec9b] succeeded in 0.0016929880002862774s: True
[2024-05-16 16:14:37,003: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 16:14:37,004: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:14:37,004: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:14:37,005: WARNING/ForkPoolWorker-1]   File "/usr/src/app/worker.py", line 188, in create_task_list
[2024-05-16 16:14:37,005: INFO/MainProcess] Task create_task[294744c5-43e3-4106-a5ff-fc0a8b9996e5] received
[2024-05-16 16:14:37,006: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 677, in get
    return (self.join_native if self.supports_native_join else self.join)(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:14:37,006: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 794, in join_native
    assert_will_not_block()
[2024-05-16 16:14:37,007: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 38, in assert_will_not_block
    raise RuntimeError(E_WOULDBLOCK)
[2024-05-16 16:14:37,007: WARNING/ForkPoolWorker-3] create_taskdownloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876031869-5.ts
[2024-05-16 16:14:37,007: WARNING/ForkPoolWorker-1] RuntimeError: Never call result.get() within a task!
See http://docs.celeryq.org/en/latest/userguide/tasks.html#task-synchronous-subtasks
[2024-05-16 16:14:37,007: WARNING/ForkPoolWorker-2] create_taskdownloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876037915-6.ts
[2024-05-16 16:14:37,008: WARNING/ForkPoolWorker-1] 
During handling of the above exception, another exception occurred:
[2024-05-16 16:14:37,008: INFO/ForkPoolWorker-3] Task create_task[3daa75b0-422b-4b68-bc1e-a8425167b44b] succeeded in 0.0017781919996195938s: True
[2024-05-16 16:14:37,009: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 16:14:37,010: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:14:37,010: INFO/ForkPoolWorker-2] Task create_task[294744c5-43e3-4106-a5ff-fc0a8b9996e5] succeeded in 0.002717440002015792s: True
[2024-05-16 16:14:37,010: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2024-05-16 16:14:37,011: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:14:37,012: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:14:37,012: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:14:37,013: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2024-05-16 16:14:37,013: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:14:37,014: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:14:37,015: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2024-05-16 16:14:37,015: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:14:37,016: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2024-05-16 16:14:37,016: WARNING/ForkPoolWorker-1] AttributeError: '_Code' object has no attribute 'co_positions'
[2024-05-16 16:14:37,017: WARNING/ForkPoolWorker-1] Call stack:
[2024-05-16 16:14:37,020: WARNING/ForkPoolWorker-1]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2024-05-16 16:14:37,021: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2024-05-16 16:14:37,022: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2024-05-16 16:14:37,022: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2024-05-16 16:14:37,023: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2024-05-16 16:14:37,023: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2024-05-16 16:14:37,024: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2024-05-16 16:14:37,024: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2024-05-16 16:14:37,025: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2024-05-16 16:14:37,025: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2024-05-16 16:14:37,026: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2024-05-16 16:14:37,026: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2024-05-16 16:14:37,027: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2024-05-16 16:14:37,027: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2024-05-16 16:14:37,028: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2024-05-16 16:14:37,028: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2024-05-16 16:14:37,029: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2024-05-16 16:14:37,029: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2024-05-16 16:14:37,030: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2024-05-16 16:14:37,030: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2024-05-16 16:14:37,031: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2024-05-16 16:14:37,031: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2024-05-16 16:14:37,032: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2024-05-16 16:14:37,032: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2024-05-16 16:14:37,033: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2024-05-16 16:14:37,033: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2024-05-16 16:14:37,034: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2024-05-16 16:14:37,034: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2024-05-16 16:14:37,034: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2024-05-16 16:14:37,035: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2024-05-16 16:14:37,035: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2024-05-16 16:14:37,036: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2024-05-16 16:14:37,036: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2024-05-16 16:14:37,037: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2024-05-16 16:14:37,037: WARNING/ForkPoolWorker-1] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@247be4a9565c', 'id': '0380b2d7-2c29-4fcf-9010-fad9d78a7fbf', 'name': 'create_task_list', 'exc': "RuntimeError('Never call result.get() within a task!\\nSee http://docs.celeryq.org/en/latest/userguide/tasks.html#task-synchronous-subtasks\\n')", 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 188, in create_task_list\n  File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 677, in get\n    return (self.join_native if self.supports_native_join else self.join)(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 794, in join_native\n    assert_will_not_block()\n  File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 38, in assert_will_not_block\n    raise RuntimeError(E_WOULDBLOCK)\nRuntimeError: Never call result.get() within a task!\nSee http://docs.celeryq.org/en/latest/userguide/tasks.html#task-synchronous-subtasks\n\n', 'args': "[['downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876007823-1.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876013898-2.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876019890-3.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876025894-4.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876031869-5.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876037915-6.ts']]", 'kwargs': '{}', 'description': 'raised unexpected', 'internal': False}
[2024-05-16 16:15:36,442: INFO/MainProcess] Task download_stream_url[e8723add-4752-4575-bdaf-1fc3314cf66f] received
[2024-05-16 16:15:36,446: WARNING/ForkPoolWorker-1] Recording video... https://live-wuxi.cgtn.com/live/wx_cgtn_1000k_internalnormal.m3u8
[2024-05-16 16:15:36,448: WARNING/ForkPoolWorker-1] load m3u8..
[2024-05-16 16:15:39,007: WARNING/ForkPoolWorker-1]  Recording fragment 1 segment 1...
[2024-05-16 16:15:40,827: WARNING/ForkPoolWorker-1]  Recording fragment 2 segment 2...
[2024-05-16 16:15:42,624: WARNING/ForkPoolWorker-1]  Recording fragment 3 segment 3...
[2024-05-16 16:15:44,399: WARNING/ForkPoolWorker-1]  Recording fragment 4 segment 4...
[2024-05-16 16:15:46,196: WARNING/ForkPoolWorker-1]  Recording fragment 5 segment 5...
[2024-05-16 16:15:47,944: WARNING/ForkPoolWorker-1]  Recording fragment 6 segment 6...
[2024-05-16 16:15:48,831: WARNING/ForkPoolWorker-1] sleep 18.0s
[2024-05-16 16:16:06,831: WARNING/ForkPoolWorker-1]     done: fragment_filename_list ['downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876097865-1.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876103849-2.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876109873-3.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876115864-4.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876121905-5.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876127878-6.ts']
[2024-05-16 16:16:06,837: INFO/MainProcess] Task create_task_list[15cfdc59-71f3-4174-be0b-5eae2a782cbf] received
[2024-05-16 16:16:06,837: INFO/ForkPoolWorker-1] Task download_stream_url[e8723add-4752-4575-bdaf-1fc3314cf66f] succeeded in 30.391260934000456s: ['downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876097865-1.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876103849-2.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876109873-3.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876115864-4.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876121905-5.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876127878-6.ts']
[2024-05-16 16:16:06,842: INFO/MainProcess] Task create_task[964fe2f4-5f5d-4df5-977f-12bdcc539589] received
[2024-05-16 16:16:06,846: INFO/MainProcess] Task create_task[39712766-c2f9-42ae-99aa-7fff83da9b24] received
[2024-05-16 16:16:06,847: WARNING/ForkPoolWorker-3] create_taskdownloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876097865-1.ts
[2024-05-16 16:16:06,847: WARNING/ForkPoolWorker-2] create_taskdownloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876103849-2.ts
[2024-05-16 16:16:06,849: INFO/ForkPoolWorker-3] Task create_task[964fe2f4-5f5d-4df5-977f-12bdcc539589] succeeded in 0.002112613001372665s: True
[2024-05-16 16:16:06,850: INFO/ForkPoolWorker-2] Task create_task[39712766-c2f9-42ae-99aa-7fff83da9b24] succeeded in 0.0031561690011585597s: True
[2024-05-16 16:16:06,852: INFO/MainProcess] Task create_task[9601b7d2-b531-421d-8d23-a461acbc38ca] received
[2024-05-16 16:16:06,852: WARNING/ForkPoolWorker-1] --- Logging error ---
[2024-05-16 16:16:06,854: INFO/MainProcess] Task create_task[1408f4cf-0efc-483f-b557-285e1a3b7fa7] received
[2024-05-16 16:16:06,855: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 16:16:06,855: WARNING/ForkPoolWorker-3] create_taskdownloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876109873-3.ts
[2024-05-16 16:16:06,856: WARNING/ForkPoolWorker-2] create_taskdownloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876115864-4.ts
[2024-05-16 16:16:06,856: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:16:06,857: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:16:06,857: INFO/ForkPoolWorker-3] Task create_task[9601b7d2-b531-421d-8d23-a461acbc38ca] succeeded in 0.0018721999986155424s: True
[2024-05-16 16:16:06,858: WARNING/ForkPoolWorker-1]   File "/usr/src/app/worker.py", line 188, in create_task_list
[2024-05-16 16:16:06,858: INFO/ForkPoolWorker-2] Task create_task[1408f4cf-0efc-483f-b557-285e1a3b7fa7] succeeded in 0.0020172080003248993s: True
[2024-05-16 16:16:06,858: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 677, in get
    return (self.join_native if self.supports_native_join else self.join)(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:16:06,859: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 794, in join_native
    assert_will_not_block()
[2024-05-16 16:16:06,860: INFO/MainProcess] Task create_task[4e8366f7-ab43-4f80-823c-6188277221db] received
[2024-05-16 16:16:06,860: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 38, in assert_will_not_block
    raise RuntimeError(E_WOULDBLOCK)
[2024-05-16 16:16:06,861: WARNING/ForkPoolWorker-1] RuntimeError: Never call result.get() within a task!
See http://docs.celeryq.org/en/latest/userguide/tasks.html#task-synchronous-subtasks
[2024-05-16 16:16:06,861: WARNING/ForkPoolWorker-1] 
During handling of the above exception, another exception occurred:
[2024-05-16 16:16:06,862: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 16:16:06,862: INFO/MainProcess] Task create_task[44df0291-752f-4e5e-a894-ffadfde5bf5c] received
[2024-05-16 16:16:06,863: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:16:06,863: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2024-05-16 16:16:06,864: WARNING/ForkPoolWorker-3] create_taskdownloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876121905-5.ts
[2024-05-16 16:16:06,864: WARNING/ForkPoolWorker-2] create_taskdownloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876127878-6.ts
[2024-05-16 16:16:06,864: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:16:06,867: INFO/ForkPoolWorker-3] Task create_task[4e8366f7-ab43-4f80-823c-6188277221db] succeeded in 0.003134966998914024s: True
[2024-05-16 16:16:06,867: INFO/ForkPoolWorker-2] Task create_task[44df0291-752f-4e5e-a894-ffadfde5bf5c] succeeded in 0.003107467000518227s: True
[2024-05-16 16:16:06,867: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:16:06,868: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:16:06,869: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2024-05-16 16:16:06,869: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:16:06,870: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:16:06,870: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2024-05-16 16:16:06,871: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:16:06,871: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2024-05-16 16:16:06,872: WARNING/ForkPoolWorker-1] AttributeError: '_Code' object has no attribute 'co_positions'
[2024-05-16 16:16:06,872: WARNING/ForkPoolWorker-1] Call stack:
[2024-05-16 16:16:06,874: WARNING/ForkPoolWorker-1]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2024-05-16 16:16:06,874: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2024-05-16 16:16:06,875: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2024-05-16 16:16:06,875: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2024-05-16 16:16:06,876: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2024-05-16 16:16:06,877: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2024-05-16 16:16:06,877: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2024-05-16 16:16:06,878: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2024-05-16 16:16:06,878: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2024-05-16 16:16:06,879: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2024-05-16 16:16:06,880: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2024-05-16 16:16:06,880: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2024-05-16 16:16:06,881: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2024-05-16 16:16:06,881: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2024-05-16 16:16:06,882: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2024-05-16 16:16:06,882: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2024-05-16 16:16:06,883: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2024-05-16 16:16:06,883: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2024-05-16 16:16:06,884: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2024-05-16 16:16:06,884: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2024-05-16 16:16:06,884: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2024-05-16 16:16:06,885: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2024-05-16 16:16:06,885: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2024-05-16 16:16:06,886: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2024-05-16 16:16:06,886: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2024-05-16 16:16:06,887: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2024-05-16 16:16:06,887: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2024-05-16 16:16:06,888: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2024-05-16 16:16:06,888: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2024-05-16 16:16:06,889: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2024-05-16 16:16:06,889: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2024-05-16 16:16:06,890: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2024-05-16 16:16:06,890: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2024-05-16 16:16:06,891: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2024-05-16 16:16:06,891: WARNING/ForkPoolWorker-1] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@247be4a9565c', 'id': '15cfdc59-71f3-4174-be0b-5eae2a782cbf', 'name': 'create_task_list', 'exc': "RuntimeError('Never call result.get() within a task!\\nSee http://docs.celeryq.org/en/latest/userguide/tasks.html#task-synchronous-subtasks\\n')", 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 188, in create_task_list\n  File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 677, in get\n    return (self.join_native if self.supports_native_join else self.join)(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 794, in join_native\n    assert_will_not_block()\n  File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 38, in assert_will_not_block\n    raise RuntimeError(E_WOULDBLOCK)\nRuntimeError: Never call result.get() within a task!\nSee http://docs.celeryq.org/en/latest/userguide/tasks.html#task-synchronous-subtasks\n\n', 'args': "[['downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876097865-1.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876103849-2.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876109873-3.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876115864-4.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876121905-5.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876127878-6.ts']]", 'kwargs': '{}', 'description': 'raised unexpected', 'internal': False}
[2024-05-16 16:17:46,459: INFO/MainProcess] Task download_YouTube_url[e04d3ed4-9885-439b-8d8b-07f08d239e72] received
[2024-05-16 16:17:46,461: WARNING/ForkPoolWorker-1] download YouTube url 123
[2024-05-16 16:17:46,463: WARNING/ForkPoolWorker-1]     error: regex_search: could not find match for (?:v=|\/)([0-9A-Za-z_-]{11}).*
[2024-05-16 16:17:46,466: INFO/MainProcess] Task create_task[83023f00-032b-458e-a78c-952975c6c059] received
[2024-05-16 16:17:46,466: INFO/ForkPoolWorker-1] Task download_YouTube_url[e04d3ed4-9885-439b-8d8b-07f08d239e72] succeeded in 0.004953540999849793s: None
[2024-05-16 16:17:46,469: INFO/ForkPoolWorker-1] Task create_task[83023f00-032b-458e-a78c-952975c6c059] succeeded in 0.001017648999550147s: False
[2024-05-16 16:19:18,306: INFO/MainProcess] Task download_YouTube_url[aa349bd1-f086-44bb-b97a-68c1cbb5b1f8] received
[2024-05-16 16:19:18,308: WARNING/ForkPoolWorker-1] download YouTube url 123
[2024-05-16 16:19:18,310: WARNING/ForkPoolWorker-1]     error: regex_search: could not find match for (?:v=|\/)([0-9A-Za-z_-]{11}).*
[2024-05-16 16:19:18,314: INFO/MainProcess] Task create_task[21e0f379-aae4-4a5e-ab11-68e2e2462e7f] received
[2024-05-16 16:19:18,314: INFO/ForkPoolWorker-1] Task download_YouTube_url[aa349bd1-f086-44bb-b97a-68c1cbb5b1f8] succeeded in 0.006621329997869907s: None
[2024-05-16 16:19:18,318: INFO/ForkPoolWorker-3] Task create_task[21e0f379-aae4-4a5e-ab11-68e2e2462e7f] succeeded in 0.0007278359989868477s: False
[2024-05-16 16:23:50,237: INFO/MainProcess] Task download_YouTube_url[8e9b3a45-4ac6-4085-99c2-e39649a796b4] received
[2024-05-16 16:23:50,240: WARNING/ForkPoolWorker-1] download YouTube url 123
[2024-05-16 16:23:50,243: WARNING/ForkPoolWorker-1]     error: regex_search: could not find match for (?:v=|\/)([0-9A-Za-z_-]{11}).*
[2024-05-16 16:23:50,256: INFO/MainProcess] Task create_task[4778b6c4-3528-4a91-964b-790a8d650060] received
[2024-05-16 16:23:50,257: INFO/ForkPoolWorker-1] Task download_YouTube_url[8e9b3a45-4ac6-4085-99c2-e39649a796b4] succeeded in 0.016886156001419295s: None
[2024-05-16 16:23:50,261: INFO/ForkPoolWorker-1] Task create_task[4778b6c4-3528-4a91-964b-790a8d650060] succeeded in 0.0008023320006032009s: False
[2024-05-16 16:26:46,178: INFO/MainProcess] Task download_YouTube_url[5b77854f-eb2c-4bcd-846e-6f8b1ccd7e91] received
[2024-05-16 16:26:46,185: WARNING/ForkPoolWorker-1] download YouTube url 123
[2024-05-16 16:26:46,193: WARNING/ForkPoolWorker-1]     error: regex_search: could not find match for (?:v=|\/)([0-9A-Za-z_-]{11}).*
[2024-05-16 16:26:46,204: INFO/ForkPoolWorker-1] Task download_YouTube_url[5b77854f-eb2c-4bcd-846e-6f8b1ccd7e91] succeeded in 0.01934173900008318s: None
[2024-05-16 16:26:46,204: INFO/MainProcess] Task create_task[d3cefb76-9973-48fe-8647-a6bfdff2be19] received
[2024-05-16 16:26:46,208: INFO/ForkPoolWorker-1] Task create_task[d3cefb76-9973-48fe-8647-a6bfdff2be19] succeeded in 0.000813114002085058s: False
[2024-05-16 16:33:02,957: INFO/MainProcess] Task download_stream_url[b3cb4d16-1bfb-4900-95a6-144d6fb69d34] received
[2024-05-16 16:33:02,963: WARNING/ForkPoolWorker-1] Recording video... https://live-wuxi.cgtn.com/live/wx_cgtn_1000k_internalnormal.m3u8
[2024-05-16 16:33:02,968: WARNING/ForkPoolWorker-1] load m3u8..
[2024-05-16 16:33:06,183: WARNING/ForkPoolWorker-1]  Recording fragment 1 segment 1...
[2024-05-16 16:33:08,379: WARNING/ForkPoolWorker-1]  Recording fragment 2 segment 2...
[2024-05-16 16:33:10,684: WARNING/ForkPoolWorker-1]  Recording fragment 3 segment 3...
[2024-05-16 16:33:13,143: WARNING/ForkPoolWorker-1]  Recording fragment 4 segment 4...
[2024-05-16 16:33:15,260: WARNING/ForkPoolWorker-1]  Recording fragment 5 segment 5...
[2024-05-16 16:33:17,357: WARNING/ForkPoolWorker-1]  Recording fragment 6 segment 6...
[2024-05-16 16:33:18,442: WARNING/ForkPoolWorker-1] sleep 18.0s
[2024-05-16 16:33:36,442: WARNING/ForkPoolWorker-1]     done: fragment_filename_list ['downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877147697-1.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877153772-2.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877159678-3.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877165677-4.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877171818-5.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877177700-6.ts']
[2024-05-16 16:33:36,447: INFO/MainProcess] Task create_task_list[4507ea50-5391-423b-aa6a-92068b50e136] received
[2024-05-16 16:33:36,447: INFO/ForkPoolWorker-1] Task download_stream_url[b3cb4d16-1bfb-4900-95a6-144d6fb69d34] succeeded in 33.485971868998604s: ['downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877147697-1.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877153772-2.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877159678-3.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877165677-4.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877171818-5.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877177700-6.ts']
[2024-05-16 16:33:36,452: INFO/MainProcess] Task create_task[c62acb4e-9ef4-490b-9ba2-9add6ab2929b] received
[2024-05-16 16:33:36,457: WARNING/ForkPoolWorker-3] create_taskdownloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877147697-1.ts
[2024-05-16 16:33:36,459: INFO/ForkPoolWorker-3] Task create_task[c62acb4e-9ef4-490b-9ba2-9add6ab2929b] succeeded in 0.002276396997331176s: True
[2024-05-16 16:33:36,460: INFO/MainProcess] Task create_task[f92dc2b4-916b-42da-a347-fbd909beaca1] received
[2024-05-16 16:33:36,465: INFO/MainProcess] Task create_task[d2578a5f-8868-4d98-b8a7-5755ff5c9080] received
[2024-05-16 16:33:36,466: WARNING/ForkPoolWorker-2] create_taskdownloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877159678-3.ts
[2024-05-16 16:33:36,466: WARNING/ForkPoolWorker-3] create_taskdownloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877153772-2.ts
[2024-05-16 16:33:36,468: WARNING/ForkPoolWorker-1] --- Logging error ---
[2024-05-16 16:33:36,468: INFO/ForkPoolWorker-3] Task create_task[f92dc2b4-916b-42da-a347-fbd909beaca1] succeeded in 0.002428411000437336s: True
[2024-05-16 16:33:36,467: INFO/ForkPoolWorker-2] Task create_task[d2578a5f-8868-4d98-b8a7-5755ff5c9080] succeeded in 0.0017112479981733486s: True
[2024-05-16 16:33:36,470: INFO/MainProcess] Task create_task[b7dcec2d-bdaa-4b7a-99b8-41fb098cf8e5] received
[2024-05-16 16:33:36,470: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 16:33:36,471: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:33:36,471: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:33:36,472: WARNING/ForkPoolWorker-3] create_taskdownloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877165677-4.ts
[2024-05-16 16:33:36,472: WARNING/ForkPoolWorker-1]   File "/usr/src/app/worker.py", line 188, in create_task_list
    result.ready()  # have all subtasks completed?
           ^^^^^^^^^^^^
[2024-05-16 16:33:36,473: INFO/ForkPoolWorker-3] Task create_task[b7dcec2d-bdaa-4b7a-99b8-41fb098cf8e5] succeeded in 0.0011324980005156249s: True
[2024-05-16 16:33:36,473: INFO/MainProcess] Task create_task[f7f725bc-2568-40c0-a619-d6c2c2e5a535] received
[2024-05-16 16:33:36,474: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 677, in get
    return (self.join_native if self.supports_native_join else self.join)(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:33:36,475: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 794, in join_native
    assert_will_not_block()
[2024-05-16 16:33:36,475: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 38, in assert_will_not_block
    raise RuntimeError(E_WOULDBLOCK)
[2024-05-16 16:33:36,475: WARNING/ForkPoolWorker-1] RuntimeError: Never call result.get() within a task!
See http://docs.celeryq.org/en/latest/userguide/tasks.html#task-synchronous-subtasks
[2024-05-16 16:33:36,476: WARNING/ForkPoolWorker-1] 
During handling of the above exception, another exception occurred:
[2024-05-16 16:33:36,476: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 16:33:36,476: INFO/MainProcess] Task create_task[483546a0-6793-4014-ae95-cad141385e23] received
[2024-05-16 16:33:36,477: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:33:36,477: WARNING/ForkPoolWorker-3] create_taskdownloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877171818-5.ts
[2024-05-16 16:33:36,477: WARNING/ForkPoolWorker-2] create_taskdownloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877177700-6.ts
[2024-05-16 16:33:36,480: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2024-05-16 16:33:36,481: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:33:36,482: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:33:36,482: INFO/ForkPoolWorker-3] Task create_task[f7f725bc-2568-40c0-a619-d6c2c2e5a535] succeeded in 0.00440098100079922s: True
[2024-05-16 16:33:36,482: INFO/ForkPoolWorker-2] Task create_task[483546a0-6793-4014-ae95-cad141385e23] succeeded in 0.004306073002226185s: True
[2024-05-16 16:33:36,482: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:33:36,482: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2024-05-16 16:33:36,483: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:33:36,483: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:33:36,484: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2024-05-16 16:33:36,484: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:33:36,484: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2024-05-16 16:33:36,485: WARNING/ForkPoolWorker-1] AttributeError: '_Code' object has no attribute 'co_positions'
[2024-05-16 16:33:36,485: WARNING/ForkPoolWorker-1] Call stack:
[2024-05-16 16:33:36,486: WARNING/ForkPoolWorker-1]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2024-05-16 16:33:36,486: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2024-05-16 16:33:36,486: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2024-05-16 16:33:36,487: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2024-05-16 16:33:36,487: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2024-05-16 16:33:36,487: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2024-05-16 16:33:36,488: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2024-05-16 16:33:36,488: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2024-05-16 16:33:36,488: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2024-05-16 16:33:36,489: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2024-05-16 16:33:36,489: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2024-05-16 16:33:36,489: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2024-05-16 16:33:36,490: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2024-05-16 16:33:36,490: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2024-05-16 16:33:36,491: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2024-05-16 16:33:36,491: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2024-05-16 16:33:36,491: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2024-05-16 16:33:36,492: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2024-05-16 16:33:36,492: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2024-05-16 16:33:36,492: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2024-05-16 16:33:36,493: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2024-05-16 16:33:36,493: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2024-05-16 16:33:36,493: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2024-05-16 16:33:36,494: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2024-05-16 16:33:36,494: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2024-05-16 16:33:36,496: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2024-05-16 16:33:36,496: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2024-05-16 16:33:36,496: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2024-05-16 16:33:36,497: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2024-05-16 16:33:36,497: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2024-05-16 16:33:36,497: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2024-05-16 16:33:36,498: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2024-05-16 16:33:36,498: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2024-05-16 16:33:36,498: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2024-05-16 16:33:36,499: WARNING/ForkPoolWorker-1] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@247be4a9565c', 'id': '4507ea50-5391-423b-aa6a-92068b50e136', 'name': 'create_task_list', 'exc': "RuntimeError('Never call result.get() within a task!\\nSee http://docs.celeryq.org/en/latest/userguide/tasks.html#task-synchronous-subtasks\\n')", 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 188, in create_task_list\n    result.ready()  # have all subtasks completed?\n           ^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 677, in get\n    return (self.join_native if self.supports_native_join else self.join)(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 794, in join_native\n    assert_will_not_block()\n  File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 38, in assert_will_not_block\n    raise RuntimeError(E_WOULDBLOCK)\nRuntimeError: Never call result.get() within a task!\nSee http://docs.celeryq.org/en/latest/userguide/tasks.html#task-synchronous-subtasks\n\n', 'args': "[['downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877147697-1.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877153772-2.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877159678-3.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877165677-4.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877171818-5.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877177700-6.ts']]", 'kwargs': '{}', 'description': 'raised unexpected', 'internal': False}
[2024-05-16 16:33:59,994: INFO/MainProcess] Connected to redis://redis:6379/0
[2024-05-16 16:33:59,999: INFO/MainProcess] mingle: searching for neighbors
[2024-05-16 16:34:01,011: INFO/MainProcess] mingle: all alone
[2024-05-16 16:34:01,026: INFO/MainProcess] celery@247be4a9565c ready.
[2024-05-16 16:34:21,575: INFO/MainProcess] Connected to redis://redis:6379/0
[2024-05-16 16:34:21,579: INFO/MainProcess] mingle: searching for neighbors
[2024-05-16 16:34:22,606: INFO/MainProcess] mingle: all alone
[2024-05-16 16:34:22,620: INFO/MainProcess] celery@d821745244bc ready.
[2024-05-16 16:34:27,002: INFO/MainProcess] Events of group {task} enabled by remote.
[2024-05-16 16:39:24,815: INFO/MainProcess] Task download_stream_url[8197ef5e-7cba-4a35-8524-f54257b5d0ce] received
[2024-05-16 16:39:24,819: WARNING/ForkPoolWorker-1] Recording video... recording_duration=1/max_fragment_duration=1 from https://live-wuxi.cgtn.com/live/wx_cgtn_1000k_internalnormal.m3u8
[2024-05-16 16:39:24,834: INFO/MainProcess] Task create_task_list[af7cae35-3643-420c-b1c5-056b32b60852] received
[2024-05-16 16:39:24,855: INFO/ForkPoolWorker-1] Task download_stream_url[8197ef5e-7cba-4a35-8524-f54257b5d0ce] succeeded in 0.03598058599891374s: ['test_video']
[2024-05-16 16:39:24,867: INFO/MainProcess] Task create_task[a6b5a766-48d0-467b-94b1-6ed32ed03190] received
[2024-05-16 16:39:24,870: WARNING/ForkPoolWorker-1] create_tasktest_video
[2024-05-16 16:39:24,872: INFO/ForkPoolWorker-1] Task create_task[a6b5a766-48d0-467b-94b1-6ed32ed03190] succeeded in 0.001864365996880224s: True
[2024-05-16 16:39:24,873: WARNING/ForkPoolWorker-3] --- Logging error ---
[2024-05-16 16:39:24,879: WARNING/ForkPoolWorker-3] Traceback (most recent call last):
[2024-05-16 16:39:24,880: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:39:24,880: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:39:24,880: WARNING/ForkPoolWorker-3]   File "/usr/src/app/worker.py", line 189, in create_task_list
    return result.get()
           ^^^^^^^^^^^^
[2024-05-16 16:39:24,881: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 677, in get
    return (self.join_native if self.supports_native_join else self.join)(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:39:24,881: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 794, in join_native
    assert_will_not_block()
[2024-05-16 16:39:24,882: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 38, in assert_will_not_block
    raise RuntimeError(E_WOULDBLOCK)
[2024-05-16 16:39:24,882: WARNING/ForkPoolWorker-3] RuntimeError: Never call result.get() within a task!
See http://docs.celeryq.org/en/latest/userguide/tasks.html#task-synchronous-subtasks
[2024-05-16 16:39:24,883: WARNING/ForkPoolWorker-3] 
During handling of the above exception, another exception occurred:
[2024-05-16 16:39:24,884: WARNING/ForkPoolWorker-3] Traceback (most recent call last):
[2024-05-16 16:39:24,885: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:39:24,885: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2024-05-16 16:39:24,886: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:39:24,886: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:39:24,886: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:39:24,890: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2024-05-16 16:39:24,894: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:39:24,894: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:39:24,895: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2024-05-16 16:39:24,895: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:39:24,896: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2024-05-16 16:39:24,896: WARNING/ForkPoolWorker-3] AttributeError: '_Code' object has no attribute 'co_positions'
[2024-05-16 16:39:24,897: WARNING/ForkPoolWorker-3] Call stack:
[2024-05-16 16:39:24,900: WARNING/ForkPoolWorker-3]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2024-05-16 16:39:24,900: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2024-05-16 16:39:24,901: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2024-05-16 16:39:24,901: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2024-05-16 16:39:24,902: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2024-05-16 16:39:24,902: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2024-05-16 16:39:24,902: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2024-05-16 16:39:24,903: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2024-05-16 16:39:24,903: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2024-05-16 16:39:24,903: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2024-05-16 16:39:24,904: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2024-05-16 16:39:24,904: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2024-05-16 16:39:24,904: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2024-05-16 16:39:24,905: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2024-05-16 16:39:24,905: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2024-05-16 16:39:24,905: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2024-05-16 16:39:24,906: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2024-05-16 16:39:24,906: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2024-05-16 16:39:24,906: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2024-05-16 16:39:24,909: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2024-05-16 16:39:24,910: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2024-05-16 16:39:24,910: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2024-05-16 16:39:24,911: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2024-05-16 16:39:24,911: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2024-05-16 16:39:24,911: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2024-05-16 16:39:24,912: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2024-05-16 16:39:24,912: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2024-05-16 16:39:24,912: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2024-05-16 16:39:24,913: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2024-05-16 16:39:24,913: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2024-05-16 16:39:24,913: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2024-05-16 16:39:24,914: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2024-05-16 16:39:24,914: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2024-05-16 16:39:24,914: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2024-05-16 16:39:24,915: WARNING/ForkPoolWorker-3] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@d821745244bc', 'id': 'af7cae35-3643-420c-b1c5-056b32b60852', 'name': 'create_task_list', 'exc': "RuntimeError('Never call result.get() within a task!\\nSee http://docs.celeryq.org/en/latest/userguide/tasks.html#task-synchronous-subtasks\\n')", 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 189, in create_task_list\n    return result.get()\n           ^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 677, in get\n    return (self.join_native if self.supports_native_join else self.join)(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 794, in join_native\n    assert_will_not_block()\n  File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 38, in assert_will_not_block\n    raise RuntimeError(E_WOULDBLOCK)\nRuntimeError: Never call result.get() within a task!\nSee http://docs.celeryq.org/en/latest/userguide/tasks.html#task-synchronous-subtasks\n\n', 'args': "[['test_video']]", 'kwargs': '{}', 'description': 'raised unexpected', 'internal': False}
[2024-05-16 16:39:53,346: INFO/MainProcess] Task download_stream_url[f7d48b64-21d1-4b96-89cb-a692e5fbeeb9] received
[2024-05-16 16:39:53,359: WARNING/ForkPoolWorker-1] Recording video... recording_duration=1/max_fragment_duration=1 from https://live-wuxi.cgtn.com/live/wx_cgtn_1000k_internalnormal.m3u8
[2024-05-16 16:39:53,365: INFO/ForkPoolWorker-1] Task download_stream_url[f7d48b64-21d1-4b96-89cb-a692e5fbeeb9] succeeded in 0.006228104000911117s: ['test_video']
[2024-05-16 16:39:53,365: INFO/MainProcess] Task create_task_list[761ad309-d1a9-4190-a143-cb3ff9f5d8b2] received
[2024-05-16 16:39:53,372: INFO/MainProcess] Task create_task[5bddc03d-3ed3-4fd4-82b4-a35298a097c2] received
[2024-05-16 16:39:53,375: WARNING/ForkPoolWorker-3] create_tasktest_video
[2024-05-16 16:39:53,380: INFO/ForkPoolWorker-3] Task create_task[5bddc03d-3ed3-4fd4-82b4-a35298a097c2] succeeded in 0.004943862000800436s: True
[2024-05-16 16:39:53,387: WARNING/ForkPoolWorker-1] --- Logging error ---
[2024-05-16 16:39:53,389: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 16:39:53,389: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:39:53,390: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:39:53,393: WARNING/ForkPoolWorker-1]   File "/usr/src/app/worker.py", line 189, in create_task_list
    result.ready()  # have all subtasks completed?
           ^^^^^^^^^^^^
[2024-05-16 16:39:53,393: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 677, in get
    return (self.join_native if self.supports_native_join else self.join)(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:39:53,394: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 794, in join_native
    assert_will_not_block()
[2024-05-16 16:39:53,394: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 38, in assert_will_not_block
    raise RuntimeError(E_WOULDBLOCK)
[2024-05-16 16:39:53,394: WARNING/ForkPoolWorker-1] RuntimeError: Never call result.get() within a task!
See http://docs.celeryq.org/en/latest/userguide/tasks.html#task-synchronous-subtasks
[2024-05-16 16:39:53,394: WARNING/ForkPoolWorker-1] 
During handling of the above exception, another exception occurred:
[2024-05-16 16:39:53,395: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 16:39:53,395: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:39:53,396: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2024-05-16 16:39:53,396: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:39:53,396: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:39:53,397: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:39:53,397: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2024-05-16 16:39:53,400: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:39:53,400: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:39:53,400: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2024-05-16 16:39:53,401: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:39:53,401: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2024-05-16 16:39:53,401: WARNING/ForkPoolWorker-1] AttributeError: '_Code' object has no attribute 'co_positions'
[2024-05-16 16:39:53,402: WARNING/ForkPoolWorker-1] Call stack:
[2024-05-16 16:39:53,405: WARNING/ForkPoolWorker-1]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2024-05-16 16:39:53,405: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2024-05-16 16:39:53,406: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2024-05-16 16:39:53,406: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2024-05-16 16:39:53,406: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2024-05-16 16:39:53,407: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2024-05-16 16:39:53,407: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2024-05-16 16:39:53,407: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2024-05-16 16:39:53,407: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2024-05-16 16:39:53,408: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2024-05-16 16:39:53,408: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2024-05-16 16:39:53,408: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2024-05-16 16:39:53,408: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2024-05-16 16:39:53,409: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2024-05-16 16:39:53,409: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2024-05-16 16:39:53,409: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2024-05-16 16:39:53,410: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2024-05-16 16:39:53,410: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2024-05-16 16:39:53,410: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2024-05-16 16:39:53,410: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2024-05-16 16:39:53,411: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2024-05-16 16:39:53,411: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2024-05-16 16:39:53,411: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2024-05-16 16:39:53,412: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2024-05-16 16:39:53,412: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2024-05-16 16:39:53,412: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2024-05-16 16:39:53,412: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2024-05-16 16:39:53,413: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2024-05-16 16:39:53,413: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2024-05-16 16:39:53,413: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2024-05-16 16:39:53,414: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2024-05-16 16:39:53,415: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2024-05-16 16:39:53,415: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2024-05-16 16:39:53,416: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2024-05-16 16:39:53,416: WARNING/ForkPoolWorker-1] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@d821745244bc', 'id': '761ad309-d1a9-4190-a143-cb3ff9f5d8b2', 'name': 'create_task_list', 'exc': "RuntimeError('Never call result.get() within a task!\\nSee http://docs.celeryq.org/en/latest/userguide/tasks.html#task-synchronous-subtasks\\n')", 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 189, in create_task_list\n    result.ready()  # have all subtasks completed?\n           ^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 677, in get\n    return (self.join_native if self.supports_native_join else self.join)(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 794, in join_native\n    assert_will_not_block()\n  File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 38, in assert_will_not_block\n    raise RuntimeError(E_WOULDBLOCK)\nRuntimeError: Never call result.get() within a task!\nSee http://docs.celeryq.org/en/latest/userguide/tasks.html#task-synchronous-subtasks\n\n', 'args': "[['test_video']]", 'kwargs': '{}', 'description': 'raised unexpected', 'internal': False}
[2024-05-16 16:40:11,920: INFO/MainProcess] Connected to redis://redis:6379/0
[2024-05-16 16:40:11,925: INFO/MainProcess] mingle: searching for neighbors
[2024-05-16 16:40:12,936: INFO/MainProcess] mingle: all alone
[2024-05-16 16:40:12,948: INFO/MainProcess] celery@d821745244bc ready.
[2024-05-16 16:40:17,099: INFO/MainProcess] Events of group {task} enabled by remote.
[2024-05-16 16:40:31,062: INFO/MainProcess] Task download_stream_url[646a3ea5-6543-441d-89c4-976382aee9d6] received
[2024-05-16 16:40:31,065: WARNING/ForkPoolWorker-1] Recording video... recording_duration=1/max_fragment_duration=1 from https://live-wuxi.cgtn.com/live/wx_cgtn_1000k_internalnormal.m3u8
[2024-05-16 16:40:31,087: INFO/MainProcess] Task create_task_list[92f24356-b95a-4e84-82ac-1bfe9bbf3bde] received
[2024-05-16 16:40:31,092: INFO/ForkPoolWorker-1] Task download_stream_url[646a3ea5-6543-441d-89c4-976382aee9d6] succeeded in 0.02773274399805814s: ['Recording video... recording_duration=1/max_fragment_duration=1 from https://live-wuxi.cgtn.com/live/wx_cgtn_1000k_internalnormal.m3u8test_video']
[2024-05-16 16:40:31,134: INFO/MainProcess] Task create_task[996e6db0-adcd-41b5-be46-0a2fda820b5b] received
[2024-05-16 16:40:31,136: WARNING/ForkPoolWorker-1] create_taskRecording video... recording_duration=1/max_fragment_duration=1 from https://live-wuxi.cgtn.com/live/wx_cgtn_1000k_internalnormal.m3u8test_video
[2024-05-16 16:40:31,137: INFO/ForkPoolWorker-1] Task create_task[996e6db0-adcd-41b5-be46-0a2fda820b5b] succeeded in 0.001229845998750534s: True
[2024-05-16 16:40:31,151: WARNING/ForkPoolWorker-3] --- Logging error ---
[2024-05-16 16:40:31,154: WARNING/ForkPoolWorker-3] Traceback (most recent call last):
[2024-05-16 16:40:31,157: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:40:31,158: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:40:31,158: WARNING/ForkPoolWorker-3]   File "/usr/src/app/worker.py", line 190, in create_task_list
    return result.get()
           ^^^^^^^^^^^^
[2024-05-16 16:40:31,159: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 677, in get
    return (self.join_native if self.supports_native_join else self.join)(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:40:31,159: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 794, in join_native
    assert_will_not_block()
[2024-05-16 16:40:31,160: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 38, in assert_will_not_block
    raise RuntimeError(E_WOULDBLOCK)
[2024-05-16 16:40:31,161: WARNING/ForkPoolWorker-3] RuntimeError: Never call result.get() within a task!
See http://docs.celeryq.org/en/latest/userguide/tasks.html#task-synchronous-subtasks
[2024-05-16 16:40:31,161: WARNING/ForkPoolWorker-3] 
During handling of the above exception, another exception occurred:
[2024-05-16 16:40:31,162: WARNING/ForkPoolWorker-3] Traceback (most recent call last):
[2024-05-16 16:40:31,162: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:40:31,163: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2024-05-16 16:40:31,165: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:40:31,165: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:40:31,166: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:40:31,166: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2024-05-16 16:40:31,167: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:40:31,167: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:40:31,168: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2024-05-16 16:40:31,168: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:40:31,168: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2024-05-16 16:40:31,169: WARNING/ForkPoolWorker-3] AttributeError: '_Code' object has no attribute 'co_positions'
[2024-05-16 16:40:31,169: WARNING/ForkPoolWorker-3] Call stack:
[2024-05-16 16:40:31,172: WARNING/ForkPoolWorker-3]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2024-05-16 16:40:31,173: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2024-05-16 16:40:31,173: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2024-05-16 16:40:31,173: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2024-05-16 16:40:31,174: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2024-05-16 16:40:31,174: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2024-05-16 16:40:31,176: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2024-05-16 16:40:31,177: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2024-05-16 16:40:31,178: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2024-05-16 16:40:31,178: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2024-05-16 16:40:31,179: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2024-05-16 16:40:31,180: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2024-05-16 16:40:31,182: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2024-05-16 16:40:31,182: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2024-05-16 16:40:31,182: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2024-05-16 16:40:31,183: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2024-05-16 16:40:31,183: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2024-05-16 16:40:31,184: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2024-05-16 16:40:31,184: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2024-05-16 16:40:31,184: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2024-05-16 16:40:31,185: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2024-05-16 16:40:31,185: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2024-05-16 16:40:31,185: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2024-05-16 16:40:31,185: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2024-05-16 16:40:31,186: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2024-05-16 16:40:31,186: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2024-05-16 16:40:31,187: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2024-05-16 16:40:31,187: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2024-05-16 16:40:31,187: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2024-05-16 16:40:31,188: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2024-05-16 16:40:31,188: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2024-05-16 16:40:31,188: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2024-05-16 16:40:31,189: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2024-05-16 16:40:31,189: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2024-05-16 16:40:31,190: WARNING/ForkPoolWorker-3] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@d821745244bc', 'id': '92f24356-b95a-4e84-82ac-1bfe9bbf3bde', 'name': 'create_task_list', 'exc': "RuntimeError('Never call result.get() within a task!\\nSee http://docs.celeryq.org/en/latest/userguide/tasks.html#task-synchronous-subtasks\\n')", 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 190, in create_task_list\n    return result.get()\n           ^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 677, in get\n    return (self.join_native if self.supports_native_join else self.join)(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 794, in join_native\n    assert_will_not_block()\n  File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 38, in assert_will_not_block\n    raise RuntimeError(E_WOULDBLOCK)\nRuntimeError: Never call result.get() within a task!\nSee http://docs.celeryq.org/en/latest/userguide/tasks.html#task-synchronous-subtasks\n\n', 'args': "[['Recording video... recording_duration=1/max_fragment_duration=1 from https://live-wuxi.cgtn.com/live/wx_cgtn_1000k_internalnormal.m3u8test_video']]", 'kwargs': '{}', 'description': 'raised unexpected', 'internal': False}
[2024-05-16 16:41:11,996: INFO/MainProcess] Task download_stream_url[78150027-7d7c-4ce3-a01d-4745e025a5a3] received
[2024-05-16 16:41:11,999: WARNING/ForkPoolWorker-1] Recording video... recording_duration=1/max_fragment_duration=1 from https://live-wuxi.cgtn.com/live/wx_cgtn_1000k_internalnormal.m3u8
[2024-05-16 16:41:12,008: INFO/MainProcess] Task create_task_list[984f72c4-bad6-47d4-9465-fc422808af09] received
[2024-05-16 16:41:12,008: INFO/ForkPoolWorker-1] Task download_stream_url[78150027-7d7c-4ce3-a01d-4745e025a5a3] succeeded in 0.009148638000624487s: ['Recording video... recording_duration=1/max_fragment_duration=1 from https://live-wuxi.cgtn.com/live/wx_cgtn_1000k_internalnormal.m3u8test_video']
[2024-05-16 16:41:12,022: INFO/MainProcess] Task create_task[7727596d-8071-4cf2-9897-65b951d8fe2e] received
[2024-05-16 16:41:12,026: WARNING/ForkPoolWorker-3] create_taskRecording video... recording_duration=1/max_fragment_duration=1 from https://live-wuxi.cgtn.com/live/wx_cgtn_1000k_internalnormal.m3u8test_video
[2024-05-16 16:41:12,027: WARNING/ForkPoolWorker-1] --- Logging error ---
[2024-05-16 16:41:12,032: INFO/ForkPoolWorker-3] Task create_task[7727596d-8071-4cf2-9897-65b951d8fe2e] succeeded in 0.0055709059997752775s: True
[2024-05-16 16:41:12,037: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 16:41:12,038: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:41:12,038: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:41:12,039: WARNING/ForkPoolWorker-1]   File "/usr/src/app/worker.py", line 190, in create_task_list
[2024-05-16 16:41:12,039: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 677, in get
    return (self.join_native if self.supports_native_join else self.join)(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:41:12,040: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 794, in join_native
    assert_will_not_block()
[2024-05-16 16:41:12,040: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 38, in assert_will_not_block
    raise RuntimeError(E_WOULDBLOCK)
[2024-05-16 16:41:12,040: WARNING/ForkPoolWorker-1] RuntimeError: Never call result.get() within a task!
See http://docs.celeryq.org/en/latest/userguide/tasks.html#task-synchronous-subtasks
[2024-05-16 16:41:12,041: WARNING/ForkPoolWorker-1] 
During handling of the above exception, another exception occurred:
[2024-05-16 16:41:12,041: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 16:41:12,042: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:41:12,044: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2024-05-16 16:41:12,044: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:41:12,045: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:41:12,045: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:41:12,045: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2024-05-16 16:41:12,046: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:41:12,046: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:41:12,048: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2024-05-16 16:41:12,048: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:41:12,050: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2024-05-16 16:41:12,051: WARNING/ForkPoolWorker-1] AttributeError: '_Code' object has no attribute 'co_positions'
[2024-05-16 16:41:12,051: WARNING/ForkPoolWorker-1] Call stack:
[2024-05-16 16:41:12,055: WARNING/ForkPoolWorker-1]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2024-05-16 16:41:12,055: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2024-05-16 16:41:12,056: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2024-05-16 16:41:12,056: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2024-05-16 16:41:12,057: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2024-05-16 16:41:12,057: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2024-05-16 16:41:12,058: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2024-05-16 16:41:12,058: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2024-05-16 16:41:12,058: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2024-05-16 16:41:12,059: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2024-05-16 16:41:12,059: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2024-05-16 16:41:12,060: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2024-05-16 16:41:12,060: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2024-05-16 16:41:12,060: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2024-05-16 16:41:12,061: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2024-05-16 16:41:12,061: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2024-05-16 16:41:12,061: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2024-05-16 16:41:12,062: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2024-05-16 16:41:12,062: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2024-05-16 16:41:12,062: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2024-05-16 16:41:12,063: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2024-05-16 16:41:12,063: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2024-05-16 16:41:12,064: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2024-05-16 16:41:12,064: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2024-05-16 16:41:12,064: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2024-05-16 16:41:12,065: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2024-05-16 16:41:12,066: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2024-05-16 16:41:12,068: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2024-05-16 16:41:12,069: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2024-05-16 16:41:12,070: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2024-05-16 16:41:12,070: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2024-05-16 16:41:12,070: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2024-05-16 16:41:12,071: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2024-05-16 16:41:12,071: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2024-05-16 16:41:12,072: WARNING/ForkPoolWorker-1] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@d821745244bc', 'id': '984f72c4-bad6-47d4-9465-fc422808af09', 'name': 'create_task_list', 'exc': "RuntimeError('Never call result.get() within a task!\\nSee http://docs.celeryq.org/en/latest/userguide/tasks.html#task-synchronous-subtasks\\n')", 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 190, in create_task_list\n  File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 677, in get\n    return (self.join_native if self.supports_native_join else self.join)(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 794, in join_native\n    assert_will_not_block()\n  File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 38, in assert_will_not_block\n    raise RuntimeError(E_WOULDBLOCK)\nRuntimeError: Never call result.get() within a task!\nSee http://docs.celeryq.org/en/latest/userguide/tasks.html#task-synchronous-subtasks\n\n', 'args': "[['Recording video... recording_duration=1/max_fragment_duration=1 from https://live-wuxi.cgtn.com/live/wx_cgtn_1000k_internalnormal.m3u8test_video']]", 'kwargs': '{}', 'description': 'raised unexpected', 'internal': False}
[2024-05-16 16:41:28,984: INFO/MainProcess] Connected to redis://redis:6379/0
[2024-05-16 16:41:28,988: INFO/MainProcess] mingle: searching for neighbors
[2024-05-16 16:41:30,003: INFO/MainProcess] mingle: all alone
[2024-05-16 16:41:30,039: INFO/MainProcess] celery@d821745244bc ready.
[2024-05-16 16:41:34,025: INFO/MainProcess] Task download_stream_url[03bb2942-c10f-4eff-8e49-fa2e49e8634d] received
[2024-05-16 16:41:34,027: WARNING/ForkPoolWorker-1] Recording video... 1/1 from https://live-wuxi.cgtn.com/live/wx_cgtn_1000k_internalnormal.m3u8
[2024-05-16 16:41:34,029: WARNING/ForkPoolWorker-1] load m3u8..
[2024-05-16 16:41:34,094: INFO/MainProcess] Events of group {task} enabled by remote.
[2024-05-16 16:41:37,385: WARNING/ForkPoolWorker-1]  Recording fragment 1 segment 1...
[2024-05-16 16:41:39,581: WARNING/ForkPoolWorker-1]  Recording fragment 2 segment 2...
[2024-05-16 16:41:41,719: WARNING/ForkPoolWorker-1]  Recording fragment 3 segment 3...
[2024-05-16 16:41:44,022: WARNING/ForkPoolWorker-1]  Recording fragment 4 segment 4...
[2024-05-16 16:41:46,162: WARNING/ForkPoolWorker-1]  Recording fragment 5 segment 5...
[2024-05-16 16:41:48,407: WARNING/ForkPoolWorker-1]  Recording fragment 6 segment 6...
[2024-05-16 16:41:49,433: WARNING/ForkPoolWorker-1] sleep 18.0s
[2024-05-16 16:42:07,433: WARNING/ForkPoolWorker-1]     done: fragment_filename_list ['downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877657864-1.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877663847-2.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877669808-3.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877675841-4.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877681873-5.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877687793-6.ts']
[2024-05-16 16:42:07,447: INFO/MainProcess] Task create_task_list[59009eb3-462d-42b5-9626-df737958647e] received
[2024-05-16 16:42:07,448: INFO/ForkPoolWorker-1] Task download_stream_url[03bb2942-c10f-4eff-8e49-fa2e49e8634d] succeeded in 33.42256212199936s: ['downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877657864-1.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877663847-2.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877669808-3.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877675841-4.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877681873-5.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877687793-6.ts']
[2024-05-16 16:42:07,459: INFO/MainProcess] Task create_task[dc4e936d-4ff7-461f-8142-1e0ffb7a8928] received
[2024-05-16 16:42:07,462: INFO/MainProcess] Task create_task[97994230-150e-4927-8935-4121b12d29a3] received
[2024-05-16 16:42:07,464: WARNING/ForkPoolWorker-1] create_taskdownloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877657864-1.ts
[2024-05-16 16:42:07,465: INFO/MainProcess] Task create_task[c2d20075-7ff2-469a-a6a7-e36838605dd9] received
[2024-05-16 16:42:07,465: WARNING/ForkPoolWorker-2] create_taskdownloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877663847-2.ts
[2024-05-16 16:42:07,467: INFO/ForkPoolWorker-1] Task create_task[dc4e936d-4ff7-461f-8142-1e0ffb7a8928] succeeded in 0.003176712001732085s: True
[2024-05-16 16:42:07,469: INFO/MainProcess] Task create_task[d980b99b-554f-4482-a5a9-cca51c7d893f] received
[2024-05-16 16:42:07,470: WARNING/ForkPoolWorker-1] create_taskdownloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877669808-3.ts
[2024-05-16 16:42:07,471: WARNING/ForkPoolWorker-4] create_taskdownloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877675841-4.ts
[2024-05-16 16:42:07,472: INFO/ForkPoolWorker-1] Task create_task[c2d20075-7ff2-469a-a6a7-e36838605dd9] succeeded in 0.0019267679999757092s: True
[2024-05-16 16:42:07,475: WARNING/ForkPoolWorker-3] --- Logging error ---
[2024-05-16 16:42:07,475: INFO/MainProcess] Task create_task[2690a5ef-a768-4aa8-888c-4fb996f73c95] received
[2024-05-16 16:42:07,477: INFO/ForkPoolWorker-2] Task create_task[97994230-150e-4927-8935-4121b12d29a3] succeeded in 0.01210822600114625s: True
[2024-05-16 16:42:07,478: INFO/MainProcess] Task create_task[3ba5ab90-d80b-4a7f-bc64-7adc6c449ac2] received
[2024-05-16 16:42:07,479: WARNING/ForkPoolWorker-3] Traceback (most recent call last):
[2024-05-16 16:42:07,480: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:42:07,481: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:42:07,477: WARNING/ForkPoolWorker-1] create_taskdownloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877681873-5.ts
[2024-05-16 16:42:07,481: WARNING/ForkPoolWorker-3]   File "/usr/src/app/worker.py", line 186, in create_task_list
    return result.get()
           ^^^^^^^^^^^^
[2024-05-16 16:42:07,482: INFO/ForkPoolWorker-4] Task create_task[d980b99b-554f-4482-a5a9-cca51c7d893f] succeeded in 0.011557806999917375s: True
[2024-05-16 16:42:07,483: WARNING/ForkPoolWorker-2] create_taskdownloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877687793-6.ts
[2024-05-16 16:42:07,483: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 677, in get
    return (self.join_native if self.supports_native_join else self.join)(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:42:07,484: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 794, in join_native
    assert_will_not_block()
[2024-05-16 16:42:07,484: INFO/ForkPoolWorker-1] Task create_task[2690a5ef-a768-4aa8-888c-4fb996f73c95] succeeded in 0.006682834999082843s: True
[2024-05-16 16:42:07,484: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 38, in assert_will_not_block
    raise RuntimeError(E_WOULDBLOCK)
[2024-05-16 16:42:07,484: INFO/ForkPoolWorker-2] Task create_task[3ba5ab90-d80b-4a7f-bc64-7adc6c449ac2] succeeded in 0.0015873560005275067s: True
[2024-05-16 16:42:07,485: WARNING/ForkPoolWorker-3] RuntimeError: Never call result.get() within a task!
See http://docs.celeryq.org/en/latest/userguide/tasks.html#task-synchronous-subtasks
[2024-05-16 16:42:07,485: WARNING/ForkPoolWorker-3] 
During handling of the above exception, another exception occurred:
[2024-05-16 16:42:07,486: WARNING/ForkPoolWorker-3] Traceback (most recent call last):
[2024-05-16 16:42:07,487: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:42:07,487: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2024-05-16 16:42:07,488: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:42:07,489: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:42:07,489: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:42:07,490: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2024-05-16 16:42:07,490: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:42:07,491: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:42:07,491: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2024-05-16 16:42:07,492: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:42:07,493: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2024-05-16 16:42:07,493: WARNING/ForkPoolWorker-3] AttributeError: '_Code' object has no attribute 'co_positions'
[2024-05-16 16:42:07,493: WARNING/ForkPoolWorker-3] Call stack:
[2024-05-16 16:42:07,498: WARNING/ForkPoolWorker-3]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2024-05-16 16:42:07,498: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2024-05-16 16:42:07,499: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2024-05-16 16:42:07,499: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2024-05-16 16:42:07,500: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2024-05-16 16:42:07,500: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2024-05-16 16:42:07,501: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2024-05-16 16:42:07,501: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2024-05-16 16:42:07,502: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2024-05-16 16:42:07,502: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2024-05-16 16:42:07,503: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2024-05-16 16:42:07,503: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2024-05-16 16:42:07,503: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2024-05-16 16:42:07,504: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2024-05-16 16:42:07,504: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2024-05-16 16:42:07,505: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2024-05-16 16:42:07,505: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2024-05-16 16:42:07,506: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2024-05-16 16:42:07,506: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2024-05-16 16:42:07,507: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2024-05-16 16:42:07,507: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2024-05-16 16:42:07,507: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2024-05-16 16:42:07,508: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2024-05-16 16:42:07,508: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2024-05-16 16:42:07,509: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2024-05-16 16:42:07,509: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2024-05-16 16:42:07,510: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2024-05-16 16:42:07,510: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2024-05-16 16:42:07,511: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2024-05-16 16:42:07,511: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2024-05-16 16:42:07,511: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2024-05-16 16:42:07,512: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2024-05-16 16:42:07,512: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2024-05-16 16:42:07,513: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2024-05-16 16:42:07,513: WARNING/ForkPoolWorker-3] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@d821745244bc', 'id': '59009eb3-462d-42b5-9626-df737958647e', 'name': 'create_task_list', 'exc': "RuntimeError('Never call result.get() within a task!\\nSee http://docs.celeryq.org/en/latest/userguide/tasks.html#task-synchronous-subtasks\\n')", 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 186, in create_task_list\n    return result.get()\n           ^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 677, in get\n    return (self.join_native if self.supports_native_join else self.join)(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 794, in join_native\n    assert_will_not_block()\n  File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 38, in assert_will_not_block\n    raise RuntimeError(E_WOULDBLOCK)\nRuntimeError: Never call result.get() within a task!\nSee http://docs.celeryq.org/en/latest/userguide/tasks.html#task-synchronous-subtasks\n\n', 'args': "[['downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877657864-1.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877663847-2.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877669808-3.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877675841-4.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877681873-5.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877687793-6.ts']]", 'kwargs': '{}', 'description': 'raised unexpected', 'internal': False}
[2024-05-16 16:53:20,070: INFO/MainProcess] Task download_stream_url[a94687a3-e39e-4603-8947-f6de9481edef] received
[2024-05-16 16:53:20,074: WARNING/ForkPoolWorker-1] Recording video... 1/1 from https://live-wuxi.cgtn.com/live/wx_cgtn_1000k_internalnormal.m3u8
[2024-05-16 16:53:20,077: WARNING/ForkPoolWorker-1] load m3u8..
[2024-05-16 16:53:23,166: WARNING/ForkPoolWorker-1]  Recording fragment 1 segment 1...
[2024-05-16 16:53:24,937: WARNING/ForkPoolWorker-1]  Recording fragment 2 segment 2...
[2024-05-16 16:53:26,662: WARNING/ForkPoolWorker-1]  Recording fragment 3 segment 3...
[2024-05-16 16:53:28,439: WARNING/ForkPoolWorker-1]  Recording fragment 4 segment 4...
[2024-05-16 16:53:30,256: WARNING/ForkPoolWorker-1]  Recording fragment 5 segment 5...
[2024-05-16 16:53:32,529: WARNING/ForkPoolWorker-1]  Recording fragment 6 segment 6...
[2024-05-16 16:53:33,420: WARNING/ForkPoolWorker-1] sleep 18.0s
[2024-05-16 16:53:51,420: WARNING/ForkPoolWorker-1]     done: fragment_filename_list ['downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715878365845-1.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715878371837-2.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715878377807-3.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715878383782-4.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715878389833-5.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715878395733-6.ts']
[2024-05-16 16:53:51,424: INFO/ForkPoolWorker-1] Task download_stream_url[a94687a3-e39e-4603-8947-f6de9481edef] succeeded in 31.35089183799937s: ['downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715878365845-1.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715878371837-2.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715878377807-3.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715878383782-4.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715878389833-5.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715878395733-6.ts']
[2024-05-16 16:54:39,104: INFO/MainProcess] Connected to redis://redis:6379/0
[2024-05-16 16:54:39,108: INFO/MainProcess] mingle: searching for neighbors
[2024-05-16 16:54:40,119: INFO/MainProcess] mingle: all alone
[2024-05-16 16:54:40,156: INFO/MainProcess] celery@d821745244bc ready.
[2024-05-16 16:54:40,162: INFO/MainProcess] Task create_task_list[be3ff31f-b734-47ac-be96-37f57a918ad9] received
[2024-05-16 16:54:40,182: INFO/MainProcess] Task create_task[9c4dffde-94bd-455d-a14f-8b433fd8fdcd] received
[2024-05-16 16:54:40,184: WARNING/ForkPoolWorker-3] create_taskdownloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715878365845-1.ts
[2024-05-16 16:54:40,185: INFO/MainProcess] Task create_task[70891cec-f9f0-4004-aafe-1dec7ddc5722] received
[2024-05-16 16:54:40,186: INFO/MainProcess] Task create_task[46c95464-c510-4314-8911-5bf7b06c3b5a] received
[2024-05-16 16:54:40,188: INFO/ForkPoolWorker-3] Task create_task[9c4dffde-94bd-455d-a14f-8b433fd8fdcd] succeeded in 0.004387180997582618s: True
[2024-05-16 16:54:40,189: WARNING/ForkPoolWorker-2] create_taskdownloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715878371837-2.ts
[2024-05-16 16:54:40,189: WARNING/ForkPoolWorker-4] create_taskdownloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715878377807-3.ts
[2024-05-16 16:54:40,194: INFO/ForkPoolWorker-2] Task create_task[70891cec-f9f0-4004-aafe-1dec7ddc5722] succeeded in 0.0044768849984393455s: True
[2024-05-16 16:54:40,195: INFO/MainProcess] Task create_task[0728c33d-11d9-477f-b856-8f849ff09d0d] received
[2024-05-16 16:54:40,196: INFO/ForkPoolWorker-4] Task create_task[46c95464-c510-4314-8911-5bf7b06c3b5a] succeeded in 0.00619555600133026s: True
[2024-05-16 16:54:40,197: WARNING/ForkPoolWorker-1] --- Logging error ---
[2024-05-16 16:54:40,197: INFO/MainProcess] Task create_task[5a6d125b-736d-43a3-8780-0caeac28f1a8] received
[2024-05-16 16:54:40,198: WARNING/ForkPoolWorker-3] create_taskdownloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715878383782-4.ts
[2024-05-16 16:54:40,199: WARNING/ForkPoolWorker-2] create_taskdownloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715878389833-5.ts
[2024-05-16 16:54:40,200: INFO/ForkPoolWorker-3] Task create_task[0728c33d-11d9-477f-b856-8f849ff09d0d] succeeded in 0.0014110580013948493s: True
[2024-05-16 16:54:40,200: INFO/MainProcess] Task create_task[18fab19d-114e-4640-81ea-d3a9ff6dc2fc] received
[2024-05-16 16:54:40,200: INFO/ForkPoolWorker-2] Task create_task[5a6d125b-736d-43a3-8780-0caeac28f1a8] succeeded in 0.0014038579975022003s: True
[2024-05-16 16:54:40,200: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 16:54:40,202: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:54:40,202: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:54:40,203: WARNING/ForkPoolWorker-1]   File "/usr/src/app/worker.py", line 190, in create_task_list
    return result.get()
           ^^^^^^^^^^^^
[2024-05-16 16:54:40,203: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 677, in get
    return (self.join_native if self.supports_native_join else self.join)(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:54:40,203: WARNING/ForkPoolWorker-3] create_taskdownloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715878395733-6.ts
[2024-05-16 16:54:40,204: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 794, in join_native
    assert_will_not_block()
[2024-05-16 16:54:40,204: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 38, in assert_will_not_block
    raise RuntimeError(E_WOULDBLOCK)
[2024-05-16 16:54:40,205: WARNING/ForkPoolWorker-1] RuntimeError: Never call result.get() within a task!
See http://docs.celeryq.org/en/latest/userguide/tasks.html#task-synchronous-subtasks
[2024-05-16 16:54:40,205: WARNING/ForkPoolWorker-1] 
During handling of the above exception, another exception occurred:
[2024-05-16 16:54:40,205: INFO/ForkPoolWorker-3] Task create_task[18fab19d-114e-4640-81ea-d3a9ff6dc2fc] succeeded in 0.0018256760013173334s: True
[2024-05-16 16:54:40,205: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 16:54:40,206: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:54:40,207: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2024-05-16 16:54:40,207: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:54:40,208: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:54:40,208: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:54:40,209: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2024-05-16 16:54:40,209: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:54:40,210: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:54:40,210: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2024-05-16 16:54:40,211: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:54:40,212: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2024-05-16 16:54:40,212: WARNING/ForkPoolWorker-1] AttributeError: '_Code' object has no attribute 'co_positions'
[2024-05-16 16:54:40,213: WARNING/ForkPoolWorker-1] Call stack:
[2024-05-16 16:54:40,218: WARNING/ForkPoolWorker-1]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2024-05-16 16:54:40,219: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2024-05-16 16:54:40,219: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2024-05-16 16:54:40,220: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2024-05-16 16:54:40,220: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2024-05-16 16:54:40,221: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2024-05-16 16:54:40,222: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2024-05-16 16:54:40,223: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2024-05-16 16:54:40,223: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2024-05-16 16:54:40,224: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2024-05-16 16:54:40,224: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2024-05-16 16:54:40,225: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2024-05-16 16:54:40,225: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2024-05-16 16:54:40,226: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2024-05-16 16:54:40,226: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2024-05-16 16:54:40,227: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2024-05-16 16:54:40,227: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2024-05-16 16:54:40,228: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2024-05-16 16:54:40,228: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2024-05-16 16:54:40,228: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2024-05-16 16:54:40,229: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2024-05-16 16:54:40,229: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2024-05-16 16:54:40,230: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2024-05-16 16:54:40,230: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2024-05-16 16:54:40,231: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2024-05-16 16:54:40,231: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2024-05-16 16:54:40,232: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2024-05-16 16:54:40,232: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2024-05-16 16:54:40,233: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2024-05-16 16:54:40,233: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2024-05-16 16:54:40,234: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2024-05-16 16:54:40,234: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2024-05-16 16:54:40,234: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2024-05-16 16:54:40,235: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2024-05-16 16:54:40,235: WARNING/ForkPoolWorker-1] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@d821745244bc', 'id': 'be3ff31f-b734-47ac-be96-37f57a918ad9', 'name': 'create_task_list', 'exc': "RuntimeError('Never call result.get() within a task!\\nSee http://docs.celeryq.org/en/latest/userguide/tasks.html#task-synchronous-subtasks\\n')", 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 190, in create_task_list\n    return result.get()\n           ^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 677, in get\n    return (self.join_native if self.supports_native_join else self.join)(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 794, in join_native\n    assert_will_not_block()\n  File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 38, in assert_will_not_block\n    raise RuntimeError(E_WOULDBLOCK)\nRuntimeError: Never call result.get() within a task!\nSee http://docs.celeryq.org/en/latest/userguide/tasks.html#task-synchronous-subtasks\n\n', 'args': "[['downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715878365845-1.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715878371837-2.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715878377807-3.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715878383782-4.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715878389833-5.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715878395733-6.ts']]", 'kwargs': '{}', 'description': 'raised unexpected', 'internal': False}
[2024-05-16 16:54:44,377: INFO/MainProcess] Events of group {task} enabled by remote.
[2024-05-16 16:54:54,546: INFO/MainProcess] Task download_YouTube_url[69b809a8-344f-40a5-893f-0137a18b26ec] received
[2024-05-16 16:54:54,549: WARNING/ForkPoolWorker-1] download YouTube url 123
[2024-05-16 16:54:54,555: WARNING/ForkPoolWorker-1]     error: regex_search: could not find match for (?:v=|\/)([0-9A-Za-z_-]{11}).*
[2024-05-16 16:54:54,559: INFO/MainProcess] Task create_task[04734810-bc19-4f12-b889-5f51f884b25a] received
[2024-05-16 16:54:54,559: INFO/ForkPoolWorker-1] Task download_YouTube_url[69b809a8-344f-40a5-893f-0137a18b26ec] succeeded in 0.010252724001475144s: None
[2024-05-16 16:54:54,562: INFO/ForkPoolWorker-1] Task create_task[04734810-bc19-4f12-b889-5f51f884b25a] succeeded in 0.0007280229983734898s: False
[2024-05-16 16:54:56,555: INFO/MainProcess] Task download_YouTube_url[26149c02-f8c9-4263-aeeb-c2795756960a] received
[2024-05-16 16:54:56,568: WARNING/ForkPoolWorker-1] download YouTube url 123
[2024-05-16 16:54:56,572: WARNING/ForkPoolWorker-1]     error: regex_search: could not find match for (?:v=|\/)([0-9A-Za-z_-]{11}).*
[2024-05-16 16:54:56,574: INFO/MainProcess] Task create_task[edf99a9d-f61d-4be8-ba95-33c7a51fd5c2] received
[2024-05-16 16:54:56,574: INFO/ForkPoolWorker-1] Task download_YouTube_url[26149c02-f8c9-4263-aeeb-c2795756960a] succeeded in 0.006054590998246567s: None
[2024-05-16 16:54:56,578: INFO/ForkPoolWorker-1] Task create_task[edf99a9d-f61d-4be8-ba95-33c7a51fd5c2] succeeded in 0.0008599270004197024s: False
[2024-05-16 16:55:20,408: INFO/MainProcess] Task download_YouTube_url[699063fc-861b-4b13-933a-9c303d91caef] received
[2024-05-16 16:55:20,411: WARNING/ForkPoolWorker-1] download YouTube url https://www.youtube.com/shorts/GqWncUair6o
[2024-05-16 16:55:25,153: WARNING/ForkPoolWorker-1]     done: local_filename /usr/src/app/New Film Out Now.mp4 size 1.1Mb
[2024-05-16 16:55:25,155: INFO/ForkPoolWorker-1] Task download_YouTube_url[699063fc-861b-4b13-933a-9c303d91caef] succeeded in 4.744725558000937s: '/usr/src/app/New Film Out Now.mp4'
[2024-05-16 16:55:25,155: INFO/MainProcess] Task create_task[97fd6587-e167-4843-81a5-1f76d4ffbfa5] received
[2024-05-16 16:55:25,157: WARNING/ForkPoolWorker-1] create_task/usr/src/app/New Film Out Now.mp4
[2024-05-16 16:55:25,158: INFO/ForkPoolWorker-1] Task create_task[97fd6587-e167-4843-81a5-1f76d4ffbfa5] succeeded in 0.0011931369990634266s: True
[2024-05-16 16:56:34,545: INFO/MainProcess] Task download_stream_url[e35d6d80-ae9f-4c0d-8ff7-0f3b166188b3] received
[2024-05-16 16:56:34,553: WARNING/ForkPoolWorker-1] Recording video... 20/10 from https://live-wuxi.cgtn.com/live/wx_cgtn_1000k_internalnormal.m3u8
[2024-05-16 16:56:34,558: WARNING/ForkPoolWorker-1] load m3u8..
[2024-05-16 16:56:36,989: WARNING/ForkPoolWorker-1] Recording fragment 1 segment 1...
[2024-05-16 16:56:38,514: WARNING/ForkPoolWorker-1] Recording fragment 1 segment 2...
[2024-05-16 16:56:40,061: WARNING/ForkPoolWorker-1] Recording fragment 2 segment 3...
[2024-05-16 16:56:41,608: WARNING/ForkPoolWorker-1] Recording fragment 2 segment 4...
[2024-05-16 16:56:42,287: WARNING/ForkPoolWorker-1]     done: fragment_filename_list ['Recording video... 20/10 from https://live-wuxi.cgtn.com/live/wx_cgtn_1000k_internalnormal.m3u8', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715878557864-1.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715878569882-2.ts']
[2024-05-16 16:56:42,291: INFO/MainProcess] Task create_task_list[9ac845d4-4caa-4ad4-8ceb-d082675c765c] received
[2024-05-16 16:56:42,292: INFO/ForkPoolWorker-1] Task download_stream_url[e35d6d80-ae9f-4c0d-8ff7-0f3b166188b3] succeeded in 7.738402645998576s: ['Recording video... 20/10 from https://live-wuxi.cgtn.com/live/wx_cgtn_1000k_internalnormal.m3u8', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715878557864-1.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715878569882-2.ts']
[2024-05-16 16:56:42,296: INFO/MainProcess] Task create_task[6f9c192f-edc2-4de8-8fe2-6f8c8eba7d3c] received
[2024-05-16 16:56:42,298: INFO/MainProcess] Task create_task[f615d4c1-606a-4640-9193-ffc5fa31cb0b] received
[2024-05-16 16:56:42,299: WARNING/ForkPoolWorker-3] create_taskRecording video... 20/10 from https://live-wuxi.cgtn.com/live/wx_cgtn_1000k_internalnormal.m3u8
[2024-05-16 16:56:42,299: WARNING/ForkPoolWorker-2] create_taskdownloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715878557864-1.ts
[2024-05-16 16:56:42,301: INFO/ForkPoolWorker-3] Task create_task[6f9c192f-edc2-4de8-8fe2-6f8c8eba7d3c] succeeded in 0.001572848002979299s: True
[2024-05-16 16:56:42,301: WARNING/ForkPoolWorker-1] --- Logging error ---
[2024-05-16 16:56:42,301: INFO/ForkPoolWorker-2] Task create_task[f615d4c1-606a-4640-9193-ffc5fa31cb0b] succeeded in 0.0017973549984162673s: True
[2024-05-16 16:56:42,301: INFO/MainProcess] Task create_task[0f5a1639-a980-407e-98b3-9d2088867c16] received
[2024-05-16 16:56:42,303: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 16:56:42,304: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:56:42,304: WARNING/ForkPoolWorker-3] create_taskdownloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715878569882-2.ts
[2024-05-16 16:56:42,305: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:56:42,306: WARNING/ForkPoolWorker-1]   File "/usr/src/app/worker.py", line 190, in create_task_list
    return result.get()
           ^^^^^^^^^^^^
[2024-05-16 16:56:42,306: INFO/ForkPoolWorker-3] Task create_task[0f5a1639-a980-407e-98b3-9d2088867c16] succeeded in 0.0018952579994220287s: True
[2024-05-16 16:56:42,307: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 677, in get
    return (self.join_native if self.supports_native_join else self.join)(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:56:42,307: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 794, in join_native
    assert_will_not_block()
[2024-05-16 16:56:42,308: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 38, in assert_will_not_block
    raise RuntimeError(E_WOULDBLOCK)
[2024-05-16 16:56:42,309: WARNING/ForkPoolWorker-1] RuntimeError: Never call result.get() within a task!
See http://docs.celeryq.org/en/latest/userguide/tasks.html#task-synchronous-subtasks
[2024-05-16 16:56:42,310: WARNING/ForkPoolWorker-1] 
During handling of the above exception, another exception occurred:
[2024-05-16 16:56:42,310: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 16:56:42,311: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:56:42,312: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2024-05-16 16:56:42,313: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:56:42,313: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:56:42,314: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:56:42,315: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2024-05-16 16:56:42,315: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:56:42,316: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:56:42,316: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2024-05-16 16:56:42,317: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:56:42,317: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2024-05-16 16:56:42,318: WARNING/ForkPoolWorker-1] AttributeError: '_Code' object has no attribute 'co_positions'
[2024-05-16 16:56:42,318: WARNING/ForkPoolWorker-1] Call stack:
[2024-05-16 16:56:42,319: WARNING/ForkPoolWorker-1]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2024-05-16 16:56:42,320: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2024-05-16 16:56:42,321: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2024-05-16 16:56:42,321: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2024-05-16 16:56:42,322: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2024-05-16 16:56:42,322: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2024-05-16 16:56:42,323: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2024-05-16 16:56:42,323: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2024-05-16 16:56:42,324: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2024-05-16 16:56:42,324: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2024-05-16 16:56:42,325: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2024-05-16 16:56:42,326: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2024-05-16 16:56:42,326: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2024-05-16 16:56:42,327: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2024-05-16 16:56:42,328: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2024-05-16 16:56:42,328: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2024-05-16 16:56:42,329: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2024-05-16 16:56:42,329: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2024-05-16 16:56:42,330: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2024-05-16 16:56:42,330: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2024-05-16 16:56:42,331: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2024-05-16 16:56:42,331: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2024-05-16 16:56:42,332: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2024-05-16 16:56:42,332: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2024-05-16 16:56:42,333: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2024-05-16 16:56:42,333: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2024-05-16 16:56:42,334: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2024-05-16 16:56:42,334: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2024-05-16 16:56:42,335: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2024-05-16 16:56:42,335: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2024-05-16 16:56:42,336: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2024-05-16 16:56:42,336: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2024-05-16 16:56:42,337: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2024-05-16 16:56:42,338: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2024-05-16 16:56:42,338: WARNING/ForkPoolWorker-1] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@d821745244bc', 'id': '9ac845d4-4caa-4ad4-8ceb-d082675c765c', 'name': 'create_task_list', 'exc': "RuntimeError('Never call result.get() within a task!\\nSee http://docs.celeryq.org/en/latest/userguide/tasks.html#task-synchronous-subtasks\\n')", 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 190, in create_task_list\n    return result.get()\n           ^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 677, in get\n    return (self.join_native if self.supports_native_join else self.join)(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 794, in join_native\n    assert_will_not_block()\n  File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 38, in assert_will_not_block\n    raise RuntimeError(E_WOULDBLOCK)\nRuntimeError: Never call result.get() within a task!\nSee http://docs.celeryq.org/en/latest/userguide/tasks.html#task-synchronous-subtasks\n\n', 'args': "[['Recording video... 20/10 from https://live-wuxi.cgtn.com/live/wx_cgtn_1000k_internalnormal.m3u8', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715878557864-1.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715878569882-2.ts']]", 'kwargs': '{}', 'description': 'raised unexpected', 'internal': False}
[2024-05-16 16:58:19,736: INFO/MainProcess] Task download_YouTube_url[2353de94-d2fd-4410-8fa1-cc88720b5088] received
[2024-05-16 16:58:19,738: WARNING/ForkPoolWorker-1] download YouTube url https://www.youtube.com/shorts/GqWncUair6o
[2024-05-16 16:58:23,219: WARNING/ForkPoolWorker-1]     done: local_filename /usr/src/app/New Film Out Now.mp4 size 0.6Mb
[2024-05-16 16:58:23,224: INFO/MainProcess] Task create_task[6e19852e-ccfe-48de-a504-5e2779e1a0df] received
[2024-05-16 16:58:23,224: INFO/ForkPoolWorker-1] Task download_YouTube_url[2353de94-d2fd-4410-8fa1-cc88720b5088] succeeded in 3.4855134719982743s: '/usr/src/app/New Film Out Now.mp4'
[2024-05-16 16:58:23,227: WARNING/ForkPoolWorker-1] create_task/usr/src/app/New Film Out Now.mp4
[2024-05-16 16:58:23,229: INFO/ForkPoolWorker-1] Task create_task[6e19852e-ccfe-48de-a504-5e2779e1a0df] succeeded in 0.0017502479968243279s: True
[2024-05-16 17:28:16,652: INFO/MainProcess] Task download_stream_url[e877e0f5-9076-47e7-afa5-ad14b96c881f] received
[2024-05-16 17:28:16,661: WARNING/ForkPoolWorker-1] Recording video... 20/10 from https://live-wuxi.cgtn.com/live/wx_cgtn_1000k_internalnormal.m3u8
[2024-05-16 17:28:16,663: WARNING/ForkPoolWorker-1] load m3u8..
[2024-05-16 17:28:19,366: WARNING/ForkPoolWorker-1] Recording fragment 1 segment 1...
[2024-05-16 17:28:21,619: WARNING/ForkPoolWorker-1] Recording fragment 1 segment 2...
[2024-05-16 17:28:23,974: WARNING/ForkPoolWorker-1] Recording fragment 2 segment 3...
[2024-05-16 17:28:25,710: WARNING/ForkPoolWorker-1] Recording fragment 2 segment 4...
[2024-05-16 17:28:26,543: WARNING/ForkPoolWorker-1]     done: fragment_filename_list ['Recording video... 20/10 from https://live-wuxi.cgtn.com/live/wx_cgtn_1000k_internalnormal.m3u8', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715880459875-1.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715880471857-2.ts']
[2024-05-16 17:28:26,546: INFO/MainProcess] Task create_task_list[8753da54-02a7-4122-92e7-0eddd0927329] received
[2024-05-16 17:28:26,547: INFO/ForkPoolWorker-1] Task download_stream_url[e877e0f5-9076-47e7-afa5-ad14b96c881f] succeeded in 9.885510980999243s: ['Recording video... 20/10 from https://live-wuxi.cgtn.com/live/wx_cgtn_1000k_internalnormal.m3u8', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715880459875-1.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715880471857-2.ts']
[2024-05-16 17:28:26,550: INFO/MainProcess] Task create_task[d85c6e75-3cbd-4216-b408-261f7401938f] received
[2024-05-16 17:28:26,554: INFO/MainProcess] Task create_task[9eea863e-8a30-4ff9-a3b8-62d96cfc7980] received
[2024-05-16 17:28:26,555: WARNING/ForkPoolWorker-2] create_taskdownloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715880459875-1.ts
[2024-05-16 17:28:26,555: WARNING/ForkPoolWorker-3] create_taskRecording video... 20/10 from https://live-wuxi.cgtn.com/live/wx_cgtn_1000k_internalnormal.m3u8
[2024-05-16 17:28:26,556: INFO/ForkPoolWorker-2] Task create_task[9eea863e-8a30-4ff9-a3b8-62d96cfc7980] succeeded in 0.001434375997632742s: True
[2024-05-16 17:28:26,556: INFO/ForkPoolWorker-3] Task create_task[d85c6e75-3cbd-4216-b408-261f7401938f] succeeded in 0.0016674889993737452s: True
[2024-05-16 17:28:26,556: INFO/MainProcess] Task create_task[85774994-dfbc-4e02-b59c-08c0d770bf2d] received
[2024-05-16 17:28:26,559: WARNING/ForkPoolWorker-3] create_taskdownloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715880471857-2.ts
[2024-05-16 17:28:26,559: WARNING/ForkPoolWorker-1] --- Logging error ---
[2024-05-16 17:28:26,560: INFO/ForkPoolWorker-3] Task create_task[85774994-dfbc-4e02-b59c-08c0d770bf2d] succeeded in 0.0012632670004677493s: True
[2024-05-16 17:28:26,561: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 17:28:26,562: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2024-05-16 17:28:26,562: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 17:28:26,562: WARNING/ForkPoolWorker-1]   File "/usr/src/app/worker.py", line 190, in create_task_list
[2024-05-16 17:28:26,563: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 677, in get
    return (self.join_native if self.supports_native_join else self.join)(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 17:28:26,563: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 794, in join_native
    assert_will_not_block()
[2024-05-16 17:28:26,563: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 38, in assert_will_not_block
    raise RuntimeError(E_WOULDBLOCK)
[2024-05-16 17:28:26,564: WARNING/ForkPoolWorker-1] RuntimeError: Never call result.get() within a task!
See http://docs.celeryq.org/en/latest/userguide/tasks.html#task-synchronous-subtasks
[2024-05-16 17:28:26,564: WARNING/ForkPoolWorker-1] 
During handling of the above exception, another exception occurred:
[2024-05-16 17:28:26,564: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 17:28:26,565: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2024-05-16 17:28:26,565: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2024-05-16 17:28:26,566: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 17:28:26,566: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 17:28:26,570: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 17:28:26,571: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2024-05-16 17:28:26,571: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 17:28:26,571: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 17:28:26,572: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2024-05-16 17:28:26,572: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 17:28:26,572: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2024-05-16 17:28:26,573: WARNING/ForkPoolWorker-1] AttributeError: '_Code' object has no attribute 'co_positions'
[2024-05-16 17:28:26,573: WARNING/ForkPoolWorker-1] Call stack:
[2024-05-16 17:28:26,574: WARNING/ForkPoolWorker-1]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2024-05-16 17:28:26,574: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2024-05-16 17:28:26,574: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2024-05-16 17:28:26,575: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2024-05-16 17:28:26,575: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2024-05-16 17:28:26,575: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2024-05-16 17:28:26,576: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2024-05-16 17:28:26,576: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2024-05-16 17:28:26,576: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2024-05-16 17:28:26,577: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2024-05-16 17:28:26,577: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2024-05-16 17:28:26,577: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2024-05-16 17:28:26,578: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2024-05-16 17:28:26,578: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2024-05-16 17:28:26,578: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2024-05-16 17:28:26,579: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2024-05-16 17:28:26,579: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2024-05-16 17:28:26,579: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2024-05-16 17:28:26,579: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2024-05-16 17:28:26,580: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2024-05-16 17:28:26,580: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2024-05-16 17:28:26,580: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2024-05-16 17:28:26,581: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2024-05-16 17:28:26,581: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2024-05-16 17:28:26,581: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2024-05-16 17:28:26,582: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2024-05-16 17:28:26,582: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2024-05-16 17:28:26,582: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2024-05-16 17:28:26,583: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2024-05-16 17:28:26,583: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2024-05-16 17:28:26,583: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2024-05-16 17:28:26,584: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2024-05-16 17:28:26,584: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2024-05-16 17:28:26,584: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2024-05-16 17:28:26,585: WARNING/ForkPoolWorker-1] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@d821745244bc', 'id': '8753da54-02a7-4122-92e7-0eddd0927329', 'name': 'create_task_list', 'exc': "RuntimeError('Never call result.get() within a task!\\nSee http://docs.celeryq.org/en/latest/userguide/tasks.html#task-synchronous-subtasks\\n')", 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 190, in create_task_list\n  File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 677, in get\n    return (self.join_native if self.supports_native_join else self.join)(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 794, in join_native\n    assert_will_not_block()\n  File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 38, in assert_will_not_block\n    raise RuntimeError(E_WOULDBLOCK)\nRuntimeError: Never call result.get() within a task!\nSee http://docs.celeryq.org/en/latest/userguide/tasks.html#task-synchronous-subtasks\n\n', 'args': "[['Recording video... 20/10 from https://live-wuxi.cgtn.com/live/wx_cgtn_1000k_internalnormal.m3u8', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715880459875-1.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715880471857-2.ts']]", 'kwargs': '{}', 'description': 'raised unexpected', 'internal': False}
[2024-05-16 17:29:52,819: INFO/MainProcess] Task download_YouTube_url[7b674b4a-b980-409a-8c80-0d0124e114d4] received
[2024-05-16 17:29:52,834: WARNING/ForkPoolWorker-1] download YouTube url https://www.youtube.com/shorts/GqWncUair6o
[2024-05-16 17:29:55,990: WARNING/ForkPoolWorker-1]     done: local_filename /usr/src/app/New Film Out Now.mp4 size 1.1Mb
[2024-05-16 17:29:55,992: INFO/ForkPoolWorker-1] Task download_YouTube_url[7b674b4a-b980-409a-8c80-0d0124e114d4] succeeded in 3.158655031998933s: '/usr/src/app/New Film Out Now.mp4'
[2024-05-16 17:29:55,992: INFO/MainProcess] Task create_task[b2ad0af7-21a2-4263-9a43-6bd0d67ce578] received
[2024-05-16 17:29:55,997: WARNING/ForkPoolWorker-1] create_task/usr/src/app/New Film Out Now.mp4
[2024-05-16 17:29:55,999: INFO/ForkPoolWorker-1] Task create_task[b2ad0af7-21a2-4263-9a43-6bd0d67ce578] succeeded in 0.0024197359998652246s: True
[2024-05-16 17:33:30,811: INFO/MainProcess] Task download_YouTube_url[895e540b-65e7-4fe0-943f-5bf88efac83d] received
[2024-05-16 17:33:30,814: WARNING/ForkPoolWorker-1] download YouTube url 123
[2024-05-16 17:33:30,816: WARNING/ForkPoolWorker-1]     error: regex_search: could not find match for (?:v=|\/)([0-9A-Za-z_-]{11}).*
[2024-05-16 17:33:30,819: INFO/ForkPoolWorker-1] Task download_YouTube_url[895e540b-65e7-4fe0-943f-5bf88efac83d] succeeded in 0.004934754000714747s: None
[2024-05-16 17:33:30,819: INFO/MainProcess] Task create_task[04bb6508-7375-4815-9ddd-8d8f83e06ecc] received
[2024-05-16 17:33:30,822: INFO/ForkPoolWorker-1] Task create_task[04bb6508-7375-4815-9ddd-8d8f83e06ecc] succeeded in 0.0008625620030215941s: False
[2024-05-16 17:34:17,964: INFO/MainProcess] Task download_YouTube_url[6b8bd013-0a45-4bbd-a95b-89bca3983591] received
[2024-05-16 17:34:17,966: WARNING/ForkPoolWorker-1] download YouTube url 123
[2024-05-16 17:34:17,969: WARNING/ForkPoolWorker-1]     error: regex_search: could not find match for (?:v=|\/)([0-9A-Za-z_-]{11}).*
[2024-05-16 17:34:17,975: INFO/MainProcess] Task create_task[06c3dae3-6083-410b-b833-34f65d15a936] received
[2024-05-16 17:34:17,976: INFO/ForkPoolWorker-1] Task download_YouTube_url[6b8bd013-0a45-4bbd-a95b-89bca3983591] succeeded in 0.009317101001215633s: None
[2024-05-16 17:34:17,980: INFO/ForkPoolWorker-1] Task create_task[06c3dae3-6083-410b-b833-34f65d15a936] succeeded in 0.0006249200014281087s: False
[2024-05-16 17:34:38,922: INFO/MainProcess] Connected to redis://redis:6379/0
[2024-05-16 17:34:38,926: INFO/MainProcess] mingle: searching for neighbors
[2024-05-16 17:34:39,937: INFO/MainProcess] mingle: all alone
[2024-05-16 17:34:39,950: INFO/MainProcess] celery@d821745244bc ready.
[2024-05-16 17:34:43,986: INFO/MainProcess] Events of group {task} enabled by remote.
[2024-05-16 17:35:04,328: INFO/MainProcess] Task download_YouTube_url[f15aa6bd-37e1-4889-ae26-841569d55c27] received
[2024-05-16 17:35:04,332: WARNING/ForkPoolWorker-1] download YouTube url 13
[2024-05-16 17:35:04,336: WARNING/ForkPoolWorker-1]     error: regex_search: could not find match for (?:v=|\/)([0-9A-Za-z_-]{11}).*
[2024-05-16 17:35:04,353: INFO/MainProcess] Task create_task[9d945df8-e256-45f4-9861-c7d168da7ac0] received
[2024-05-16 17:35:04,355: INFO/ForkPoolWorker-1] Task download_YouTube_url[f15aa6bd-37e1-4889-ae26-841569d55c27] succeeded in 0.02299117900111014s: None
[2024-05-16 17:35:04,362: INFO/ForkPoolWorker-3] Task create_task[9d945df8-e256-45f4-9861-c7d168da7ac0] succeeded in 0.005580085999099538s: False
[2024-05-16 17:35:50,053: INFO/MainProcess] Task download_YouTube_url[60c36806-2b5b-492e-8332-93e2b1876442] received
[2024-05-16 17:35:50,057: WARNING/ForkPoolWorker-1] download YouTube url 123
[2024-05-16 17:35:50,057: WARNING/ForkPoolWorker-1]     error: regex_search: could not find match for (?:v=|\/)([0-9A-Za-z_-]{11}).*
[2024-05-16 17:35:50,060: INFO/ForkPoolWorker-1] Task download_YouTube_url[60c36806-2b5b-492e-8332-93e2b1876442] succeeded in 0.003948566998587921s: None
[2024-05-16 17:35:50,060: INFO/MainProcess] Task create_task[883b1e25-04e3-4030-aece-4e959ca1108d] received
[2024-05-16 17:35:50,069: INFO/ForkPoolWorker-1] Task create_task[883b1e25-04e3-4030-aece-4e959ca1108d] succeeded in 0.002241695001430344s: False
[2024-05-16 17:36:41,773: INFO/MainProcess] Task download_YouTube_url[006b1a38-6491-4ad9-9e46-925cf602ddb6] received
[2024-05-16 17:36:41,780: WARNING/ForkPoolWorker-1] download YouTube url 123
[2024-05-16 17:36:41,785: WARNING/ForkPoolWorker-1]     error: regex_search: could not find match for (?:v=|\/)([0-9A-Za-z_-]{11}).*
[2024-05-16 17:36:41,788: INFO/MainProcess] Task create_task[7ec125ca-2326-42d9-b70c-7a03caf9fb21] received
[2024-05-16 17:36:41,789: INFO/ForkPoolWorker-1] Task download_YouTube_url[006b1a38-6491-4ad9-9e46-925cf602ddb6] succeeded in 0.008258045003458392s: None
[2024-05-16 17:36:41,796: INFO/ForkPoolWorker-1] Task create_task[7ec125ca-2326-42d9-b70c-7a03caf9fb21] succeeded in 0.0007903330006229226s: False
[2024-05-16 17:37:22,687: INFO/MainProcess] Task download_YouTube_url[15856483-1c67-4725-b16e-5b6fe2fe3f84] received
[2024-05-16 17:37:22,702: WARNING/ForkPoolWorker-1] download YouTube url 123
[2024-05-16 17:37:22,704: WARNING/ForkPoolWorker-1]     error: regex_search: could not find match for (?:v=|\/)([0-9A-Za-z_-]{11}).*
[2024-05-16 17:37:22,707: INFO/MainProcess] Task create_task[6665f24a-ed56-441c-84d0-54c241319c49] received
[2024-05-16 17:37:22,708: INFO/ForkPoolWorker-1] Task download_YouTube_url[15856483-1c67-4725-b16e-5b6fe2fe3f84] succeeded in 0.006065612000384135s: None
[2024-05-16 17:37:22,712: INFO/ForkPoolWorker-3] Task create_task[6665f24a-ed56-441c-84d0-54c241319c49] succeeded in 0.0009297329997934867s: False
[2024-05-16 17:37:38,990: INFO/MainProcess] Task download_YouTube_url[4a619914-b8f1-43e0-a363-c3cede627f25] received
[2024-05-16 17:37:39,002: WARNING/ForkPoolWorker-1] download YouTube url 123
[2024-05-16 17:37:39,008: WARNING/ForkPoolWorker-1]     error: regex_search: could not find match for (?:v=|\/)([0-9A-Za-z_-]{11}).*
[2024-05-16 17:37:39,012: INFO/ForkPoolWorker-1] Task download_YouTube_url[4a619914-b8f1-43e0-a363-c3cede627f25] succeeded in 0.009523194999928819s: None
[2024-05-16 17:37:39,011: INFO/MainProcess] Task create_task[3250dd14-22fd-4f3c-80fb-a3c41d6a4016] received
[2024-05-16 17:37:39,015: INFO/ForkPoolWorker-1] Task create_task[3250dd14-22fd-4f3c-80fb-a3c41d6a4016] succeeded in 0.0006937289981578942s: False
[2024-05-16 17:38:24,967: INFO/MainProcess] Task download_YouTube_url[cb1ddb66-ad13-4bd5-a1a4-73337a35a024] received
[2024-05-16 17:38:24,974: WARNING/ForkPoolWorker-1] download YouTube url 213
[2024-05-16 17:38:24,980: WARNING/ForkPoolWorker-1]     error: regex_search: could not find match for (?:v=|\/)([0-9A-Za-z_-]{11}).*
[2024-05-16 17:38:24,983: INFO/ForkPoolWorker-1] Task download_YouTube_url[cb1ddb66-ad13-4bd5-a1a4-73337a35a024] succeeded in 0.00894726199840079s: None
[2024-05-16 17:38:24,983: INFO/MainProcess] Task create_task[4a2d331a-9a86-4175-b027-3e1844c9c20b] received
[2024-05-16 17:38:24,987: INFO/ForkPoolWorker-1] Task create_task[4a2d331a-9a86-4175-b027-3e1844c9c20b] succeeded in 0.0006509270024253055s: False
[2024-05-16 17:39:05,645: INFO/MainProcess] Task download_YouTube_url[cc4f6e82-211f-47df-9f85-f5db539d4543] received
[2024-05-16 17:39:05,655: WARNING/ForkPoolWorker-1] download YouTube url 123
[2024-05-16 17:39:05,657: WARNING/ForkPoolWorker-1]     error: regex_search: could not find match for (?:v=|\/)([0-9A-Za-z_-]{11}).*
[2024-05-16 17:39:05,662: INFO/ForkPoolWorker-1] Task download_YouTube_url[cc4f6e82-211f-47df-9f85-f5db539d4543] succeeded in 0.0072196000000985805s: None
[2024-05-16 17:39:05,662: INFO/MainProcess] Task create_task[a39394e1-0b88-4f63-832d-a954facc528a] received
[2024-05-16 17:39:05,667: INFO/ForkPoolWorker-1] Task create_task[a39394e1-0b88-4f63-832d-a954facc528a] succeeded in 0.0010913449987128843s: False
[2024-05-16 17:41:53,272: INFO/MainProcess] Task download_YouTube_url[473670ed-c68c-4197-b70b-c7d4e060c717] received
[2024-05-16 17:41:53,280: WARNING/ForkPoolWorker-1] download YouTube url 123
[2024-05-16 17:41:53,284: WARNING/ForkPoolWorker-1]     error: regex_search: could not find match for (?:v=|\/)([0-9A-Za-z_-]{11}).*
[2024-05-16 17:41:53,287: INFO/ForkPoolWorker-1] Task download_YouTube_url[473670ed-c68c-4197-b70b-c7d4e060c717] succeeded in 0.006230766000953736s: None
[2024-05-16 17:41:53,287: INFO/MainProcess] Task create_task[177f2351-0961-4211-890b-37a4556556ca] received
[2024-05-16 17:41:53,295: INFO/ForkPoolWorker-1] Task create_task[177f2351-0961-4211-890b-37a4556556ca] succeeded in 0.000781433998781722s: False
[2024-05-16 17:41:57,106: INFO/MainProcess] Task download_YouTube_url[ff1d8946-f1fb-4a68-85ef-3f5c6d2e8d35] received
[2024-05-16 17:41:57,117: WARNING/ForkPoolWorker-1] download YouTube url 123
[2024-05-16 17:41:57,118: WARNING/ForkPoolWorker-1]     error: regex_search: could not find match for (?:v=|\/)([0-9A-Za-z_-]{11}).*
[2024-05-16 17:41:57,121: INFO/MainProcess] Task create_task[33f58523-6e9e-42bf-b214-ad0c569113f0] received
[2024-05-16 17:41:57,121: INFO/ForkPoolWorker-1] Task download_YouTube_url[ff1d8946-f1fb-4a68-85ef-3f5c6d2e8d35] succeeded in 0.00437488700117683s: None
[2024-05-16 17:41:57,124: INFO/ForkPoolWorker-1] Task create_task[33f58523-6e9e-42bf-b214-ad0c569113f0] succeeded in 0.0010007419987232424s: False
[2024-05-16 17:42:00,558: INFO/MainProcess] Task download_YouTube_url[b0f33a74-30de-4a42-b0a5-fd1726e30fd2] received
[2024-05-16 17:42:00,562: WARNING/ForkPoolWorker-1] download YouTube url https://www.youtube.com/shorts/GqWncUair6o
[2024-05-16 17:42:04,389: WARNING/ForkPoolWorker-1]     done: local_filename /usr/src/app/New Film Out Now.mp4 size 0.6Mb
[2024-05-16 17:42:04,392: INFO/ForkPoolWorker-1] Task download_YouTube_url[b0f33a74-30de-4a42-b0a5-fd1726e30fd2] succeeded in 3.8299844850007503s: '/usr/src/app/New Film Out Now.mp4'
[2024-05-16 17:42:04,392: INFO/MainProcess] Task create_task[6679e67d-128a-48f3-a923-9bb495c00140] received
[2024-05-16 17:42:04,394: WARNING/ForkPoolWorker-1] create_task /usr/src/app/New Film Out Now.mp4
[2024-05-16 17:42:04,395: INFO/ForkPoolWorker-1] Task create_task[6679e67d-128a-48f3-a923-9bb495c00140] succeeded in 0.0014114059995335992s: True
[2024-05-16 17:42:40,400: INFO/MainProcess] Connected to redis://redis:6379/0
[2024-05-16 17:42:40,407: INFO/MainProcess] mingle: searching for neighbors
[2024-05-16 17:42:41,419: INFO/MainProcess] mingle: all alone
[2024-05-16 17:42:41,433: INFO/MainProcess] celery@d821745244bc ready.
[2024-05-16 17:42:45,469: INFO/MainProcess] Events of group {task} enabled by remote.
[2024-05-16 17:42:59,888: INFO/MainProcess] Task download_YouTube_url[408b3497-fa02-4ffe-b863-1a47b36e939a] received
[2024-05-16 17:42:59,890: WARNING/ForkPoolWorker-1] download YouTube url https://www.youtube.com/shorts/GqWncUair6o
[2024-05-16 17:43:03,446: WARNING/ForkPoolWorker-1]     done: local_filename /usr/src/app/New Film Out Now.mp4 size 1.1Mb
[2024-05-16 17:43:03,456: INFO/MainProcess] Task create_task[39522bda-20fe-48f3-a668-35c137a61771] received
[2024-05-16 17:43:03,459: INFO/ForkPoolWorker-1] Task download_YouTube_url[408b3497-fa02-4ffe-b863-1a47b36e939a] succeeded in 3.568792107002082s: '/usr/src/app/New Film Out Now.mp4'
[2024-05-16 17:43:03,458: WARNING/ForkPoolWorker-3] create_task /usr/src/app/New Film Out Now.mp4
[2024-05-16 17:43:03,463: INFO/ForkPoolWorker-3] Task create_task[39522bda-20fe-48f3-a668-35c137a61771] succeeded in 0.004534646999672987s: True
[2024-05-16 17:43:14,889: INFO/MainProcess] Task download_YouTube_url[a217dcc5-6fae-4b91-81f4-9d5098afda78] received
[2024-05-16 17:43:14,894: WARNING/ForkPoolWorker-1] download YouTube url https://www.youtube.com/shorts/GqWnc
[2024-05-16 17:43:14,901: WARNING/ForkPoolWorker-1]     error: regex_search: could not find match for (?:v=|\/)([0-9A-Za-z_-]{11}).*
[2024-05-16 17:43:14,910: INFO/MainProcess] Task create_task[f8432830-8a9e-4be5-bfce-b8670ffddb8e] received
[2024-05-16 17:43:14,910: INFO/ForkPoolWorker-1] Task download_YouTube_url[a217dcc5-6fae-4b91-81f4-9d5098afda78] succeeded in 0.015448063000803813s: None
[2024-05-16 17:43:14,947: INFO/ForkPoolWorker-3] Task create_task[f8432830-8a9e-4be5-bfce-b8670ffddb8e] succeeded in 0.0008735379997233395s: False
[2024-05-16 17:43:20,701: INFO/MainProcess] Task download_YouTube_url[6f738972-ef44-4dc5-b4ab-a0d4dfccc690] received
[2024-05-16 17:43:20,712: WARNING/ForkPoolWorker-1] download YouTube url 13122
[2024-05-16 17:43:20,717: WARNING/ForkPoolWorker-1]     error: regex_search: could not find match for (?:v=|\/)([0-9A-Za-z_-]{11}).*
[2024-05-16 17:43:20,720: INFO/ForkPoolWorker-1] Task download_YouTube_url[6f738972-ef44-4dc5-b4ab-a0d4dfccc690] succeeded in 0.007845809999707853s: None
[2024-05-16 17:43:20,720: INFO/MainProcess] Task create_task[31675d4d-50ba-4dfb-8e79-2d360cef9af3] received
[2024-05-16 17:43:20,724: INFO/ForkPoolWorker-1] Task create_task[31675d4d-50ba-4dfb-8e79-2d360cef9af3] succeeded in 0.000831500998174306s: False
[2024-05-16 17:43:51,568: INFO/MainProcess] Task download_file_url[729d26c6-745a-4bf5-8711-d215c9e32ba2] received
[2024-05-16 17:43:51,571: WARNING/ForkPoolWorker-1] Downloading file 123
[2024-05-16 17:43:51,605: WARNING/ForkPoolWorker-1] --- Logging error ---
[2024-05-16 17:43:51,618: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 17:43:51,625: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2024-05-16 17:43:51,625: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 17:43:51,626: WARNING/ForkPoolWorker-1]   File "/usr/src/app/worker.py", line 158, in download_file_url
    with open(local_filename, "wb") as f:
     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 17:43:51,627: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 73, in get
    return request("get", url, params=params, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 17:43:51,636: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 17:43:51,637: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 573, in request
    prep = self.prepare_request(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 17:43:51,638: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 484, in prepare_request
    p.prepare(
[2024-05-16 17:43:51,640: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/requests/models.py", line 368, in prepare
    self.prepare_url(url, params)
[2024-05-16 17:43:51,641: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/requests/models.py", line 439, in prepare_url
    raise MissingSchema(
[2024-05-16 17:43:51,644: WARNING/ForkPoolWorker-1] requests.exceptions.MissingSchema: Invalid URL '123': No scheme supplied. Perhaps you meant https://123?
[2024-05-16 17:43:51,644: WARNING/ForkPoolWorker-1] 
During handling of the above exception, another exception occurred:
[2024-05-16 17:43:51,645: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 17:43:51,646: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2024-05-16 17:43:51,646: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2024-05-16 17:43:51,647: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 17:43:51,647: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 17:43:51,650: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 17:43:51,651: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2024-05-16 17:43:51,652: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 17:43:51,652: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 17:43:51,653: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2024-05-16 17:43:51,653: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 17:43:51,654: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2024-05-16 17:43:51,654: WARNING/ForkPoolWorker-1] AttributeError: '_Code' object has no attribute 'co_positions'
[2024-05-16 17:43:51,654: WARNING/ForkPoolWorker-1] Call stack:
[2024-05-16 17:43:51,657: WARNING/ForkPoolWorker-1]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2024-05-16 17:43:51,658: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2024-05-16 17:43:51,658: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2024-05-16 17:43:51,659: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2024-05-16 17:43:51,659: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2024-05-16 17:43:51,659: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2024-05-16 17:43:51,660: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2024-05-16 17:43:51,660: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2024-05-16 17:43:51,661: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2024-05-16 17:43:51,661: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2024-05-16 17:43:51,661: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2024-05-16 17:43:51,662: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2024-05-16 17:43:51,663: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2024-05-16 17:43:51,664: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2024-05-16 17:43:51,664: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2024-05-16 17:43:51,665: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2024-05-16 17:43:51,665: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2024-05-16 17:43:51,666: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2024-05-16 17:43:51,666: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2024-05-16 17:43:51,667: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2024-05-16 17:43:51,667: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2024-05-16 17:43:51,668: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2024-05-16 17:43:51,668: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2024-05-16 17:43:51,669: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2024-05-16 17:43:51,669: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2024-05-16 17:43:51,670: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2024-05-16 17:43:51,670: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2024-05-16 17:43:51,671: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2024-05-16 17:43:51,671: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2024-05-16 17:43:51,673: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2024-05-16 17:43:51,674: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2024-05-16 17:43:51,676: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2024-05-16 17:43:51,677: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2024-05-16 17:43:51,677: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2024-05-16 17:43:51,678: WARNING/ForkPoolWorker-1] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@d821745244bc', 'id': '729d26c6-745a-4bf5-8711-d215c9e32ba2', 'name': 'download_file_url', 'exc': 'MissingSchema("Invalid URL \'123\': No scheme supplied. Perhaps you meant https://123?")', 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 158, in download_file_url\n    with open(local_filename, "wb") as f:\n     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 73, in get\n    return request("get", url, params=params, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/api.py", line 59, in request\n    return session.request(method=method, url=url, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 573, in request\n    prep = self.prepare_request(req)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/requests/sessions.py", line 484, in prepare_request\n    p.prepare(\n  File "/usr/local/lib/python3.11/site-packages/requests/models.py", line 368, in prepare\n    self.prepare_url(url, params)\n  File "/usr/local/lib/python3.11/site-packages/requests/models.py", line 439, in prepare_url\n    raise MissingSchema(\nrequests.exceptions.MissingSchema: Invalid URL \'123\': No scheme supplied. Perhaps you meant https://123?\n', 'args': '[]', 'kwargs': "{'url': '123'}", 'description': 'raised unexpected', 'internal': False}
[2024-05-16 17:45:12,842: INFO/MainProcess] Connected to redis://redis:6379/0
[2024-05-16 17:45:12,847: INFO/MainProcess] mingle: searching for neighbors
[2024-05-16 17:45:13,868: INFO/MainProcess] mingle: all alone
[2024-05-16 17:45:13,883: INFO/MainProcess] celery@d821745244bc ready.
[2024-05-16 17:45:17,947: INFO/MainProcess] Events of group {task} enabled by remote.
[2024-05-16 17:45:27,644: INFO/MainProcess] Task download_YouTube_url[c4077c56-5e3a-418c-bad7-679c6778a640] received
[2024-05-16 17:45:27,652: WARNING/ForkPoolWorker-1] download YouTube url https://www.youtube.com/shorts/MWhCyJ7mxm8
[2024-05-16 17:45:33,820: WARNING/ForkPoolWorker-1]     done: local_filename /usr/src/app/Не сломал а разобрал! Как устроено электромагнитное РЕЛЕ! сделайсам diy электроника.mp4 size 2.4Mb
[2024-05-16 17:45:33,828: INFO/MainProcess] Task create_task[e8897906-f082-4f4c-85c3-f171ea51a21a] received
[2024-05-16 17:45:33,830: INFO/ForkPoolWorker-1] Task download_YouTube_url[c4077c56-5e3a-418c-bad7-679c6778a640] succeeded in 6.183003949998238s: '/usr/src/app/Не сломал а разобрал! Как устроено электромагнитное РЕЛЕ! сделайсам diy электроника.mp4'
[2024-05-16 17:45:33,831: WARNING/ForkPoolWorker-1] create_task /usr/src/app/Не сломал а разобрал! Как устроено электромагнитное РЕЛЕ! сделайсам diy электроника.mp4
[2024-05-16 17:45:33,833: INFO/ForkPoolWorker-1] Task create_task[e8897906-f082-4f4c-85c3-f171ea51a21a] succeeded in 0.0014151729992590845s: True
[2024-05-16 17:45:39,239: INFO/MainProcess] Task download_YouTube_url[4038dc21-c2b2-4632-b3d4-ad2f07ab5859] received
[2024-05-16 17:45:39,247: WARNING/ForkPoolWorker-1] download YouTube url https://www.youtube.com/shorts/MWhCy
[2024-05-16 17:45:39,262: WARNING/ForkPoolWorker-1] --- Logging error ---
[2024-05-16 17:45:39,264: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 17:45:39,281: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2024-05-16 17:45:39,287: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 17:45:39,294: WARNING/ForkPoolWorker-1]   File "/usr/src/app/worker.py", line 171, in download_YouTube_url
    yt = YouTube(url)
         ^^^^^^^^^^^^
[2024-05-16 17:45:39,295: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/pytube/__main__.py", line 71, in __init__
    self.video_id = extract.video_id(url)
                    ^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 17:45:39,295: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/pytube/extract.py", line 133, in video_id
    return regex_search(r"(?:v=|\/)([0-9A-Za-z_-]{11}).*", url, group=1)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 17:45:39,296: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/pytube/helpers.py", line 129, in regex_search
    raise RegexMatchError(caller="regex_search", pattern=pattern)
[2024-05-16 17:45:39,296: WARNING/ForkPoolWorker-1] pytube.exceptions.RegexMatchError: regex_search: could not find match for (?:v=|\/)([0-9A-Za-z_-]{11}).*
[2024-05-16 17:45:39,298: WARNING/ForkPoolWorker-1] 
During handling of the above exception, another exception occurred:
[2024-05-16 17:45:39,302: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 17:45:39,303: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2024-05-16 17:45:39,304: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2024-05-16 17:45:39,304: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 17:45:39,305: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 17:45:39,305: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 17:45:39,305: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2024-05-16 17:45:39,306: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 17:45:39,306: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 17:45:39,307: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2024-05-16 17:45:39,307: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 17:45:39,308: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2024-05-16 17:45:39,310: WARNING/ForkPoolWorker-1] AttributeError: '_Code' object has no attribute 'co_positions'
[2024-05-16 17:45:39,310: WARNING/ForkPoolWorker-1] Call stack:
[2024-05-16 17:45:39,314: WARNING/ForkPoolWorker-1]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2024-05-16 17:45:39,315: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2024-05-16 17:45:39,318: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2024-05-16 17:45:39,319: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2024-05-16 17:45:39,320: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2024-05-16 17:45:39,321: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2024-05-16 17:45:39,321: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2024-05-16 17:45:39,322: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2024-05-16 17:45:39,322: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2024-05-16 17:45:39,323: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2024-05-16 17:45:39,324: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2024-05-16 17:45:39,325: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2024-05-16 17:45:39,326: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2024-05-16 17:45:39,327: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2024-05-16 17:45:39,327: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2024-05-16 17:45:39,328: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2024-05-16 17:45:39,328: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2024-05-16 17:45:39,328: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2024-05-16 17:45:39,329: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2024-05-16 17:45:39,329: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2024-05-16 17:45:39,330: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2024-05-16 17:45:39,330: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2024-05-16 17:45:39,330: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2024-05-16 17:45:39,331: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2024-05-16 17:45:39,331: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2024-05-16 17:45:39,331: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2024-05-16 17:45:39,335: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2024-05-16 17:45:39,336: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2024-05-16 17:45:39,336: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2024-05-16 17:45:39,337: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2024-05-16 17:45:39,337: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2024-05-16 17:45:39,337: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2024-05-16 17:45:39,338: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2024-05-16 17:45:39,338: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2024-05-16 17:45:39,338: WARNING/ForkPoolWorker-1] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@d821745244bc', 'id': '4038dc21-c2b2-4632-b3d4-ad2f07ab5859', 'name': 'download_YouTube_url', 'exc': "ExtractError('regex_search: could not find match for (?:v=|\\\\/)([0-9A-Za-z_-]{11}).*')", 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 171, in download_YouTube_url\n    yt = YouTube(url)\n         ^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/pytube/__main__.py", line 71, in __init__\n    self.video_id = extract.video_id(url)\n                    ^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/pytube/extract.py", line 133, in video_id\n    return regex_search(r"(?:v=|\\/)([0-9A-Za-z_-]{11}).*", url, group=1)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/pytube/helpers.py", line 129, in regex_search\n    raise RegexMatchError(caller="regex_search", pattern=pattern)\npytube.exceptions.RegexMatchError: regex_search: could not find match for (?:v=|\\/)([0-9A-Za-z_-]{11}).*\n', 'args': '[]', 'kwargs': "{'url': 'https://www.youtube.com/shorts/MWhCy'}", 'description': 'raised unexpected', 'internal': False}
[2024-05-16 17:46:27,704: INFO/MainProcess] Task download_stream_url[f5a22f84-c365-4e59-a40a-1e66ad6a6518] received
[2024-05-16 17:46:27,707: WARNING/ForkPoolWorker-1] Recording video... 1/1 from https://live-wuxi.cgtn.com/live/wx_cgtn_1000k_internalnormal.m3u8
[2024-05-16 17:46:27,715: WARNING/ForkPoolWorker-1] load m3u8..
[2024-05-16 17:46:30,484: WARNING/ForkPoolWorker-1] Recording fragment 1 segment 1...
[2024-05-16 17:46:31,370: WARNING/ForkPoolWorker-1]     done: fragment_filename_list ['Recording video... 1/1 from https://live-wuxi.cgtn.com/live/wx_cgtn_1000k_internalnormal.m3u8', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715881551863-1.ts']
[2024-05-16 17:46:31,375: INFO/MainProcess] Task create_task_list[4aa98cb7-430b-46da-a8a8-c3a2a324fabd] received
[2024-05-16 17:46:31,375: INFO/ForkPoolWorker-1] Task download_stream_url[f5a22f84-c365-4e59-a40a-1e66ad6a6518] succeeded in 3.668256692999421s: ['Recording video... 1/1 from https://live-wuxi.cgtn.com/live/wx_cgtn_1000k_internalnormal.m3u8', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715881551863-1.ts']
[2024-05-16 17:46:31,377: WARNING/ForkPoolWorker-1] create_task_list ['Recording video... 1/1 from https://live-wuxi.cgtn.com/live/wx_cgtn_1000k_internalnormal.m3u8', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715881551863-1.ts']
[2024-05-16 17:46:31,379: INFO/ForkPoolWorker-1] Task create_task_list[4aa98cb7-430b-46da-a8a8-c3a2a324fabd] succeeded in 0.002721130000281846s: True
