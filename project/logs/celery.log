[2024-05-14 11:51:10,987: INFO/MainProcess] Task create_task[4c2b46f0-e627-4f07-84a6-77511753ecd0] received
[2024-05-14 11:51:10,990: WARNING/ForkPoolWorker-1] create_task1
[2024-05-14 11:51:10,995: INFO/MainProcess] Task download_file_url[e7b8e38a-c5c7-4c69-97c6-61f4cde84450] received
[2024-05-14 11:51:10,996: INFO/ForkPoolWorker-1] Task create_task[4c2b46f0-e627-4f07-84a6-77511753ecd0] succeeded in 0.00552229000004445s: <AsyncResult: e7b8e38a-c5c7-4c69-97c6-61f4cde84450>
[2024-05-14 11:51:10,998: WARNING/ForkPoolWorker-3] Downloading file <@task: download_file_url of worker at 0x7f3508f40e50>
[2024-05-14 11:51:11,304: WARNING/ForkPoolWorker-3]     done: local_filename switchCase.png
[2024-05-14 11:51:11,310: INFO/ForkPoolWorker-3] Task download_file_url[e7b8e38a-c5c7-4c69-97c6-61f4cde84450] succeeded in 0.311464034999517s: 'switchCase.png'
[2024-05-14 11:51:12,661: INFO/MainProcess] Task create_task[8506f9b6-5c86-4e3c-8072-2749a69b655b] received
[2024-05-14 11:51:12,664: WARNING/ForkPoolWorker-1] create_task2
[2024-05-14 11:51:12,668: INFO/MainProcess] Task download_YouTube_url[07c56774-0b3b-49ab-8856-e6cd683afdfd] received
[2024-05-14 11:51:12,668: INFO/ForkPoolWorker-1] Task create_task[8506f9b6-5c86-4e3c-8072-2749a69b655b] succeeded in 0.0039336059999186546s: <AsyncResult: 07c56774-0b3b-49ab-8856-e6cd683afdfd>
[2024-05-14 11:51:12,670: WARNING/ForkPoolWorker-1] download YouTube url <@task: download_file_url of worker at 0x7f3508f40e50>
[2024-05-14 11:51:14,024: WARNING/ForkPoolWorker-1] --- Logging error ---
[2024-05-14 11:51:14,027: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-14 11:51:14,028: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2024-05-14 11:51:14,029: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-14 11:51:14,029: WARNING/ForkPoolWorker-1]   File "/usr/src/app/worker.py", line 37, in download_YouTube_url
    yt = YouTube(url)
         ^^^^^^^^^^^^
[2024-05-14 11:51:14,030: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/pytube/__main__.py", line 91, in __init__
    self.prefetch()
[2024-05-14 11:51:14,030: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/pytube/__main__.py", line 181, in prefetch
    self.vid_info_raw = request.get(self.vid_info_url)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-14 11:51:14,031: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/pytube/request.py", line 36, in get
    return _execute_request(url).read().decode("utf-8")
           ^^^^^^^^^^^^^^^^^^^^^
[2024-05-14 11:51:14,032: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/pytube/request.py", line 24, in _execute_request
    return urlopen(request)  # nosec
           ^^^^^^^^^^^^^^^^
[2024-05-14 11:51:14,032: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/urllib/request.py", line 216, in urlopen
    return opener.open(url, data, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-14 11:51:14,033: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/urllib/request.py", line 525, in open
    response = meth(req, response)
               ^^^^^^^^^^^^^^^^^^^
[2024-05-14 11:51:14,033: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/urllib/request.py", line 634, in http_response
    response = self.parent.error(
               ^^^^^^^^^^^^^^^^^^
[2024-05-14 11:51:14,034: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/urllib/request.py", line 557, in error
    result = self._call_chain(*args)
             ^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-14 11:51:14,035: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/urllib/request.py", line 496, in _call_chain
    result = func(*args)
             ^^^^^^^^^^^
[2024-05-14 11:51:14,035: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/urllib/request.py", line 749, in http_error_302
    return self.parent.open(new, timeout=req.timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-14 11:51:14,036: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/urllib/request.py", line 525, in open
    response = meth(req, response)
               ^^^^^^^^^^^^^^^^^^^
[2024-05-14 11:51:14,036: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/urllib/request.py", line 634, in http_response
    response = self.parent.error(
               ^^^^^^^^^^^^^^^^^^
[2024-05-14 11:51:14,037: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/urllib/request.py", line 563, in error
    return self._call_chain(*args)
           ^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-14 11:51:14,037: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/urllib/request.py", line 496, in _call_chain
    result = func(*args)
             ^^^^^^^^^^^
[2024-05-14 11:51:14,038: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/urllib/request.py", line 643, in http_error_default
    raise HTTPError(req.full_url, code, msg, hdrs, fp)
[2024-05-14 11:51:14,038: WARNING/ForkPoolWorker-1] urllib.error.HTTPError: HTTP Error 410: Gone
[2024-05-14 11:51:14,039: WARNING/ForkPoolWorker-1] 
During handling of the above exception, another exception occurred:
[2024-05-14 11:51:14,039: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-14 11:51:14,040: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2024-05-14 11:51:14,041: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2024-05-14 11:51:14,041: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2024-05-14 11:51:14,042: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-14 11:51:14,042: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-14 11:51:14,043: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2024-05-14 11:51:14,044: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-14 11:51:14,044: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-14 11:51:14,045: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2024-05-14 11:51:14,045: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-14 11:51:14,046: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2024-05-14 11:51:14,046: WARNING/ForkPoolWorker-1] AttributeError: '_Code' object has no attribute 'co_positions'
[2024-05-14 11:51:14,047: WARNING/ForkPoolWorker-1] Call stack:
[2024-05-14 11:51:14,048: WARNING/ForkPoolWorker-1]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2024-05-14 11:51:14,048: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2024-05-14 11:51:14,049: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2024-05-14 11:51:14,050: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2024-05-14 11:51:14,050: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2024-05-14 11:51:14,051: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2024-05-14 11:51:14,051: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2024-05-14 11:51:14,052: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2024-05-14 11:51:14,052: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2024-05-14 11:51:14,053: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2024-05-14 11:51:14,053: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2024-05-14 11:51:14,054: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2024-05-14 11:51:14,054: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2024-05-14 11:51:14,055: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2024-05-14 11:51:14,056: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2024-05-14 11:51:14,056: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2024-05-14 11:51:14,057: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2024-05-14 11:51:14,057: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2024-05-14 11:51:14,058: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2024-05-14 11:51:14,059: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2024-05-14 11:51:14,059: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2024-05-14 11:51:14,060: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2024-05-14 11:51:14,060: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2024-05-14 11:51:14,061: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2024-05-14 11:51:14,061: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2024-05-14 11:51:14,062: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2024-05-14 11:51:14,063: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2024-05-14 11:51:14,063: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2024-05-14 11:51:14,064: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2024-05-14 11:51:14,064: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2024-05-14 11:51:14,065: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2024-05-14 11:51:14,065: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2024-05-14 11:51:14,066: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2024-05-14 11:51:14,067: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2024-05-14 11:51:14,068: WARNING/ForkPoolWorker-1] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@6080601e8add', 'id': '07c56774-0b3b-49ab-8856-e6cd683afdfd', 'name': 'download_YouTube_url', 'exc': 'OSError()', 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 37, in download_YouTube_url\n    yt = YouTube(url)\n         ^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/pytube/__main__.py", line 91, in __init__\n    self.prefetch()\n  File "/usr/local/lib/python3.11/site-packages/pytube/__main__.py", line 181, in prefetch\n    self.vid_info_raw = request.get(self.vid_info_url)\n                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/pytube/request.py", line 36, in get\n    return _execute_request(url).read().decode("utf-8")\n           ^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/pytube/request.py", line 24, in _execute_request\n    return urlopen(request)  # nosec\n           ^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/urllib/request.py", line 216, in urlopen\n    return opener.open(url, data, timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/urllib/request.py", line 525, in open\n    response = meth(req, response)\n               ^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/urllib/request.py", line 634, in http_response\n    response = self.parent.error(\n               ^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/urllib/request.py", line 557, in error\n    result = self._call_chain(*args)\n             ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/urllib/request.py", line 496, in _call_chain\n    result = func(*args)\n             ^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/urllib/request.py", line 749, in http_error_302\n    return self.parent.open(new, timeout=req.timeout)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/urllib/request.py", line 525, in open\n    response = meth(req, response)\n               ^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/urllib/request.py", line 634, in http_response\n    response = self.parent.error(\n               ^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/urllib/request.py", line 563, in error\n    return self._call_chain(*args)\n           ^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/urllib/request.py", line 496, in _call_chain\n    result = func(*args)\n             ^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/urllib/request.py", line 643, in http_error_default\n    raise HTTPError(req.full_url, code, msg, hdrs, fp)\nurllib.error.HTTPError: HTTP Error 410: Gone\n', 'args': "['https://www.youtube.com/watch?v=Eav52-foa5A']", 'kwargs': '{}', 'description': 'raised unexpected', 'internal': False}
[2024-05-14 11:51:15,967: INFO/MainProcess] Task create_task[98d7f810-e168-4d92-857d-5921713680ec] received
[2024-05-14 11:51:15,970: WARNING/ForkPoolWorker-1] create_task3
[2024-05-14 11:51:18,972: INFO/ForkPoolWorker-1] Task create_task[98d7f810-e168-4d92-857d-5921713680ec] succeeded in 3.002060672999505s: True
[2024-05-16 10:21:45,084: INFO/MainProcess] Connected to redis://redis:6379/0
[2024-05-16 10:21:45,091: INFO/MainProcess] mingle: searching for neighbors
[2024-05-16 10:21:46,102: INFO/MainProcess] mingle: all alone
[2024-05-16 10:21:46,116: INFO/MainProcess] celery@b3dfad248726 ready.
[2024-05-16 10:21:49,398: INFO/MainProcess] Events of group {task} enabled by remote.
[2024-05-16 14:43:39,019: INFO/MainProcess] Task download_stream_url[c9988d34-ff93-4ddc-bc9f-a4884887b32c] received
[2024-05-16 14:43:39,023: WARNING/ForkPoolWorker-1] Recording video... https://live-wuxi.cgtn.com/live/wx_cgtn_1000k_internalnormal.m3u8
[2024-05-16 14:43:39,070: WARNING/ForkPoolWorker-1] --- Logging error ---
[2024-05-16 14:43:39,074: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 14:43:39,075: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2024-05-16 14:43:39,075: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 14:43:39,076: WARNING/ForkPoolWorker-1]   File "/usr/src/app/worker.py", line 77, in download_stream_url
    while total_duration < recording_duration:
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 14:43:39,076: WARNING/ForkPoolWorker-1] TypeError: '<' not supported between instances of 'float' and 'str'
[2024-05-16 14:43:39,076: WARNING/ForkPoolWorker-1] 
During handling of the above exception, another exception occurred:
[2024-05-16 14:43:39,077: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 14:43:39,078: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2024-05-16 14:43:39,078: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2024-05-16 14:43:39,078: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 14:43:39,078: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 14:43:39,079: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 14:43:39,079: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2024-05-16 14:43:39,080: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 14:43:39,080: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 14:43:39,080: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2024-05-16 14:43:39,080: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 14:43:39,081: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2024-05-16 14:43:39,081: WARNING/ForkPoolWorker-1] AttributeError: '_Code' object has no attribute 'co_positions'
[2024-05-16 14:43:39,081: WARNING/ForkPoolWorker-1] Call stack:
[2024-05-16 14:43:39,084: WARNING/ForkPoolWorker-1]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2024-05-16 14:43:39,086: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2024-05-16 14:43:39,087: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2024-05-16 14:43:39,087: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2024-05-16 14:43:39,088: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2024-05-16 14:43:39,089: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2024-05-16 14:43:39,089: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2024-05-16 14:43:39,090: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2024-05-16 14:43:39,090: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2024-05-16 14:43:39,090: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2024-05-16 14:43:39,091: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2024-05-16 14:43:39,091: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2024-05-16 14:43:39,091: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2024-05-16 14:43:39,092: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2024-05-16 14:43:39,092: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2024-05-16 14:43:39,092: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2024-05-16 14:43:39,092: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2024-05-16 14:43:39,093: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2024-05-16 14:43:39,093: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2024-05-16 14:43:39,093: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2024-05-16 14:43:39,093: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2024-05-16 14:43:39,094: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2024-05-16 14:43:39,094: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2024-05-16 14:43:39,094: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2024-05-16 14:43:39,094: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2024-05-16 14:43:39,095: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2024-05-16 14:43:39,095: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2024-05-16 14:43:39,095: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2024-05-16 14:43:39,095: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2024-05-16 14:43:39,096: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2024-05-16 14:43:39,096: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2024-05-16 14:43:39,096: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2024-05-16 14:43:39,097: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2024-05-16 14:43:39,097: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2024-05-16 14:43:39,097: WARNING/ForkPoolWorker-1] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@b3dfad248726', 'id': 'c9988d34-ff93-4ddc-bc9f-a4884887b32c', 'name': 'download_stream_url', 'exc': 'TypeError("\'<\' not supported between instances of \'float\' and \'str\'")', 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 77, in download_stream_url\n    while total_duration < recording_duration:\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nTypeError: \'<\' not supported between instances of \'float\' and \'str\'\n', 'args': '[]', 'kwargs': "{'playlist_url': '', 'recording_duration': '', 'max_fragment_duration': ''}", 'description': 'raised unexpected', 'internal': False}
[2024-05-16 14:52:44,708: INFO/MainProcess] Task download_stream_url[161b926f-25ed-40ce-93a1-80635180013e] received
[2024-05-16 14:52:44,716: WARNING/ForkPoolWorker-1] Recording video... https://live-wuxi.cgtn.com/live/wx_cgtn_1000k_internalnormal.m3u8
[2024-05-16 14:52:44,717: WARNING/ForkPoolWorker-1] load m3u8..
[2024-05-16 14:52:46,717: WARNING/ForkPoolWorker-1]  Recording fragment 1 segment 1...
[2024-05-16 14:52:46,721: WARNING/ForkPoolWorker-1] --- Logging error ---
[2024-05-16 14:52:46,723: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 14:52:46,724: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2024-05-16 14:52:46,724: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 14:52:46,725: WARNING/ForkPoolWorker-1]   File "/usr/src/app/worker.py", line 117, in download_stream_url
    with open(fragment_filename, "ab") as f:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 14:52:46,726: WARNING/ForkPoolWorker-1] FileNotFoundError: [Errno 2] No such file or directory: 'project/downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715871123799-1.ts'
[2024-05-16 14:52:46,726: WARNING/ForkPoolWorker-1] 
During handling of the above exception, another exception occurred:
[2024-05-16 14:52:46,727: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 14:52:46,728: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2024-05-16 14:52:46,728: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2024-05-16 14:52:46,729: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 14:52:46,729: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 14:52:46,730: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 14:52:46,731: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2024-05-16 14:52:46,731: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 14:52:46,732: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 14:52:46,733: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2024-05-16 14:52:46,733: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 14:52:46,734: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2024-05-16 14:52:46,735: WARNING/ForkPoolWorker-1] AttributeError: '_Code' object has no attribute 'co_positions'
[2024-05-16 14:52:46,735: WARNING/ForkPoolWorker-1] Call stack:
[2024-05-16 14:52:46,736: WARNING/ForkPoolWorker-1]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2024-05-16 14:52:46,737: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2024-05-16 14:52:46,738: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2024-05-16 14:52:46,738: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2024-05-16 14:52:46,739: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2024-05-16 14:52:46,739: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2024-05-16 14:52:46,740: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2024-05-16 14:52:46,741: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2024-05-16 14:52:46,741: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2024-05-16 14:52:46,742: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2024-05-16 14:52:46,742: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2024-05-16 14:52:46,743: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2024-05-16 14:52:46,743: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2024-05-16 14:52:46,744: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2024-05-16 14:52:46,745: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2024-05-16 14:52:46,745: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2024-05-16 14:52:46,746: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2024-05-16 14:52:46,746: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2024-05-16 14:52:46,747: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2024-05-16 14:52:46,747: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2024-05-16 14:52:46,748: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2024-05-16 14:52:46,748: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2024-05-16 14:52:46,749: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2024-05-16 14:52:46,749: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2024-05-16 14:52:46,750: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2024-05-16 14:52:46,750: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2024-05-16 14:52:46,751: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2024-05-16 14:52:46,751: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2024-05-16 14:52:46,751: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2024-05-16 14:52:46,752: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2024-05-16 14:52:46,752: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2024-05-16 14:52:46,753: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2024-05-16 14:52:46,753: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2024-05-16 14:52:46,754: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2024-05-16 14:52:46,754: WARNING/ForkPoolWorker-1] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@b3dfad248726', 'id': '161b926f-25ed-40ce-93a1-80635180013e', 'name': 'download_stream_url', 'exc': "FileNotFoundError(2, 'No such file or directory')", 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 117, in download_stream_url\n    with open(fragment_filename, "ab") as f:\n         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nFileNotFoundError: [Errno 2] No such file or directory: \'project/downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715871123799-1.ts\'\n', 'args': '[]', 'kwargs': '{}', 'description': 'raised unexpected', 'internal': False}
[2024-05-16 15:00:36,283: INFO/MainProcess] Connected to redis://redis:6379/0
[2024-05-16 15:00:36,287: INFO/MainProcess] mingle: searching for neighbors
[2024-05-16 15:00:37,296: INFO/MainProcess] mingle: all alone
[2024-05-16 15:00:37,310: INFO/MainProcess] celery@0a4a44dea96b ready.
[2024-05-16 15:00:41,458: INFO/MainProcess] Events of group {task} enabled by remote.
[2024-05-16 15:00:44,521: INFO/MainProcess] Task download_stream_url[e0c0e8c4-ded7-4a4a-a66d-2d030dc23bb4] received
[2024-05-16 15:00:44,524: WARNING/ForkPoolWorker-1] Recording video... https://live-wuxi.cgtn.com/live/wx_cgtn_1000k_internalnormal.m3u8
[2024-05-16 15:00:44,530: WARNING/ForkPoolWorker-1] load m3u8..
[2024-05-16 15:00:47,049: WARNING/ForkPoolWorker-1]  Recording fragment 1 segment 1...
[2024-05-16 15:00:47,059: WARNING/ForkPoolWorker-1] --- Logging error ---
[2024-05-16 15:00:47,063: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 15:00:47,064: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:00:47,064: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:00:47,065: WARNING/ForkPoolWorker-1]   File "/usr/src/app/worker.py", line 117, in download_stream_url
    with open(fragment_filename, "ab") as f:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:00:47,066: WARNING/ForkPoolWorker-1] FileNotFoundError: [Errno 2] No such file or directory: 'project/downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715871603767-1.ts'
[2024-05-16 15:00:47,067: WARNING/ForkPoolWorker-1] 
During handling of the above exception, another exception occurred:
[2024-05-16 15:00:47,067: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 15:00:47,069: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:00:47,069: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2024-05-16 15:00:47,070: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:00:47,071: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:00:47,071: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:00:47,072: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2024-05-16 15:00:47,073: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:00:47,073: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:00:47,074: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2024-05-16 15:00:47,075: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:00:47,075: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2024-05-16 15:00:47,076: WARNING/ForkPoolWorker-1] AttributeError: '_Code' object has no attribute 'co_positions'
[2024-05-16 15:00:47,077: WARNING/ForkPoolWorker-1] Call stack:
[2024-05-16 15:00:47,080: WARNING/ForkPoolWorker-1]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2024-05-16 15:00:47,081: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2024-05-16 15:00:47,081: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2024-05-16 15:00:47,082: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2024-05-16 15:00:47,082: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2024-05-16 15:00:47,083: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2024-05-16 15:00:47,084: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2024-05-16 15:00:47,084: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2024-05-16 15:00:47,085: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2024-05-16 15:00:47,085: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2024-05-16 15:00:47,086: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2024-05-16 15:00:47,086: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2024-05-16 15:00:47,087: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2024-05-16 15:00:47,087: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2024-05-16 15:00:47,088: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2024-05-16 15:00:47,088: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2024-05-16 15:00:47,089: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2024-05-16 15:00:47,089: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2024-05-16 15:00:47,090: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2024-05-16 15:00:47,091: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2024-05-16 15:00:47,091: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2024-05-16 15:00:47,092: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2024-05-16 15:00:47,093: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2024-05-16 15:00:47,093: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2024-05-16 15:00:47,094: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2024-05-16 15:00:47,094: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2024-05-16 15:00:47,095: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2024-05-16 15:00:47,095: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2024-05-16 15:00:47,096: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2024-05-16 15:00:47,097: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2024-05-16 15:00:47,097: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2024-05-16 15:00:47,098: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2024-05-16 15:00:47,099: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2024-05-16 15:00:47,099: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2024-05-16 15:00:47,100: WARNING/ForkPoolWorker-1] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@0a4a44dea96b', 'id': 'e0c0e8c4-ded7-4a4a-a66d-2d030dc23bb4', 'name': 'download_stream_url', 'exc': "FileNotFoundError(2, 'No such file or directory')", 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 117, in download_stream_url\n    with open(fragment_filename, "ab") as f:\n         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nFileNotFoundError: [Errno 2] No such file or directory: \'project/downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715871603767-1.ts\'\n', 'args': '[]', 'kwargs': '{}', 'description': 'raised unexpected', 'internal': False}
[2024-05-16 15:02:28,860: INFO/MainProcess] Connected to redis://redis:6379/0
[2024-05-16 15:02:28,900: INFO/MainProcess] mingle: searching for neighbors
[2024-05-16 15:02:29,921: INFO/MainProcess] mingle: all alone
[2024-05-16 15:02:29,961: INFO/MainProcess] celery@7b2c8e153408 ready.
[2024-05-16 15:02:34,744: INFO/MainProcess] Events of group {task} enabled by remote.
[2024-05-16 15:02:36,658: INFO/MainProcess] Task download_stream_url[de7e2149-bf80-488f-bc19-65832914c19c] received
[2024-05-16 15:02:36,661: WARNING/ForkPoolWorker-1] Recording video... https://live-wuxi.cgtn.com/live/wx_cgtn_1000k_internalnormal.m3u8
[2024-05-16 15:02:36,666: WARNING/ForkPoolWorker-1] load m3u8..
[2024-05-16 15:02:39,628: WARNING/ForkPoolWorker-1]  Recording fragment 1 segment 1...
[2024-05-16 15:02:39,677: WARNING/ForkPoolWorker-1] --- Logging error ---
[2024-05-16 15:02:39,685: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 15:02:39,689: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:02:39,697: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:02:39,699: WARNING/ForkPoolWorker-1]   File "/usr/src/app/worker.py", line 117, in download_stream_url
    with open(fragment_filename, "ab") as f:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:02:39,700: WARNING/ForkPoolWorker-1] FileNotFoundError: [Errno 2] No such file or directory: 'project/downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715871717864-1.ts'
[2024-05-16 15:02:39,701: WARNING/ForkPoolWorker-1] 
During handling of the above exception, another exception occurred:
[2024-05-16 15:02:39,701: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 15:02:39,706: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:02:39,709: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2024-05-16 15:02:39,719: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:02:39,725: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:02:39,734: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:02:39,735: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2024-05-16 15:02:39,744: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:02:39,747: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:02:39,750: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2024-05-16 15:02:39,755: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:02:39,757: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2024-05-16 15:02:39,758: WARNING/ForkPoolWorker-1] AttributeError: '_Code' object has no attribute 'co_positions'
[2024-05-16 15:02:39,760: WARNING/ForkPoolWorker-1] Call stack:
[2024-05-16 15:02:39,763: WARNING/ForkPoolWorker-1]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2024-05-16 15:02:39,767: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2024-05-16 15:02:39,770: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2024-05-16 15:02:39,774: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2024-05-16 15:02:39,776: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2024-05-16 15:02:39,781: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2024-05-16 15:02:39,785: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2024-05-16 15:02:39,793: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2024-05-16 15:02:39,793: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2024-05-16 15:02:39,797: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2024-05-16 15:02:39,797: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2024-05-16 15:02:39,797: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2024-05-16 15:02:39,798: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2024-05-16 15:02:39,798: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2024-05-16 15:02:39,799: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2024-05-16 15:02:39,799: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2024-05-16 15:02:39,799: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2024-05-16 15:02:39,800: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2024-05-16 15:02:39,800: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2024-05-16 15:02:39,800: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2024-05-16 15:02:39,801: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2024-05-16 15:02:39,801: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2024-05-16 15:02:39,802: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2024-05-16 15:02:39,802: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2024-05-16 15:02:39,803: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2024-05-16 15:02:39,804: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2024-05-16 15:02:39,810: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2024-05-16 15:02:39,813: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2024-05-16 15:02:39,819: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2024-05-16 15:02:39,822: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2024-05-16 15:02:39,823: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2024-05-16 15:02:39,824: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2024-05-16 15:02:39,825: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2024-05-16 15:02:39,827: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2024-05-16 15:02:39,843: WARNING/ForkPoolWorker-1] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@7b2c8e153408', 'id': 'de7e2149-bf80-488f-bc19-65832914c19c', 'name': 'download_stream_url', 'exc': "FileNotFoundError(2, 'No such file or directory')", 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 117, in download_stream_url\n    with open(fragment_filename, "ab") as f:\n         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nFileNotFoundError: [Errno 2] No such file or directory: \'project/downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715871717864-1.ts\'\n', 'args': '[]', 'kwargs': '{}', 'description': 'raised unexpected', 'internal': False}
[2024-05-16 15:09:06,690: WARNING/MainProcess] consumer: Connection to broker lost. Trying to re-establish the connection...
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/celery/worker/consumer/consumer.py", line 332, in start
    blueprint.start(self)
  File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
  File "/usr/local/lib/python3.11/site-packages/celery/worker/consumer/consumer.py", line 628, in start
    c.loop(*c.loop_args())
  File "/usr/local/lib/python3.11/site-packages/celery/worker/loops.py", line 97, in asynloop
    next(loop)
  File "/usr/local/lib/python3.11/site-packages/kombu/asynchronous/hub.py", line 373, in create_loop
    cb(*cbargs)
  File "/usr/local/lib/python3.11/site-packages/kombu/transport/redis.py", line 1344, in on_readable
    self.cycle.on_readable(fileno)
  File "/usr/local/lib/python3.11/site-packages/kombu/transport/redis.py", line 569, in on_readable
    chan.handlers[type]()
  File "/usr/local/lib/python3.11/site-packages/kombu/transport/redis.py", line 913, in _receive
    ret.append(self._receive_one(c))
               ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/kombu/transport/redis.py", line 923, in _receive_one
    response = c.parse_response()
               ^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/redis/client.py", line 1531, in parse_response
    response = self._execute(conn, try_read)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/redis/client.py", line 1507, in _execute
    return conn.retry.call_with_retry(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/redis/retry.py", line 49, in call_with_retry
    fail(error)
  File "/usr/local/lib/python3.11/site-packages/redis/client.py", line 1509, in <lambda>
    lambda error: self._disconnect_raise_connect(conn, error),
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/redis/client.py", line 1496, in _disconnect_raise_connect
    raise error
  File "/usr/local/lib/python3.11/site-packages/redis/retry.py", line 46, in call_with_retry
    return do()
           ^^^^
  File "/usr/local/lib/python3.11/site-packages/redis/client.py", line 1508, in <lambda>
    lambda: command(*args, **kwargs),
            ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/redis/client.py", line 1529, in try_read
    return conn.read_response()
           ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/redis/connection.py", line 865, in read_response
    response = self._parser.read_response(disable_decoding=disable_decoding)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/redis/connection.py", line 346, in read_response
    result = self._read_response(disable_decoding=disable_decoding)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/redis/connection.py", line 356, in _read_response
    raw = self._buffer.readline()
          ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/redis/connection.py", line 259, in readline
    self._read_from_socket()
  File "/usr/local/lib/python3.11/site-packages/redis/connection.py", line 212, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
[2024-05-16 15:34:44,005: INFO/MainProcess] Connected to redis://redis:6379/0
[2024-05-16 15:34:44,022: INFO/MainProcess] mingle: searching for neighbors
[2024-05-16 15:34:45,074: INFO/MainProcess] mingle: all alone
[2024-05-16 15:34:45,093: INFO/MainProcess] celery@b425650180b2 ready.
[2024-05-16 15:34:49,592: INFO/MainProcess] Events of group {task} enabled by remote.
[2024-05-16 15:34:59,740: INFO/MainProcess] Task download_stream_url[98c44172-7ce4-49c5-863d-8511e9044211] received
[2024-05-16 15:34:59,751: WARNING/ForkPoolWorker-1] Recording video... https://live-wuxi.cgtn.com/live/wx_cgtn_1000k_internalnormal.m3u8
[2024-05-16 15:34:59,752: WARNING/ForkPoolWorker-1] load m3u8..
[2024-05-16 15:35:01,530: WARNING/ForkPoolWorker-1]  Recording fragment 1 segment 1...
[2024-05-16 15:35:01,540: WARNING/ForkPoolWorker-1] --- Logging error ---
[2024-05-16 15:35:01,549: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 15:35:01,550: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:35:01,551: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:35:01,552: WARNING/ForkPoolWorker-1]   File "/usr/src/app/worker.py", line 117, in download_stream_url
    with open(fragment_filename, "ab") as f:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:35:01,553: WARNING/ForkPoolWorker-1] FileNotFoundError: [Errno 2] No such file or directory: 'project/downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715873655816-1.ts'
[2024-05-16 15:35:01,553: WARNING/ForkPoolWorker-1] 
During handling of the above exception, another exception occurred:
[2024-05-16 15:35:01,554: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 15:35:01,555: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:35:01,556: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2024-05-16 15:35:01,556: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:35:01,557: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:35:01,557: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:35:01,558: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2024-05-16 15:35:01,558: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:35:01,559: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:35:01,559: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2024-05-16 15:35:01,560: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:35:01,560: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2024-05-16 15:35:01,561: WARNING/ForkPoolWorker-1] AttributeError: '_Code' object has no attribute 'co_positions'
[2024-05-16 15:35:01,562: WARNING/ForkPoolWorker-1] Call stack:
[2024-05-16 15:35:01,565: WARNING/ForkPoolWorker-1]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2024-05-16 15:35:01,566: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2024-05-16 15:35:01,566: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2024-05-16 15:35:01,567: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2024-05-16 15:35:01,567: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2024-05-16 15:35:01,568: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2024-05-16 15:35:01,569: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2024-05-16 15:35:01,569: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2024-05-16 15:35:01,570: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2024-05-16 15:35:01,571: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2024-05-16 15:35:01,571: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2024-05-16 15:35:01,572: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2024-05-16 15:35:01,573: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2024-05-16 15:35:01,576: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2024-05-16 15:35:01,577: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2024-05-16 15:35:01,577: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2024-05-16 15:35:01,578: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2024-05-16 15:35:01,579: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2024-05-16 15:35:01,580: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2024-05-16 15:35:01,580: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2024-05-16 15:35:01,581: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2024-05-16 15:35:01,582: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2024-05-16 15:35:01,582: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2024-05-16 15:35:01,583: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2024-05-16 15:35:01,584: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2024-05-16 15:35:01,584: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2024-05-16 15:35:01,585: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2024-05-16 15:35:01,585: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2024-05-16 15:35:01,586: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2024-05-16 15:35:01,587: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2024-05-16 15:35:01,587: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2024-05-16 15:35:01,588: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2024-05-16 15:35:01,588: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2024-05-16 15:35:01,589: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2024-05-16 15:35:01,589: WARNING/ForkPoolWorker-1] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@b425650180b2', 'id': '98c44172-7ce4-49c5-863d-8511e9044211', 'name': 'download_stream_url', 'exc': "FileNotFoundError(2, 'No such file or directory')", 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 117, in download_stream_url\n    with open(fragment_filename, "ab") as f:\n         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nFileNotFoundError: [Errno 2] No such file or directory: \'project/downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715873655816-1.ts\'\n', 'args': '[]', 'kwargs': '{}', 'description': 'raised unexpected', 'internal': False}
[2024-05-16 15:36:12,306: INFO/MainProcess] Task download_stream_url[c72629f9-ba88-471a-9122-98cc605c38ba] received
[2024-05-16 15:36:12,319: WARNING/ForkPoolWorker-1] Recording video... https://live-wuxi.cgtn.com/live/wx_cgtn_1000k_internalnormal.m3u8
[2024-05-16 15:36:12,324: WARNING/ForkPoolWorker-1] load m3u8..
[2024-05-16 15:36:15,272: WARNING/ForkPoolWorker-1]  Recording fragment 1 segment 1...
[2024-05-16 15:36:15,288: WARNING/ForkPoolWorker-1] --- Logging error ---
[2024-05-16 15:36:15,304: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 15:36:15,305: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:36:15,306: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:36:15,308: WARNING/ForkPoolWorker-1]   File "/usr/src/app/worker.py", line 117, in download_stream_url
    with open(fragment_filename, "ab") as f:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:36:15,309: WARNING/ForkPoolWorker-1] FileNotFoundError: [Errno 2] No such file or directory: 'project/downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715873733807-1.ts'
[2024-05-16 15:36:15,310: WARNING/ForkPoolWorker-1] 
During handling of the above exception, another exception occurred:
[2024-05-16 15:36:15,311: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 15:36:15,313: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:36:15,314: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2024-05-16 15:36:15,315: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:36:15,322: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:36:15,327: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:36:15,329: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2024-05-16 15:36:15,349: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:36:15,364: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:36:15,380: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2024-05-16 15:36:15,395: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:36:15,396: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2024-05-16 15:36:15,396: WARNING/ForkPoolWorker-1] AttributeError: '_Code' object has no attribute 'co_positions'
[2024-05-16 15:36:15,401: WARNING/ForkPoolWorker-1] Call stack:
[2024-05-16 15:36:15,413: WARNING/ForkPoolWorker-1]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2024-05-16 15:36:15,417: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2024-05-16 15:36:15,418: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2024-05-16 15:36:15,419: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2024-05-16 15:36:15,420: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2024-05-16 15:36:15,420: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2024-05-16 15:36:15,421: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2024-05-16 15:36:15,421: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2024-05-16 15:36:15,422: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2024-05-16 15:36:15,422: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2024-05-16 15:36:15,423: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2024-05-16 15:36:15,423: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2024-05-16 15:36:15,424: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2024-05-16 15:36:15,425: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2024-05-16 15:36:15,426: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2024-05-16 15:36:15,431: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2024-05-16 15:36:15,436: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2024-05-16 15:36:15,444: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2024-05-16 15:36:15,462: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2024-05-16 15:36:15,468: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2024-05-16 15:36:15,471: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2024-05-16 15:36:15,479: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2024-05-16 15:36:15,483: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2024-05-16 15:36:15,494: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2024-05-16 15:36:15,495: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2024-05-16 15:36:15,495: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2024-05-16 15:36:15,495: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2024-05-16 15:36:15,496: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2024-05-16 15:36:15,498: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2024-05-16 15:36:15,499: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2024-05-16 15:36:15,500: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2024-05-16 15:36:15,501: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2024-05-16 15:36:15,503: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2024-05-16 15:36:15,505: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2024-05-16 15:36:15,506: WARNING/ForkPoolWorker-1] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@b425650180b2', 'id': 'c72629f9-ba88-471a-9122-98cc605c38ba', 'name': 'download_stream_url', 'exc': "FileNotFoundError(2, 'No such file or directory')", 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 117, in download_stream_url\n    with open(fragment_filename, "ab") as f:\n         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nFileNotFoundError: [Errno 2] No such file or directory: \'project/downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715873733807-1.ts\'\n', 'args': '[]', 'kwargs': '{}', 'description': 'raised unexpected', 'internal': False}
[2024-05-16 15:36:41,477: INFO/MainProcess] Task download_stream_url[46c4f904-e6b2-41c6-83fd-5ad2da2c7949] received
[2024-05-16 15:36:41,488: WARNING/ForkPoolWorker-1] Recording video... https://live-wuxi.cgtn.com/live/wx_cgtn_1000k_internalnormal.m3u8
[2024-05-16 15:36:41,488: WARNING/ForkPoolWorker-1] load m3u8..
[2024-05-16 15:36:43,189: WARNING/ForkPoolWorker-1]  Recording fragment 1 segment 1...
[2024-05-16 15:36:43,196: WARNING/ForkPoolWorker-1] --- Logging error ---
[2024-05-16 15:36:43,198: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 15:36:43,199: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:36:43,199: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:36:43,200: WARNING/ForkPoolWorker-1]   File "/usr/src/app/worker.py", line 117, in download_stream_url
    with open(fragment_filename, "ab") as f:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:36:43,200: WARNING/ForkPoolWorker-1] FileNotFoundError: [Errno 2] No such file or directory: 'project/downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715873763814-1.ts'
[2024-05-16 15:36:43,201: WARNING/ForkPoolWorker-1] 
During handling of the above exception, another exception occurred:
[2024-05-16 15:36:43,202: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 15:36:43,202: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:36:43,203: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2024-05-16 15:36:43,203: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:36:43,204: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:36:43,204: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:36:43,204: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2024-05-16 15:36:43,205: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:36:43,205: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:36:43,206: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2024-05-16 15:36:43,206: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:36:43,206: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2024-05-16 15:36:43,207: WARNING/ForkPoolWorker-1] AttributeError: '_Code' object has no attribute 'co_positions'
[2024-05-16 15:36:43,210: WARNING/ForkPoolWorker-1] Call stack:
[2024-05-16 15:36:43,210: WARNING/ForkPoolWorker-1]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2024-05-16 15:36:43,211: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2024-05-16 15:36:43,211: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2024-05-16 15:36:43,212: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2024-05-16 15:36:43,212: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2024-05-16 15:36:43,212: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2024-05-16 15:36:43,213: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2024-05-16 15:36:43,213: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2024-05-16 15:36:43,214: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2024-05-16 15:36:43,215: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2024-05-16 15:36:43,215: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2024-05-16 15:36:43,216: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2024-05-16 15:36:43,216: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2024-05-16 15:36:43,216: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2024-05-16 15:36:43,217: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2024-05-16 15:36:43,217: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2024-05-16 15:36:43,217: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2024-05-16 15:36:43,218: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2024-05-16 15:36:43,218: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2024-05-16 15:36:43,219: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2024-05-16 15:36:43,219: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2024-05-16 15:36:43,219: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2024-05-16 15:36:43,220: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2024-05-16 15:36:43,220: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2024-05-16 15:36:43,220: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2024-05-16 15:36:43,221: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2024-05-16 15:36:43,221: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2024-05-16 15:36:43,222: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2024-05-16 15:36:43,222: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2024-05-16 15:36:43,223: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2024-05-16 15:36:43,223: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2024-05-16 15:36:43,223: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2024-05-16 15:36:43,224: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2024-05-16 15:36:43,224: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2024-05-16 15:36:43,224: WARNING/ForkPoolWorker-1] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@b425650180b2', 'id': '46c4f904-e6b2-41c6-83fd-5ad2da2c7949', 'name': 'download_stream_url', 'exc': "FileNotFoundError(2, 'No such file or directory')", 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 117, in download_stream_url\n    with open(fragment_filename, "ab") as f:\n         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nFileNotFoundError: [Errno 2] No such file or directory: \'project/downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715873763814-1.ts\'\n', 'args': '[]', 'kwargs': '{}', 'description': 'raised unexpected', 'internal': False}
[2024-05-16 15:37:17,167: INFO/MainProcess] Task download_stream_url[8e6297ed-97c8-44c0-b65f-61bedc184fe9] received
[2024-05-16 15:37:17,173: WARNING/ForkPoolWorker-1] Recording video... https://live-wuxi.cgtn.com/live/wx_cgtn_1000k_internalnormal.m3u8
[2024-05-16 15:37:17,175: WARNING/ForkPoolWorker-1] load m3u8..
[2024-05-16 15:37:20,225: WARNING/ForkPoolWorker-1]  Recording fragment 1 segment 1...
[2024-05-16 15:37:20,229: WARNING/ForkPoolWorker-1] --- Logging error ---
[2024-05-16 15:37:20,232: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 15:37:20,232: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:37:20,233: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:37:20,234: WARNING/ForkPoolWorker-1]   File "/usr/src/app/worker.py", line 117, in download_stream_url
    with open(fragment_filename, "ab") as f:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:37:20,234: WARNING/ForkPoolWorker-1] FileNotFoundError: [Errno 2] No such file or directory: 'project/downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715873799789-1.ts'
[2024-05-16 15:37:20,234: WARNING/ForkPoolWorker-1] 
During handling of the above exception, another exception occurred:
[2024-05-16 15:37:20,235: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 15:37:20,236: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:37:20,236: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2024-05-16 15:37:20,236: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:37:20,237: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:37:20,237: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:37:20,237: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2024-05-16 15:37:20,238: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:37:20,238: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:37:20,239: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2024-05-16 15:37:20,239: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:37:20,239: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2024-05-16 15:37:20,240: WARNING/ForkPoolWorker-1] AttributeError: '_Code' object has no attribute 'co_positions'
[2024-05-16 15:37:20,240: WARNING/ForkPoolWorker-1] Call stack:
[2024-05-16 15:37:20,241: WARNING/ForkPoolWorker-1]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2024-05-16 15:37:20,241: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2024-05-16 15:37:20,241: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2024-05-16 15:37:20,242: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2024-05-16 15:37:20,242: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2024-05-16 15:37:20,242: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2024-05-16 15:37:20,243: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2024-05-16 15:37:20,243: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2024-05-16 15:37:20,243: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2024-05-16 15:37:20,243: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2024-05-16 15:37:20,244: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2024-05-16 15:37:20,244: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2024-05-16 15:37:20,244: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2024-05-16 15:37:20,244: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2024-05-16 15:37:20,245: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2024-05-16 15:37:20,245: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2024-05-16 15:37:20,247: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2024-05-16 15:37:20,247: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2024-05-16 15:37:20,248: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2024-05-16 15:37:20,248: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2024-05-16 15:37:20,248: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2024-05-16 15:37:20,249: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2024-05-16 15:37:20,249: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2024-05-16 15:37:20,249: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2024-05-16 15:37:20,250: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2024-05-16 15:37:20,253: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2024-05-16 15:37:20,253: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2024-05-16 15:37:20,254: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2024-05-16 15:37:20,254: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2024-05-16 15:37:20,254: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2024-05-16 15:37:20,254: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2024-05-16 15:37:20,255: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2024-05-16 15:37:20,255: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2024-05-16 15:37:20,255: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2024-05-16 15:37:20,256: WARNING/ForkPoolWorker-1] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@b425650180b2', 'id': '8e6297ed-97c8-44c0-b65f-61bedc184fe9', 'name': 'download_stream_url', 'exc': "FileNotFoundError(2, 'No such file or directory')", 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 117, in download_stream_url\n    with open(fragment_filename, "ab") as f:\n         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nFileNotFoundError: [Errno 2] No such file or directory: \'project/downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715873799789-1.ts\'\n', 'args': '[]', 'kwargs': '{}', 'description': 'raised unexpected', 'internal': False}
[2024-05-16 15:37:49,406: INFO/MainProcess] Task download_stream_url[50d36190-03cc-4955-af72-207abdc5636f] received
[2024-05-16 15:37:49,418: WARNING/ForkPoolWorker-1] Recording video... https://live-wuxi.cgtn.com/live/wx_cgtn_1000k_internalnormal.m3u8
[2024-05-16 15:37:49,443: WARNING/ForkPoolWorker-1] load m3u8..
[2024-05-16 15:37:51,788: WARNING/ForkPoolWorker-1]  Recording fragment 1 segment 1...
[2024-05-16 15:37:51,798: WARNING/ForkPoolWorker-1] --- Logging error ---
[2024-05-16 15:37:51,799: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 15:37:51,800: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:37:51,800: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:37:51,801: WARNING/ForkPoolWorker-1]   File "/usr/src/app/worker.py", line 117, in download_stream_url
    with open(fragment_filename, "ab") as f:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:37:51,801: WARNING/ForkPoolWorker-1] FileNotFoundError: [Errno 2] No such file or directory: 'project/downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715873829914-1.ts'
[2024-05-16 15:37:51,802: WARNING/ForkPoolWorker-1] 
During handling of the above exception, another exception occurred:
[2024-05-16 15:37:51,802: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 15:37:51,803: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:37:51,803: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2024-05-16 15:37:51,803: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:37:51,804: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:37:51,804: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:37:51,805: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2024-05-16 15:37:51,805: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:37:51,806: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:37:51,807: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2024-05-16 15:37:51,807: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:37:51,807: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2024-05-16 15:37:51,808: WARNING/ForkPoolWorker-1] AttributeError: '_Code' object has no attribute 'co_positions'
[2024-05-16 15:37:51,808: WARNING/ForkPoolWorker-1] Call stack:
[2024-05-16 15:37:51,809: WARNING/ForkPoolWorker-1]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2024-05-16 15:37:51,810: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2024-05-16 15:37:51,810: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2024-05-16 15:37:51,810: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2024-05-16 15:37:51,811: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2024-05-16 15:37:51,811: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2024-05-16 15:37:51,812: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2024-05-16 15:37:51,812: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2024-05-16 15:37:51,812: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2024-05-16 15:37:51,813: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2024-05-16 15:37:51,813: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2024-05-16 15:37:51,814: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2024-05-16 15:37:51,814: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2024-05-16 15:37:51,815: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2024-05-16 15:37:51,815: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2024-05-16 15:37:51,815: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2024-05-16 15:37:51,816: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2024-05-16 15:37:51,816: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2024-05-16 15:37:51,816: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2024-05-16 15:37:51,817: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2024-05-16 15:37:51,817: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2024-05-16 15:37:51,818: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2024-05-16 15:37:51,818: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2024-05-16 15:37:51,818: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2024-05-16 15:37:51,819: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2024-05-16 15:37:51,819: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2024-05-16 15:37:51,820: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2024-05-16 15:37:51,820: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2024-05-16 15:37:51,820: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2024-05-16 15:37:51,821: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2024-05-16 15:37:51,822: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2024-05-16 15:37:51,822: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2024-05-16 15:37:51,823: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2024-05-16 15:37:51,823: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2024-05-16 15:37:51,824: WARNING/ForkPoolWorker-1] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@b425650180b2', 'id': '50d36190-03cc-4955-af72-207abdc5636f', 'name': 'download_stream_url', 'exc': "FileNotFoundError(2, 'No such file or directory')", 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 117, in download_stream_url\n    with open(fragment_filename, "ab") as f:\n         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nFileNotFoundError: [Errno 2] No such file or directory: \'project/downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715873829914-1.ts\'\n', 'args': '[]', 'kwargs': '{}', 'description': 'raised unexpected', 'internal': False}
[2024-05-16 15:38:21,263: INFO/MainProcess] Task download_stream_url[546e9cdc-127d-4aa2-8891-cd6230cdbdac] received
[2024-05-16 15:38:21,271: WARNING/ForkPoolWorker-1] Recording video... https://live-wuxi.cgtn.com/live/wx_cgtn_1000k_internalnormal.m3u8
[2024-05-16 15:38:21,274: WARNING/ForkPoolWorker-1] load m3u8..
[2024-05-16 15:38:22,542: WARNING/ForkPoolWorker-1]  Recording fragment 1 segment 1...
[2024-05-16 15:38:22,546: WARNING/ForkPoolWorker-1] --- Logging error ---
[2024-05-16 15:38:22,547: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 15:38:22,548: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:38:22,548: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:38:22,548: WARNING/ForkPoolWorker-1]   File "/usr/src/app/worker.py", line 117, in download_stream_url
    with open(fragment_filename, "ab") as f:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:38:22,549: WARNING/ForkPoolWorker-1] FileNotFoundError: [Errno 2] No such file or directory: 'project/downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715873853920-1.ts'
[2024-05-16 15:38:22,552: WARNING/ForkPoolWorker-1] 
During handling of the above exception, another exception occurred:
[2024-05-16 15:38:22,552: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 15:38:22,553: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:38:22,554: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2024-05-16 15:38:22,554: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:38:22,555: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:38:22,555: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:38:22,555: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2024-05-16 15:38:22,556: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:38:22,556: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:38:22,556: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2024-05-16 15:38:22,557: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:38:22,557: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2024-05-16 15:38:22,557: WARNING/ForkPoolWorker-1] AttributeError: '_Code' object has no attribute 'co_positions'
[2024-05-16 15:38:22,558: WARNING/ForkPoolWorker-1] Call stack:
[2024-05-16 15:38:22,558: WARNING/ForkPoolWorker-1]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2024-05-16 15:38:22,559: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2024-05-16 15:38:22,559: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2024-05-16 15:38:22,560: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2024-05-16 15:38:22,560: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2024-05-16 15:38:22,560: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2024-05-16 15:38:22,560: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2024-05-16 15:38:22,561: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2024-05-16 15:38:22,561: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2024-05-16 15:38:22,561: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2024-05-16 15:38:22,562: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2024-05-16 15:38:22,562: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2024-05-16 15:38:22,562: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2024-05-16 15:38:22,563: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2024-05-16 15:38:22,563: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2024-05-16 15:38:22,563: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2024-05-16 15:38:22,564: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2024-05-16 15:38:22,564: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2024-05-16 15:38:22,564: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2024-05-16 15:38:22,564: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2024-05-16 15:38:22,565: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2024-05-16 15:38:22,565: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2024-05-16 15:38:22,565: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2024-05-16 15:38:22,567: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2024-05-16 15:38:22,568: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2024-05-16 15:38:22,568: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2024-05-16 15:38:22,569: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2024-05-16 15:38:22,569: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2024-05-16 15:38:22,570: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2024-05-16 15:38:22,570: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2024-05-16 15:38:22,571: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2024-05-16 15:38:22,571: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2024-05-16 15:38:22,571: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2024-05-16 15:38:22,572: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2024-05-16 15:38:22,572: WARNING/ForkPoolWorker-1] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@b425650180b2', 'id': '546e9cdc-127d-4aa2-8891-cd6230cdbdac', 'name': 'download_stream_url', 'exc': "FileNotFoundError(2, 'No such file or directory')", 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 117, in download_stream_url\n    with open(fragment_filename, "ab") as f:\n         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nFileNotFoundError: [Errno 2] No such file or directory: \'project/downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715873853920-1.ts\'\n', 'args': '[]', 'kwargs': '{}', 'description': 'raised unexpected', 'internal': False}
[2024-05-16 15:43:58,529: INFO/MainProcess] Connected to redis://redis:6379/0
[2024-05-16 15:43:58,554: INFO/MainProcess] mingle: searching for neighbors
[2024-05-16 15:43:59,584: INFO/MainProcess] mingle: all alone
[2024-05-16 15:43:59,612: INFO/MainProcess] celery@7404f8faa6b2 ready.
[2024-05-16 15:44:04,103: INFO/MainProcess] Events of group {task} enabled by remote.
[2024-05-16 15:44:44,995: INFO/MainProcess] Task download_stream_url[09942dab-d506-49a1-848d-83fe77b170fa] received
[2024-05-16 15:44:45,004: WARNING/ForkPoolWorker-1] Recording video... https://live-wuxi.cgtn.com/live/wx_cgtn_1000k_internalnormal.m3u8
[2024-05-16 15:44:45,005: WARNING/ForkPoolWorker-1] load m3u8..
[2024-05-16 15:44:47,638: WARNING/ForkPoolWorker-1]  Recording fragment 1 segment 1...
[2024-05-16 15:44:47,659: WARNING/ForkPoolWorker-1] --- Logging error ---
[2024-05-16 15:44:47,662: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 15:44:47,662: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:44:47,663: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:44:47,664: WARNING/ForkPoolWorker-1]   File "/usr/src/app/worker.py", line 117, in download_stream_url
    with open(fragment_filename, "ab") as f:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:44:47,665: WARNING/ForkPoolWorker-1] FileNotFoundError: [Errno 2] No such file or directory: 'project/downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715874249794-1.ts'
[2024-05-16 15:44:47,665: WARNING/ForkPoolWorker-1] 
During handling of the above exception, another exception occurred:
[2024-05-16 15:44:47,666: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 15:44:47,667: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:44:47,667: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2024-05-16 15:44:47,668: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:44:47,669: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:44:47,669: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:44:47,670: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2024-05-16 15:44:47,670: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:44:47,671: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:44:47,671: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2024-05-16 15:44:47,672: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:44:47,673: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2024-05-16 15:44:47,673: WARNING/ForkPoolWorker-1] AttributeError: '_Code' object has no attribute 'co_positions'
[2024-05-16 15:44:47,674: WARNING/ForkPoolWorker-1] Call stack:
[2024-05-16 15:44:47,678: WARNING/ForkPoolWorker-1]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2024-05-16 15:44:47,678: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2024-05-16 15:44:47,679: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2024-05-16 15:44:47,680: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2024-05-16 15:44:47,680: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2024-05-16 15:44:47,681: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2024-05-16 15:44:47,681: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2024-05-16 15:44:47,682: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2024-05-16 15:44:47,683: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2024-05-16 15:44:47,683: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2024-05-16 15:44:47,684: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2024-05-16 15:44:47,685: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2024-05-16 15:44:47,686: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2024-05-16 15:44:47,686: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2024-05-16 15:44:47,687: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2024-05-16 15:44:47,688: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2024-05-16 15:44:47,689: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2024-05-16 15:44:47,690: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2024-05-16 15:44:47,690: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2024-05-16 15:44:47,691: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2024-05-16 15:44:47,691: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2024-05-16 15:44:47,692: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2024-05-16 15:44:47,693: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2024-05-16 15:44:47,693: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2024-05-16 15:44:47,694: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2024-05-16 15:44:47,694: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2024-05-16 15:44:47,695: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2024-05-16 15:44:47,695: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2024-05-16 15:44:47,696: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2024-05-16 15:44:47,696: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2024-05-16 15:44:47,697: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2024-05-16 15:44:47,697: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2024-05-16 15:44:47,698: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2024-05-16 15:44:47,698: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2024-05-16 15:44:47,699: WARNING/ForkPoolWorker-1] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@7404f8faa6b2', 'id': '09942dab-d506-49a1-848d-83fe77b170fa', 'name': 'download_stream_url', 'exc': "FileNotFoundError(2, 'No such file or directory')", 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 117, in download_stream_url\n    with open(fragment_filename, "ab") as f:\n         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nFileNotFoundError: [Errno 2] No such file or directory: \'project/downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715874249794-1.ts\'\n', 'args': '[]', 'kwargs': '{}', 'description': 'raised unexpected', 'internal': False}
[2024-05-16 15:49:10,255: INFO/MainProcess] Connected to redis://redis:6379/0
[2024-05-16 15:49:10,258: INFO/MainProcess] mingle: searching for neighbors
[2024-05-16 15:49:11,268: INFO/MainProcess] mingle: all alone
[2024-05-16 15:49:11,284: INFO/MainProcess] celery@247be4a9565c ready.
[2024-05-16 15:49:15,430: INFO/MainProcess] Events of group {task} enabled by remote.
[2024-05-16 15:49:44,074: INFO/MainProcess] Task download_stream_url[5eb0de22-a388-4db6-addd-724ae20dcaa2] received
[2024-05-16 15:49:44,092: WARNING/ForkPoolWorker-1] Recording video... https://live-wuxi.cgtn.com/live/wx_cgtn_1000k_internalnormal.m3u8
[2024-05-16 15:49:44,110: WARNING/ForkPoolWorker-1] load m3u8..
[2024-05-16 15:49:46,735: WARNING/ForkPoolWorker-1]  Recording fragment 1 segment 1...
[2024-05-16 15:49:48,520: WARNING/ForkPoolWorker-1]  Recording fragment 1 segment 2...
[2024-05-16 15:49:50,342: WARNING/ForkPoolWorker-1]  Recording fragment 1 segment 3...
[2024-05-16 15:49:52,114: WARNING/ForkPoolWorker-1]  Recording fragment 1 segment 4...
[2024-05-16 15:49:54,060: WARNING/ForkPoolWorker-1]  Recording fragment 2 segment 5...
[2024-05-16 15:49:55,844: WARNING/ForkPoolWorker-1]  Recording fragment 2 segment 6...
[2024-05-16 15:49:56,721: WARNING/ForkPoolWorker-1] sleep 18.0s
[2024-05-16 15:50:14,722: WARNING/ForkPoolWorker-1] load m3u8..
[2024-05-16 15:50:16,424: WARNING/ForkPoolWorker-1]  Recording fragment 2 segment 7...
[2024-05-16 15:50:18,265: WARNING/ForkPoolWorker-1]  Recording fragment 2 segment 8...
[2024-05-16 15:50:20,465: WARNING/ForkPoolWorker-1]  Recording fragment 3 segment 9...
[2024-05-16 15:50:22,616: WARNING/ForkPoolWorker-1]  Recording fragment 3 segment 10...
[2024-05-16 15:50:24,418: WARNING/ForkPoolWorker-1]  Recording fragment 3 segment 11...
[2024-05-16 15:50:25,337: WARNING/ForkPoolWorker-1] sleep 18.0s
[2024-05-16 15:50:43,338: WARNING/ForkPoolWorker-1]     done: fragment_filename_list ['downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715874543834-1.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715874567811-2.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715874591797-3.ts']
[2024-05-16 15:50:43,351: INFO/MainProcess] Task create_task_list[1b686cff-8a3d-4f50-8ae9-17cab97b8cc7] received
[2024-05-16 15:50:43,353: INFO/ForkPoolWorker-1] Task download_stream_url[5eb0de22-a388-4db6-addd-724ae20dcaa2] succeeded in 59.26359283400234s: ['downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715874543834-1.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715874567811-2.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715874591797-3.ts']
[2024-05-16 15:50:43,363: INFO/MainProcess] Task create_task[d78db3a5-ac79-485c-ab77-a75e724f879c] received
[2024-05-16 15:50:43,366: INFO/MainProcess] Task create_task[8dea0ae6-0dbc-40ce-bd48-0a8cc94dd947] received
[2024-05-16 15:50:43,367: WARNING/ForkPoolWorker-2] create_taskdownloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715874567811-2.ts
[2024-05-16 15:50:43,367: WARNING/ForkPoolWorker-1] create_taskdownloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715874543834-1.ts
[2024-05-16 15:50:43,370: INFO/ForkPoolWorker-1] Task create_task[d78db3a5-ac79-485c-ab77-a75e724f879c] succeeded in 0.0030102139971859287s: True
[2024-05-16 15:50:43,373: INFO/MainProcess] Task create_task[44b46131-4700-49e0-8632-562a5f00ce2e] received
[2024-05-16 15:50:43,373: INFO/ForkPoolWorker-2] Task create_task[8dea0ae6-0dbc-40ce-bd48-0a8cc94dd947] succeeded in 0.005809319998661522s: True
[2024-05-16 15:50:43,375: WARNING/ForkPoolWorker-1] create_taskdownloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715874591797-3.ts
[2024-05-16 15:50:43,376: WARNING/ForkPoolWorker-3] --- Logging error ---
[2024-05-16 15:50:43,377: INFO/ForkPoolWorker-1] Task create_task[44b46131-4700-49e0-8632-562a5f00ce2e] succeeded in 0.0017145650017482694s: True
[2024-05-16 15:50:43,379: WARNING/ForkPoolWorker-3] Traceback (most recent call last):
[2024-05-16 15:50:43,380: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:50:43,380: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:50:43,381: WARNING/ForkPoolWorker-3]   File "/usr/src/app/worker.py", line 188, in create_task_list
[2024-05-16 15:50:43,381: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 677, in get
    return (self.join_native if self.supports_native_join else self.join)(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:50:43,382: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 794, in join_native
    assert_will_not_block()
[2024-05-16 15:50:43,383: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 38, in assert_will_not_block
    raise RuntimeError(E_WOULDBLOCK)
[2024-05-16 15:50:43,383: WARNING/ForkPoolWorker-3] RuntimeError: Never call result.get() within a task!
See http://docs.celeryq.org/en/latest/userguide/tasks.html#task-synchronous-subtasks
[2024-05-16 15:50:43,384: WARNING/ForkPoolWorker-3] 
During handling of the above exception, another exception occurred:
[2024-05-16 15:50:43,384: WARNING/ForkPoolWorker-3] Traceback (most recent call last):
[2024-05-16 15:50:43,385: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:50:43,386: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2024-05-16 15:50:43,386: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:50:43,387: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:50:43,387: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:50:43,388: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2024-05-16 15:50:43,389: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:50:43,389: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:50:43,390: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2024-05-16 15:50:43,390: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 15:50:43,391: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2024-05-16 15:50:43,392: WARNING/ForkPoolWorker-3] AttributeError: '_Code' object has no attribute 'co_positions'
[2024-05-16 15:50:43,392: WARNING/ForkPoolWorker-3] Call stack:
[2024-05-16 15:50:43,395: WARNING/ForkPoolWorker-3]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2024-05-16 15:50:43,395: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2024-05-16 15:50:43,396: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2024-05-16 15:50:43,397: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2024-05-16 15:50:43,397: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2024-05-16 15:50:43,398: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2024-05-16 15:50:43,398: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2024-05-16 15:50:43,399: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2024-05-16 15:50:43,399: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2024-05-16 15:50:43,400: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2024-05-16 15:50:43,400: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2024-05-16 15:50:43,401: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2024-05-16 15:50:43,402: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2024-05-16 15:50:43,402: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2024-05-16 15:50:43,403: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2024-05-16 15:50:43,403: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2024-05-16 15:50:43,404: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2024-05-16 15:50:43,404: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2024-05-16 15:50:43,405: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2024-05-16 15:50:43,406: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2024-05-16 15:50:43,406: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2024-05-16 15:50:43,407: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2024-05-16 15:50:43,407: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2024-05-16 15:50:43,408: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2024-05-16 15:50:43,408: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2024-05-16 15:50:43,409: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2024-05-16 15:50:43,409: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2024-05-16 15:50:43,410: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2024-05-16 15:50:43,411: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2024-05-16 15:50:43,411: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2024-05-16 15:50:43,412: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2024-05-16 15:50:43,412: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2024-05-16 15:50:43,413: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2024-05-16 15:50:43,413: WARNING/ForkPoolWorker-3]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2024-05-16 15:50:43,414: WARNING/ForkPoolWorker-3] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@247be4a9565c', 'id': '1b686cff-8a3d-4f50-8ae9-17cab97b8cc7', 'name': 'create_task_list', 'exc': "RuntimeError('Never call result.get() within a task!\\nSee http://docs.celeryq.org/en/latest/userguide/tasks.html#task-synchronous-subtasks\\n')", 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 188, in create_task_list\n  File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 677, in get\n    return (self.join_native if self.supports_native_join else self.join)(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 794, in join_native\n    assert_will_not_block()\n  File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 38, in assert_will_not_block\n    raise RuntimeError(E_WOULDBLOCK)\nRuntimeError: Never call result.get() within a task!\nSee http://docs.celeryq.org/en/latest/userguide/tasks.html#task-synchronous-subtasks\n\n', 'args': "[['downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715874543834-1.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715874567811-2.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715874591797-3.ts']]", 'kwargs': '{}', 'description': 'raised unexpected', 'internal': False}
[2024-05-16 16:14:06,344: INFO/MainProcess] Task download_stream_url[3a619eb1-ae31-49d3-bc57-1a89cba67748] received
[2024-05-16 16:14:06,354: WARNING/ForkPoolWorker-1] Recording video... https://live-wuxi.cgtn.com/live/wx_cgtn_1000k_internalnormal.m3u8
[2024-05-16 16:14:06,363: WARNING/ForkPoolWorker-1] load m3u8..
[2024-05-16 16:14:09,164: WARNING/ForkPoolWorker-1]  Recording fragment 1 segment 1...
[2024-05-16 16:14:10,940: WARNING/ForkPoolWorker-1]  Recording fragment 2 segment 2...
[2024-05-16 16:14:12,710: WARNING/ForkPoolWorker-1]  Recording fragment 3 segment 3...
[2024-05-16 16:14:14,472: WARNING/ForkPoolWorker-1]  Recording fragment 4 segment 4...
[2024-05-16 16:14:16,284: WARNING/ForkPoolWorker-1]  Recording fragment 5 segment 5...
[2024-05-16 16:14:18,091: WARNING/ForkPoolWorker-1]  Recording fragment 6 segment 6...
[2024-05-16 16:14:18,952: WARNING/ForkPoolWorker-1] sleep 18.0s
[2024-05-16 16:14:36,953: WARNING/ForkPoolWorker-1]     done: fragment_filename_list ['downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876007823-1.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876013898-2.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876019890-3.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876025894-4.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876031869-5.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876037915-6.ts']
[2024-05-16 16:14:36,963: INFO/ForkPoolWorker-1] Task download_stream_url[3a619eb1-ae31-49d3-bc57-1a89cba67748] succeeded in 30.610918354002933s: ['downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876007823-1.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876013898-2.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876019890-3.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876025894-4.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876031869-5.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876037915-6.ts']
[2024-05-16 16:14:36,963: INFO/MainProcess] Task create_task_list[0380b2d7-2c29-4fcf-9010-fad9d78a7fbf] received
[2024-05-16 16:14:36,975: INFO/MainProcess] Task create_task[666fe922-5814-4cf8-831d-96c5360c0bc1] received
[2024-05-16 16:14:36,980: INFO/MainProcess] Task create_task[76abe1f8-f272-4eca-a549-ca09a0ab1f2c] received
[2024-05-16 16:14:36,983: WARNING/ForkPoolWorker-2] create_taskdownloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876013898-2.ts
[2024-05-16 16:14:36,983: WARNING/ForkPoolWorker-3] create_taskdownloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876007823-1.ts
[2024-05-16 16:14:36,988: INFO/ForkPoolWorker-2] Task create_task[76abe1f8-f272-4eca-a549-ca09a0ab1f2c] succeeded in 0.005228169000474736s: True
[2024-05-16 16:14:36,989: INFO/ForkPoolWorker-3] Task create_task[666fe922-5814-4cf8-831d-96c5360c0bc1] succeeded in 0.0070523639988095965s: True
[2024-05-16 16:14:36,992: INFO/MainProcess] Task create_task[c31ab6ff-6b2b-40ca-9962-7a9ae97253e8] received
[2024-05-16 16:14:36,997: INFO/MainProcess] Task create_task[7db38033-f6d7-4780-ad11-05405bf4ec9b] received
[2024-05-16 16:14:37,000: WARNING/ForkPoolWorker-2] create_taskdownloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876025894-4.ts
[2024-05-16 16:14:37,000: WARNING/ForkPoolWorker-3] create_taskdownloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876019890-3.ts
[2024-05-16 16:14:37,001: WARNING/ForkPoolWorker-1] --- Logging error ---
[2024-05-16 16:14:37,001: INFO/MainProcess] Task create_task[3daa75b0-422b-4b68-bc1e-a8425167b44b] received
[2024-05-16 16:14:37,001: INFO/ForkPoolWorker-3] Task create_task[c31ab6ff-6b2b-40ca-9962-7a9ae97253e8] succeeded in 0.002046805999270873s: True
[2024-05-16 16:14:37,001: INFO/ForkPoolWorker-2] Task create_task[7db38033-f6d7-4780-ad11-05405bf4ec9b] succeeded in 0.0016929880002862774s: True
[2024-05-16 16:14:37,003: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 16:14:37,004: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:14:37,004: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:14:37,005: WARNING/ForkPoolWorker-1]   File "/usr/src/app/worker.py", line 188, in create_task_list
[2024-05-16 16:14:37,005: INFO/MainProcess] Task create_task[294744c5-43e3-4106-a5ff-fc0a8b9996e5] received
[2024-05-16 16:14:37,006: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 677, in get
    return (self.join_native if self.supports_native_join else self.join)(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:14:37,006: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 794, in join_native
    assert_will_not_block()
[2024-05-16 16:14:37,007: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 38, in assert_will_not_block
    raise RuntimeError(E_WOULDBLOCK)
[2024-05-16 16:14:37,007: WARNING/ForkPoolWorker-3] create_taskdownloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876031869-5.ts
[2024-05-16 16:14:37,007: WARNING/ForkPoolWorker-1] RuntimeError: Never call result.get() within a task!
See http://docs.celeryq.org/en/latest/userguide/tasks.html#task-synchronous-subtasks
[2024-05-16 16:14:37,007: WARNING/ForkPoolWorker-2] create_taskdownloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876037915-6.ts
[2024-05-16 16:14:37,008: WARNING/ForkPoolWorker-1] 
During handling of the above exception, another exception occurred:
[2024-05-16 16:14:37,008: INFO/ForkPoolWorker-3] Task create_task[3daa75b0-422b-4b68-bc1e-a8425167b44b] succeeded in 0.0017781919996195938s: True
[2024-05-16 16:14:37,009: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 16:14:37,010: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:14:37,010: INFO/ForkPoolWorker-2] Task create_task[294744c5-43e3-4106-a5ff-fc0a8b9996e5] succeeded in 0.002717440002015792s: True
[2024-05-16 16:14:37,010: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2024-05-16 16:14:37,011: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:14:37,012: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:14:37,012: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:14:37,013: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2024-05-16 16:14:37,013: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:14:37,014: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:14:37,015: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2024-05-16 16:14:37,015: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:14:37,016: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2024-05-16 16:14:37,016: WARNING/ForkPoolWorker-1] AttributeError: '_Code' object has no attribute 'co_positions'
[2024-05-16 16:14:37,017: WARNING/ForkPoolWorker-1] Call stack:
[2024-05-16 16:14:37,020: WARNING/ForkPoolWorker-1]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2024-05-16 16:14:37,021: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2024-05-16 16:14:37,022: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2024-05-16 16:14:37,022: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2024-05-16 16:14:37,023: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2024-05-16 16:14:37,023: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2024-05-16 16:14:37,024: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2024-05-16 16:14:37,024: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2024-05-16 16:14:37,025: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2024-05-16 16:14:37,025: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2024-05-16 16:14:37,026: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2024-05-16 16:14:37,026: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2024-05-16 16:14:37,027: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2024-05-16 16:14:37,027: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2024-05-16 16:14:37,028: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2024-05-16 16:14:37,028: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2024-05-16 16:14:37,029: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2024-05-16 16:14:37,029: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2024-05-16 16:14:37,030: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2024-05-16 16:14:37,030: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2024-05-16 16:14:37,031: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2024-05-16 16:14:37,031: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2024-05-16 16:14:37,032: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2024-05-16 16:14:37,032: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2024-05-16 16:14:37,033: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2024-05-16 16:14:37,033: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2024-05-16 16:14:37,034: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2024-05-16 16:14:37,034: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2024-05-16 16:14:37,034: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2024-05-16 16:14:37,035: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2024-05-16 16:14:37,035: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2024-05-16 16:14:37,036: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2024-05-16 16:14:37,036: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2024-05-16 16:14:37,037: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2024-05-16 16:14:37,037: WARNING/ForkPoolWorker-1] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@247be4a9565c', 'id': '0380b2d7-2c29-4fcf-9010-fad9d78a7fbf', 'name': 'create_task_list', 'exc': "RuntimeError('Never call result.get() within a task!\\nSee http://docs.celeryq.org/en/latest/userguide/tasks.html#task-synchronous-subtasks\\n')", 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 188, in create_task_list\n  File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 677, in get\n    return (self.join_native if self.supports_native_join else self.join)(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 794, in join_native\n    assert_will_not_block()\n  File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 38, in assert_will_not_block\n    raise RuntimeError(E_WOULDBLOCK)\nRuntimeError: Never call result.get() within a task!\nSee http://docs.celeryq.org/en/latest/userguide/tasks.html#task-synchronous-subtasks\n\n', 'args': "[['downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876007823-1.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876013898-2.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876019890-3.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876025894-4.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876031869-5.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876037915-6.ts']]", 'kwargs': '{}', 'description': 'raised unexpected', 'internal': False}
[2024-05-16 16:15:36,442: INFO/MainProcess] Task download_stream_url[e8723add-4752-4575-bdaf-1fc3314cf66f] received
[2024-05-16 16:15:36,446: WARNING/ForkPoolWorker-1] Recording video... https://live-wuxi.cgtn.com/live/wx_cgtn_1000k_internalnormal.m3u8
[2024-05-16 16:15:36,448: WARNING/ForkPoolWorker-1] load m3u8..
[2024-05-16 16:15:39,007: WARNING/ForkPoolWorker-1]  Recording fragment 1 segment 1...
[2024-05-16 16:15:40,827: WARNING/ForkPoolWorker-1]  Recording fragment 2 segment 2...
[2024-05-16 16:15:42,624: WARNING/ForkPoolWorker-1]  Recording fragment 3 segment 3...
[2024-05-16 16:15:44,399: WARNING/ForkPoolWorker-1]  Recording fragment 4 segment 4...
[2024-05-16 16:15:46,196: WARNING/ForkPoolWorker-1]  Recording fragment 5 segment 5...
[2024-05-16 16:15:47,944: WARNING/ForkPoolWorker-1]  Recording fragment 6 segment 6...
[2024-05-16 16:15:48,831: WARNING/ForkPoolWorker-1] sleep 18.0s
[2024-05-16 16:16:06,831: WARNING/ForkPoolWorker-1]     done: fragment_filename_list ['downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876097865-1.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876103849-2.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876109873-3.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876115864-4.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876121905-5.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876127878-6.ts']
[2024-05-16 16:16:06,837: INFO/MainProcess] Task create_task_list[15cfdc59-71f3-4174-be0b-5eae2a782cbf] received
[2024-05-16 16:16:06,837: INFO/ForkPoolWorker-1] Task download_stream_url[e8723add-4752-4575-bdaf-1fc3314cf66f] succeeded in 30.391260934000456s: ['downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876097865-1.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876103849-2.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876109873-3.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876115864-4.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876121905-5.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876127878-6.ts']
[2024-05-16 16:16:06,842: INFO/MainProcess] Task create_task[964fe2f4-5f5d-4df5-977f-12bdcc539589] received
[2024-05-16 16:16:06,846: INFO/MainProcess] Task create_task[39712766-c2f9-42ae-99aa-7fff83da9b24] received
[2024-05-16 16:16:06,847: WARNING/ForkPoolWorker-3] create_taskdownloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876097865-1.ts
[2024-05-16 16:16:06,847: WARNING/ForkPoolWorker-2] create_taskdownloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876103849-2.ts
[2024-05-16 16:16:06,849: INFO/ForkPoolWorker-3] Task create_task[964fe2f4-5f5d-4df5-977f-12bdcc539589] succeeded in 0.002112613001372665s: True
[2024-05-16 16:16:06,850: INFO/ForkPoolWorker-2] Task create_task[39712766-c2f9-42ae-99aa-7fff83da9b24] succeeded in 0.0031561690011585597s: True
[2024-05-16 16:16:06,852: INFO/MainProcess] Task create_task[9601b7d2-b531-421d-8d23-a461acbc38ca] received
[2024-05-16 16:16:06,852: WARNING/ForkPoolWorker-1] --- Logging error ---
[2024-05-16 16:16:06,854: INFO/MainProcess] Task create_task[1408f4cf-0efc-483f-b557-285e1a3b7fa7] received
[2024-05-16 16:16:06,855: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 16:16:06,855: WARNING/ForkPoolWorker-3] create_taskdownloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876109873-3.ts
[2024-05-16 16:16:06,856: WARNING/ForkPoolWorker-2] create_taskdownloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876115864-4.ts
[2024-05-16 16:16:06,856: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:16:06,857: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:16:06,857: INFO/ForkPoolWorker-3] Task create_task[9601b7d2-b531-421d-8d23-a461acbc38ca] succeeded in 0.0018721999986155424s: True
[2024-05-16 16:16:06,858: WARNING/ForkPoolWorker-1]   File "/usr/src/app/worker.py", line 188, in create_task_list
[2024-05-16 16:16:06,858: INFO/ForkPoolWorker-2] Task create_task[1408f4cf-0efc-483f-b557-285e1a3b7fa7] succeeded in 0.0020172080003248993s: True
[2024-05-16 16:16:06,858: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 677, in get
    return (self.join_native if self.supports_native_join else self.join)(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:16:06,859: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 794, in join_native
    assert_will_not_block()
[2024-05-16 16:16:06,860: INFO/MainProcess] Task create_task[4e8366f7-ab43-4f80-823c-6188277221db] received
[2024-05-16 16:16:06,860: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 38, in assert_will_not_block
    raise RuntimeError(E_WOULDBLOCK)
[2024-05-16 16:16:06,861: WARNING/ForkPoolWorker-1] RuntimeError: Never call result.get() within a task!
See http://docs.celeryq.org/en/latest/userguide/tasks.html#task-synchronous-subtasks
[2024-05-16 16:16:06,861: WARNING/ForkPoolWorker-1] 
During handling of the above exception, another exception occurred:
[2024-05-16 16:16:06,862: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 16:16:06,862: INFO/MainProcess] Task create_task[44df0291-752f-4e5e-a894-ffadfde5bf5c] received
[2024-05-16 16:16:06,863: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:16:06,863: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2024-05-16 16:16:06,864: WARNING/ForkPoolWorker-3] create_taskdownloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876121905-5.ts
[2024-05-16 16:16:06,864: WARNING/ForkPoolWorker-2] create_taskdownloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876127878-6.ts
[2024-05-16 16:16:06,864: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:16:06,867: INFO/ForkPoolWorker-3] Task create_task[4e8366f7-ab43-4f80-823c-6188277221db] succeeded in 0.003134966998914024s: True
[2024-05-16 16:16:06,867: INFO/ForkPoolWorker-2] Task create_task[44df0291-752f-4e5e-a894-ffadfde5bf5c] succeeded in 0.003107467000518227s: True
[2024-05-16 16:16:06,867: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:16:06,868: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:16:06,869: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2024-05-16 16:16:06,869: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:16:06,870: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:16:06,870: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2024-05-16 16:16:06,871: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:16:06,871: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2024-05-16 16:16:06,872: WARNING/ForkPoolWorker-1] AttributeError: '_Code' object has no attribute 'co_positions'
[2024-05-16 16:16:06,872: WARNING/ForkPoolWorker-1] Call stack:
[2024-05-16 16:16:06,874: WARNING/ForkPoolWorker-1]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2024-05-16 16:16:06,874: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2024-05-16 16:16:06,875: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2024-05-16 16:16:06,875: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2024-05-16 16:16:06,876: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2024-05-16 16:16:06,877: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2024-05-16 16:16:06,877: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2024-05-16 16:16:06,878: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2024-05-16 16:16:06,878: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2024-05-16 16:16:06,879: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2024-05-16 16:16:06,880: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2024-05-16 16:16:06,880: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2024-05-16 16:16:06,881: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2024-05-16 16:16:06,881: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2024-05-16 16:16:06,882: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2024-05-16 16:16:06,882: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2024-05-16 16:16:06,883: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2024-05-16 16:16:06,883: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2024-05-16 16:16:06,884: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2024-05-16 16:16:06,884: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2024-05-16 16:16:06,884: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2024-05-16 16:16:06,885: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2024-05-16 16:16:06,885: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2024-05-16 16:16:06,886: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2024-05-16 16:16:06,886: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2024-05-16 16:16:06,887: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2024-05-16 16:16:06,887: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2024-05-16 16:16:06,888: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2024-05-16 16:16:06,888: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2024-05-16 16:16:06,889: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2024-05-16 16:16:06,889: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2024-05-16 16:16:06,890: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2024-05-16 16:16:06,890: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2024-05-16 16:16:06,891: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2024-05-16 16:16:06,891: WARNING/ForkPoolWorker-1] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@247be4a9565c', 'id': '15cfdc59-71f3-4174-be0b-5eae2a782cbf', 'name': 'create_task_list', 'exc': "RuntimeError('Never call result.get() within a task!\\nSee http://docs.celeryq.org/en/latest/userguide/tasks.html#task-synchronous-subtasks\\n')", 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 188, in create_task_list\n  File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 677, in get\n    return (self.join_native if self.supports_native_join else self.join)(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 794, in join_native\n    assert_will_not_block()\n  File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 38, in assert_will_not_block\n    raise RuntimeError(E_WOULDBLOCK)\nRuntimeError: Never call result.get() within a task!\nSee http://docs.celeryq.org/en/latest/userguide/tasks.html#task-synchronous-subtasks\n\n', 'args': "[['downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876097865-1.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876103849-2.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876109873-3.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876115864-4.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876121905-5.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715876127878-6.ts']]", 'kwargs': '{}', 'description': 'raised unexpected', 'internal': False}
[2024-05-16 16:17:46,459: INFO/MainProcess] Task download_YouTube_url[e04d3ed4-9885-439b-8d8b-07f08d239e72] received
[2024-05-16 16:17:46,461: WARNING/ForkPoolWorker-1] download YouTube url 123
[2024-05-16 16:17:46,463: WARNING/ForkPoolWorker-1]     error: regex_search: could not find match for (?:v=|\/)([0-9A-Za-z_-]{11}).*
[2024-05-16 16:17:46,466: INFO/MainProcess] Task create_task[83023f00-032b-458e-a78c-952975c6c059] received
[2024-05-16 16:17:46,466: INFO/ForkPoolWorker-1] Task download_YouTube_url[e04d3ed4-9885-439b-8d8b-07f08d239e72] succeeded in 0.004953540999849793s: None
[2024-05-16 16:17:46,469: INFO/ForkPoolWorker-1] Task create_task[83023f00-032b-458e-a78c-952975c6c059] succeeded in 0.001017648999550147s: False
[2024-05-16 16:19:18,306: INFO/MainProcess] Task download_YouTube_url[aa349bd1-f086-44bb-b97a-68c1cbb5b1f8] received
[2024-05-16 16:19:18,308: WARNING/ForkPoolWorker-1] download YouTube url 123
[2024-05-16 16:19:18,310: WARNING/ForkPoolWorker-1]     error: regex_search: could not find match for (?:v=|\/)([0-9A-Za-z_-]{11}).*
[2024-05-16 16:19:18,314: INFO/MainProcess] Task create_task[21e0f379-aae4-4a5e-ab11-68e2e2462e7f] received
[2024-05-16 16:19:18,314: INFO/ForkPoolWorker-1] Task download_YouTube_url[aa349bd1-f086-44bb-b97a-68c1cbb5b1f8] succeeded in 0.006621329997869907s: None
[2024-05-16 16:19:18,318: INFO/ForkPoolWorker-3] Task create_task[21e0f379-aae4-4a5e-ab11-68e2e2462e7f] succeeded in 0.0007278359989868477s: False
[2024-05-16 16:23:50,237: INFO/MainProcess] Task download_YouTube_url[8e9b3a45-4ac6-4085-99c2-e39649a796b4] received
[2024-05-16 16:23:50,240: WARNING/ForkPoolWorker-1] download YouTube url 123
[2024-05-16 16:23:50,243: WARNING/ForkPoolWorker-1]     error: regex_search: could not find match for (?:v=|\/)([0-9A-Za-z_-]{11}).*
[2024-05-16 16:23:50,256: INFO/MainProcess] Task create_task[4778b6c4-3528-4a91-964b-790a8d650060] received
[2024-05-16 16:23:50,257: INFO/ForkPoolWorker-1] Task download_YouTube_url[8e9b3a45-4ac6-4085-99c2-e39649a796b4] succeeded in 0.016886156001419295s: None
[2024-05-16 16:23:50,261: INFO/ForkPoolWorker-1] Task create_task[4778b6c4-3528-4a91-964b-790a8d650060] succeeded in 0.0008023320006032009s: False
[2024-05-16 16:26:46,178: INFO/MainProcess] Task download_YouTube_url[5b77854f-eb2c-4bcd-846e-6f8b1ccd7e91] received
[2024-05-16 16:26:46,185: WARNING/ForkPoolWorker-1] download YouTube url 123
[2024-05-16 16:26:46,193: WARNING/ForkPoolWorker-1]     error: regex_search: could not find match for (?:v=|\/)([0-9A-Za-z_-]{11}).*
[2024-05-16 16:26:46,204: INFO/ForkPoolWorker-1] Task download_YouTube_url[5b77854f-eb2c-4bcd-846e-6f8b1ccd7e91] succeeded in 0.01934173900008318s: None
[2024-05-16 16:26:46,204: INFO/MainProcess] Task create_task[d3cefb76-9973-48fe-8647-a6bfdff2be19] received
[2024-05-16 16:26:46,208: INFO/ForkPoolWorker-1] Task create_task[d3cefb76-9973-48fe-8647-a6bfdff2be19] succeeded in 0.000813114002085058s: False
[2024-05-16 16:33:02,957: INFO/MainProcess] Task download_stream_url[b3cb4d16-1bfb-4900-95a6-144d6fb69d34] received
[2024-05-16 16:33:02,963: WARNING/ForkPoolWorker-1] Recording video... https://live-wuxi.cgtn.com/live/wx_cgtn_1000k_internalnormal.m3u8
[2024-05-16 16:33:02,968: WARNING/ForkPoolWorker-1] load m3u8..
[2024-05-16 16:33:06,183: WARNING/ForkPoolWorker-1]  Recording fragment 1 segment 1...
[2024-05-16 16:33:08,379: WARNING/ForkPoolWorker-1]  Recording fragment 2 segment 2...
[2024-05-16 16:33:10,684: WARNING/ForkPoolWorker-1]  Recording fragment 3 segment 3...
[2024-05-16 16:33:13,143: WARNING/ForkPoolWorker-1]  Recording fragment 4 segment 4...
[2024-05-16 16:33:15,260: WARNING/ForkPoolWorker-1]  Recording fragment 5 segment 5...
[2024-05-16 16:33:17,357: WARNING/ForkPoolWorker-1]  Recording fragment 6 segment 6...
[2024-05-16 16:33:18,442: WARNING/ForkPoolWorker-1] sleep 18.0s
[2024-05-16 16:33:36,442: WARNING/ForkPoolWorker-1]     done: fragment_filename_list ['downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877147697-1.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877153772-2.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877159678-3.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877165677-4.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877171818-5.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877177700-6.ts']
[2024-05-16 16:33:36,447: INFO/MainProcess] Task create_task_list[4507ea50-5391-423b-aa6a-92068b50e136] received
[2024-05-16 16:33:36,447: INFO/ForkPoolWorker-1] Task download_stream_url[b3cb4d16-1bfb-4900-95a6-144d6fb69d34] succeeded in 33.485971868998604s: ['downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877147697-1.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877153772-2.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877159678-3.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877165677-4.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877171818-5.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877177700-6.ts']
[2024-05-16 16:33:36,452: INFO/MainProcess] Task create_task[c62acb4e-9ef4-490b-9ba2-9add6ab2929b] received
[2024-05-16 16:33:36,457: WARNING/ForkPoolWorker-3] create_taskdownloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877147697-1.ts
[2024-05-16 16:33:36,459: INFO/ForkPoolWorker-3] Task create_task[c62acb4e-9ef4-490b-9ba2-9add6ab2929b] succeeded in 0.002276396997331176s: True
[2024-05-16 16:33:36,460: INFO/MainProcess] Task create_task[f92dc2b4-916b-42da-a347-fbd909beaca1] received
[2024-05-16 16:33:36,465: INFO/MainProcess] Task create_task[d2578a5f-8868-4d98-b8a7-5755ff5c9080] received
[2024-05-16 16:33:36,466: WARNING/ForkPoolWorker-2] create_taskdownloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877159678-3.ts
[2024-05-16 16:33:36,466: WARNING/ForkPoolWorker-3] create_taskdownloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877153772-2.ts
[2024-05-16 16:33:36,468: WARNING/ForkPoolWorker-1] --- Logging error ---
[2024-05-16 16:33:36,468: INFO/ForkPoolWorker-3] Task create_task[f92dc2b4-916b-42da-a347-fbd909beaca1] succeeded in 0.002428411000437336s: True
[2024-05-16 16:33:36,467: INFO/ForkPoolWorker-2] Task create_task[d2578a5f-8868-4d98-b8a7-5755ff5c9080] succeeded in 0.0017112479981733486s: True
[2024-05-16 16:33:36,470: INFO/MainProcess] Task create_task[b7dcec2d-bdaa-4b7a-99b8-41fb098cf8e5] received
[2024-05-16 16:33:36,470: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 16:33:36,471: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task
    R = retval = fun(*args, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:33:36,471: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:33:36,472: WARNING/ForkPoolWorker-3] create_taskdownloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877165677-4.ts
[2024-05-16 16:33:36,472: WARNING/ForkPoolWorker-1]   File "/usr/src/app/worker.py", line 188, in create_task_list
    result.ready()  # have all subtasks completed?
           ^^^^^^^^^^^^
[2024-05-16 16:33:36,473: INFO/ForkPoolWorker-3] Task create_task[b7dcec2d-bdaa-4b7a-99b8-41fb098cf8e5] succeeded in 0.0011324980005156249s: True
[2024-05-16 16:33:36,473: INFO/MainProcess] Task create_task[f7f725bc-2568-40c0-a619-d6c2c2e5a535] received
[2024-05-16 16:33:36,474: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 677, in get
    return (self.join_native if self.supports_native_join else self.join)(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:33:36,475: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 794, in join_native
    assert_will_not_block()
[2024-05-16 16:33:36,475: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 38, in assert_will_not_block
    raise RuntimeError(E_WOULDBLOCK)
[2024-05-16 16:33:36,475: WARNING/ForkPoolWorker-1] RuntimeError: Never call result.get() within a task!
See http://docs.celeryq.org/en/latest/userguide/tasks.html#task-synchronous-subtasks
[2024-05-16 16:33:36,476: WARNING/ForkPoolWorker-1] 
During handling of the above exception, another exception occurred:
[2024-05-16 16:33:36,476: WARNING/ForkPoolWorker-1] Traceback (most recent call last):
[2024-05-16 16:33:36,476: INFO/MainProcess] Task create_task[483546a0-6793-4014-ae95-cad141385e23] received
[2024-05-16 16:33:36,477: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 1110, in emit
    msg = self.format(record)
          ^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:33:36,477: WARNING/ForkPoolWorker-3] create_taskdownloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877171818-5.ts
[2024-05-16 16:33:36,477: WARNING/ForkPoolWorker-2] create_taskdownloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877177700-6.ts
[2024-05-16 16:33:36,480: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 953, in format
    return fmt.format(record)
           ^^^^^^^^^^^^^^^^^^
[2024-05-16 16:33:36,481: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 146, in format
    msg = super().format(record)
          ^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:33:36,482: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 695, in format
    record.exc_text = self.formatException(record.exc_info)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:33:36,482: INFO/ForkPoolWorker-3] Task create_task[f7f725bc-2568-40c0-a619-d6c2c2e5a535] succeeded in 0.00440098100079922s: True
[2024-05-16 16:33:36,482: INFO/ForkPoolWorker-2] Task create_task[483546a0-6793-4014-ae95-cad141385e23] succeeded in 0.004306073002226185s: True
[2024-05-16 16:33:36,482: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/utils/log.py", line 142, in formatException
    r = super().formatException(ei)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:33:36,482: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/logging/__init__.py", line 645, in formatException
    traceback.print_exception(ei[0], ei[1], tb, None, sio)
[2024-05-16 16:33:36,483: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 124, in print_exception
    te = TracebackException(type(value), value, tb, limit=limit, compact=True)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:33:36,483: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 690, in __init__
    self.stack = StackSummary._extract_from_extended_frame_gen(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:33:36,484: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 416, in _extract_from_extended_frame_gen
    for f, (lineno, end_lineno, colno, end_colno) in frame_gen:
[2024-05-16 16:33:36,484: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 353, in _walk_tb_with_full_positions
    positions = _get_code_position(tb.tb_frame.f_code, tb.tb_lasti)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[2024-05-16 16:33:36,484: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/traceback.py", line 366, in _get_code_position
    positions_gen = code.co_positions()
                    ^^^^^^^^^^^^^^^^^
[2024-05-16 16:33:36,485: WARNING/ForkPoolWorker-1] AttributeError: '_Code' object has no attribute 'co_positions'
[2024-05-16 16:33:36,485: WARNING/ForkPoolWorker-1] Call stack:
[2024-05-16 16:33:36,486: WARNING/ForkPoolWorker-1]   File "/usr/local/bin/celery", line 8, in <module>
    sys.exit(main())
[2024-05-16 16:33:36,486: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/__main__.py", line 15, in main
    sys.exit(_main())
[2024-05-16 16:33:36,486: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/celery.py", line 217, in main
    return celery(auto_envvar_prefix="CELERY")
[2024-05-16 16:33:36,487: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
[2024-05-16 16:33:36,487: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
[2024-05-16 16:33:36,487: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
[2024-05-16 16:33:36,488: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
[2024-05-16 16:33:36,488: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
[2024-05-16 16:33:36,488: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/click/decorators.py", line 33, in new_func
    return f(get_current_context(), *args, **kwargs)
[2024-05-16 16:33:36,489: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/base.py", line 134, in caller
    return f(ctx, *args, **kwargs)
[2024-05-16 16:33:36,489: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bin/worker.py", line 351, in worker
    worker.start()
[2024-05-16 16:33:36,489: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/worker/worker.py", line 203, in start
    self.blueprint.start(self)
[2024-05-16 16:33:36,490: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 116, in start
    step.start(parent)
[2024-05-16 16:33:36,490: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/bootsteps.py", line 365, in start
    return self.obj.start()
[2024-05-16 16:33:36,491: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/base.py", line 129, in start
    self.on_start()
[2024-05-16 16:33:36,491: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/prefork.py", line 109, in on_start
    P = self._pool = Pool(processes=self.limit,
[2024-05-16 16:33:36,491: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 463, in __init__
    super().__init__(processes, *args, **kwargs)
[2024-05-16 16:33:36,492: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1046, in __init__
    self._create_worker_process(i)
[2024-05-16 16:33:36,492: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/concurrency/asynpool.py", line 480, in _create_worker_process
    return super()._create_worker_process(i)
[2024-05-16 16:33:36,492: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 1158, in _create_worker_process
    w.start()
[2024-05-16 16:33:36,493: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 124, in start
    self._popen = self._Popen(self)
[2024-05-16 16:33:36,493: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/context.py", line 333, in _Popen
    return Popen(process_obj)
[2024-05-16 16:33:36,493: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 24, in __init__
    self._launch(process_obj)
[2024-05-16 16:33:36,494: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/popen_fork.py", line 79, in _launch
    code = process_obj._bootstrap()
[2024-05-16 16:33:36,494: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 327, in _bootstrap
    self.run()
[2024-05-16 16:33:36,496: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/process.py", line 114, in run
    self._target(*self._args, **self._kwargs)
[2024-05-16 16:33:36,496: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 292, in __call__
    sys.exit(self.workloop(pid=pid))
[2024-05-16 16:33:36,496: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/billiard/pool.py", line 362, in workloop
    result = (True, prepare_result(fun(*args, **kwargs)))
[2024-05-16 16:33:36,497: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 649, in fast_trace_task
    R, I, T, Rstr = tasks[task].__trace__(
[2024-05-16 16:33:36,497: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 468, in trace_task
    I, R, state, retval = on_error(task_request, exc, uuid)
[2024-05-16 16:33:36,497: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 379, in on_error
    R = I.handle_error_state(
[2024-05-16 16:33:36,498: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 178, in handle_error_state
    return {
[2024-05-16 16:33:36,498: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 237, in handle_failure
    self._log_error(task, req, einfo)
[2024-05-16 16:33:36,498: WARNING/ForkPoolWorker-1]   File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 265, in _log_error
    logger.log(policy.severity, policy.format.strip(), context,
[2024-05-16 16:33:36,499: WARNING/ForkPoolWorker-1] Message: 'Task %(name)s[%(id)s] %(description)s: %(exc)s'
Arguments: {'hostname': 'celery@247be4a9565c', 'id': '4507ea50-5391-423b-aa6a-92068b50e136', 'name': 'create_task_list', 'exc': "RuntimeError('Never call result.get() within a task!\\nSee http://docs.celeryq.org/en/latest/userguide/tasks.html#task-synchronous-subtasks\\n')", 'traceback': 'Traceback (most recent call last):\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 451, in trace_task\n    R = retval = fun(*args, **kwargs)\n                 ^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/app/trace.py", line 734, in __protected_call__\n    return self.run(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/src/app/worker.py", line 188, in create_task_list\n    result.ready()  # have all subtasks completed?\n           ^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 677, in get\n    return (self.join_native if self.supports_native_join else self.join)(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 794, in join_native\n    assert_will_not_block()\n  File "/usr/local/lib/python3.11/site-packages/celery/result.py", line 38, in assert_will_not_block\n    raise RuntimeError(E_WOULDBLOCK)\nRuntimeError: Never call result.get() within a task!\nSee http://docs.celeryq.org/en/latest/userguide/tasks.html#task-synchronous-subtasks\n\n', 'args': "[['downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877147697-1.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877153772-2.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877159678-3.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877165677-4.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877171818-5.ts', 'downloads/cgtn-internalpull.videobase.cn_wx_cgtn_1000k_internalnormal-1715877177700-6.ts']]", 'kwargs': '{}', 'description': 'raised unexpected', 'internal': False}
[2024-05-16 16:33:59,994: INFO/MainProcess] Connected to redis://redis:6379/0
[2024-05-16 16:33:59,999: INFO/MainProcess] mingle: searching for neighbors
[2024-05-16 16:34:01,011: INFO/MainProcess] mingle: all alone
[2024-05-16 16:34:01,026: INFO/MainProcess] celery@247be4a9565c ready.
[2024-05-16 16:34:21,575: INFO/MainProcess] Connected to redis://redis:6379/0
[2024-05-16 16:34:21,579: INFO/MainProcess] mingle: searching for neighbors
[2024-05-16 16:34:22,606: INFO/MainProcess] mingle: all alone
[2024-05-16 16:34:22,620: INFO/MainProcess] celery@d821745244bc ready.
[2024-05-16 16:34:27,002: INFO/MainProcess] Events of group {task} enabled by remote.
